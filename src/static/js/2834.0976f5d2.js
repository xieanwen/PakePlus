"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[2834],{92834:function(e,a,l){l.r(a),l.d(a,{default:function(){return v}});var t=l(6254),i=l(25598),n=l(38627),d=l(91373),c=l(10901),o=l(88365),r=l(67471),s=l(616),u=l(27151),p=l.n(u),m=l(1683),b=l(35287);const g={class:"call-record"},N={class:"form-container"},f={class:"table-container"};var y=(0,t.pM)({__name:"list",setup(e){const a=(0,t.$V)((()=>l.e(2425).then(l.bind(l,12425)))),{routeQuery:u}=(0,c.dG)(),y=o.DT.getItem("bd_virCompanyId"),F=(0,i.Kh)({advancedFilterVisible:!1,aPlayer:null}),h=(0,i.Kh)({list:[],pageTotal:0,pageSize:10,pageNumber:1,recordFileUrl:""}),v=(0,i.Kh)({callNum:"",calleeNum:"",callerNum:"",bindNum:"",status:"",dateList:[(0,s.OR)(),(0,s.FT)()]}),k=new r.HV(7);async function C(){let e;const a={pageNo:h.pageNumber,pageSize:h.pageSize,status:v.status,callNum:v.callNum,calleeNum:v.calleeNum,callerNum:v.callerNum,bindNum:v.bindNum,companyId:u.value.companyId},l=v.dateList[0],t=v.dateList[1];if("1"===u.value.businessType?(Reflect.set(a,"code",u.value.code??"1"),Reflect.set(a,"startTime",l),Reflect.set(a,"endTime",t),e=b.N3):(Reflect.set(a,"startAt",l),Reflect.set(a,"endAt",t),Reflect.set(a,"agentSwitch",1),e=b.RV),!e)return;const{data:i}=await e.getData(a),n=e.handleData(i);h.list=n.list,h.pageTotal=n.total}function w(e){h.pageSize=e,C()}function T(e){h.pageNumber=e,C()}C();const _=e=>{const{calleeNum:a,callerNum:l,bindNum:t,status:i,dateList:n}=e;v.status=i,v.dateList=n,v.calleeNum=a,v.callerNum=l,v.bindNum=t,(a||l)&&(v.callNum=""),C()},I=e=>{v.dateList=e?[(0,s.OR)(e[0]),(0,s.FT)(e[1])]:[(0,s.OR)(),(0,s.FT)()],C()},L=()=>{F.advancedFilterVisible=!0};function R(e){const a={companyId:y,fileId:e};(0,m.IV)(a)}function V(e){F.aPlayer=new(p())({container:document.getElementById("player"),autoplay:!0,loop:"none",audio:[{name:"被叫："+e.calleeNum,artist:"录音",url:e.recordFileUrl,cover:"favicon.ico"}]}),F.aPlayer.on("ended",(function(){F.aPlayer.destroy()}))}const x=async()=>{const e={pageNo:h.pageNumber,pageSize:h.pageSize,status:v.status,callNum:v.callNum,bindNum:v.bindNum,calleeNum:v.calleeNum,callerNum:v.callerNum};if("1"===String(u.value.businessType)){const a={api:`${s.fe.bdConsole}/agent-call-phone-record-statistics/exportAgentCdr`,method:"post",formData:Object.assign({code:u.value.code,startTime:v.dateList[0],endTime:v.dateList[1],companyId:Number(u.value.companyId)},e)};await(0,m.PE)(a)}else{const a={api:`${s.fe.callRest}/call-record/exportAgentCdr`,method:"post",headers:{"content-type":"application/json"},formData:Object.assign({companyId:Number(u.value.companyId),startAt:v.dateList[0],endAt:v.dateList[1]},e)};await(0,m.PE)(a)}};return(e,l)=>{const c=(0,t.g2)("el-icon"),o=(0,t.g2)("el-input"),r=(0,t.g2)("el-date-picker"),s=(0,t.g2)("el-button"),u=(0,t.g2)("el-table-column"),p=(0,t.g2)("el-link"),m=(0,t.g2)("el-tag"),b=(0,t.g2)("TableEmpty"),y=(0,t.g2)("el-table"),S=(0,t.g2)("PagePagination");return(0,t.uX)(),(0,t.CE)("div",g,[l[8]||(l[8]=(0,t.Lk)("div",{id:"player"},null,-1)),(0,t.Lk)("div",N,[(0,t.bF)(o,{modelValue:v.callNum,"onUpdate:modelValue":l[0]||(l[0]=e=>v.callNum=e),placeholder:"主叫号码/被叫号码",clearable:""},{suffix:(0,t.k6)((()=>[(0,t.bF)(c,{class:"el-input__icon",onClick:C},{default:(0,t.k6)((()=>[(0,t.bF)((0,i.R1)(d.vji))])),_:1})])),_:1},8,["modelValue"]),(0,t.bF)(r,{modelValue:v.dateList,"onUpdate:modelValue":l[1]||(l[1]=e=>v.dateList=e),type:"daterange","range-separator":"~",clearable:!1,format:"YYYY-MM-DD",onChange:I,onCalendarChange:l[2]||(l[2]=e=>{(0,i.R1)(k).handleCalendar(e)}),"disabled-date":e=>(0,i.R1)(k).handleDisabled(e)},null,8,["modelValue","disabled-date"]),(0,t.bF)(s,{onClick:L},{default:(0,t.k6)((()=>l[4]||(l[4]=[(0,t.eW)("高级筛选")]))),_:1}),(0,t.bF)(s,{type:"primary",onClick:x},{default:(0,t.k6)((()=>l[5]||(l[5]=[(0,t.eW)("导出数据")]))),_:1})]),(0,t.Lk)("div",f,[(0,t.bF)(y,{data:h.list,height:"calc(100vh - 308px)"},{empty:(0,t.k6)((()=>[(0,t.bF)(b,{"empty-text":"暂无数据"})])),default:(0,t.k6)((()=>[(0,t.bF)(u,{prop:"calleeNum",label:"被叫号码","min-width":"200px",align:"center"}),(0,t.bF)(u,{prop:"callerNum",label:"主叫号码","min-width":"200px",align:"center"}),(0,t.bF)(u,{prop:"callFlags",label:"类型","min-width":"200px",align:"center"}),(0,t.bF)(u,{prop:"timeConsume",label:"通话时长 (秒)","min-width":"200px",align:"center"}),(0,t.bF)(u,{prop:"fee",label:"费用（元）","min-width":"150px",align:"center"}),(0,t.bF)(u,{prop:"recordFlag",label:"是否录音","min-width":"200px",align:"center","class-name":"operation-group"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(p,{type:"primary",underline:!1,disabled:!e.recordFileId,onClick:a=>V(e)},{default:(0,t.k6)((()=>l[6]||(l[6]=[(0,t.eW)("播放")]))),_:2},1032,["disabled","onClick"]),(0,t.bF)(p,{type:"primary",underline:!1,disabled:!e.recordFileId,onClick:a=>R(e.recordFileId)},{default:(0,t.k6)((()=>l[7]||(l[7]=[(0,t.eW)("下载")]))),_:2},1032,["disabled","onClick"])])),_:1}),(0,t.bF)(u,{prop:"status",label:"状态",align:"center","min-width":"200px"},{default:(0,t.k6)((({row:e})=>[(0,t.bF)(m,{type:e.callDetailsStyleType},{default:(0,t.k6)((()=>[(0,t.eW)((0,n.v_)(e.callDetailsName),1)])),_:2},1032,["type"])])),_:1}),(0,t.bF)(u,{prop:"disconnectTime",label:"通话结束时间",align:"center","min-width":"200px"})])),_:1},8,["data"]),(0,t.bF)(S,{pageTotal:h.pageTotal,pageSize:h.pageSize,pageNumber:h.pageNumber,onEmitPageSizeChange:w,onEmitPageNumberChange:T},null,8,["pageTotal","pageSize","pageNumber"])]),(0,t.bF)((0,i.R1)(a),{visible:F.advancedFilterVisible,"onUpdate:visible":l[3]||(l[3]=e=>F.advancedFilterVisible=e),onEmitFunc:_},null,8,["visible"])])}}}),F=l(83936);const h=(0,F.A)(y,[["__scopeId","data-v-1529a367"]]);var v=h}}]);
//# sourceMappingURL=2834.0976f5d2.js.map