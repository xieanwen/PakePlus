"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[9969],{20394:function(e,a,t){t.d(a,{Ic:function(){return o},Sq:function(){return r},xD:function(){return u},zR:function(){return d}});t(83238);var l=t(84153),i=t(49211),n=t(616),s=t(88365);const r={typeMap:{1:"普通发票",3:"增值税发票"},getData:e=>l.A.post(`${n.fe.baseUpmsRest}/agentInvoice/pageInputList`,e),handleData(e){return{list:(0,s.TC)(e.records)?null===e||void 0===e?void 0:e.records.map((e=>{const a=(0,s.AZ)(i.Qi,e.status,"value");return{id:e.id,applyTime:dayjs(e.applyTime).format("YYYY-MM-DD HH:mm:ss"),invoicePrice:(0,s.qG)(e.invoicePrice),typeLabel:this.typeMap[e.type],status:e.status,statusLabel:a.label,statusStyle:a.styleType,remarks:3===e.status?e.rejectCause:e.remarks}})):[],total:null===e||void 0===e?void 0:e.total}}},o={getData:e=>l.A.get(`${n.fe.agentSystem}/bill/invoicedAmount`,{params:e})},u={getData:e=>l.A.get(`${n.fe.baseUpmsRest}/company-invoice-apply/queryBusinessBillingRecordDetail`,{params:e}),handleData(e){const a=(0,s.AZ)(i.Qi,e.status,"value");return{id:e.id,status:e.status,statusLabel:a.label,statusStyle:a.styleType,invoicePrice:(0,s.qG)(e.invoicePrice),invoiceTitle:e.invoiceTitle,creditCodes:e.creditCodes,registerAddress:e.registerAddress,registerPhone:e.registerPhone,bank:e.bank,account:e.account,name:e.name,email:e.email,address:e.address,invoiceUrl:e.invoiceUrl}}};function d(e){return l.A.post(`${n.fe.baseUpmsRest}/agentInvoice/submitApply`,e)}},69969:function(e,a,t){t.r(a),t.d(a,{default:function(){return F}});var l=t(6254),i=t(25598),n=t(38627),s=t(91373),r=t(20394),o=t(88365);const u={class:"body-container"};var d=(0,l.pM)({__name:"details-drawer",setup(e,{expose:a}){const t={statusLabel:"开票状态",invoicePrice:"开票金额",invoiceTitle:"开票抬头",creditCodes:"税号",registerAddress:"注册地址",registerPhone:"注册电话",bank:"开户银行",account:"银行账户",name:"收件人",email:"邮箱地址",address:"收件地址",invoiceUrl:"发票下载"},s=(0,i.IJ)(!1),d=(0,i.KR)({}),p=(0,i.Gc)({});async function c(){const e={id:p.id};try{const a=await r.xD.getData(e);d.value=r.xD.handleData(a.data)}catch(a){console.log("获取发票详情失败",a)}}async function b(e){s.value=!0,Object.assign(p,{id:e.id}),await c()}function m(){s.value=!1}return a({show:b,hide:m}),(e,a)=>{const r=(0,l.g2)("el-tag"),p=(0,l.g2)("el-button"),c=(0,l.g2)("el-form-item"),b=(0,l.g2)("el-form"),m=(0,l.g2)("el-drawer");return(0,l.uX)(),(0,l.Wv)(m,{class:"custom-drawer",modelValue:s.value,"onUpdate:modelValue":a[1]||(a[1]=e=>s.value=e),title:"查看详情",size:"700"},{footer:(0,l.k6)((()=>[(0,l.bF)(p,{onClick:a[0]||(a[0]=e=>s.value=!1)},{default:(0,l.k6)((()=>a[3]||(a[3]=[(0,l.eW)("关闭")]))),_:1})])),default:(0,l.k6)((()=>[(0,l.Lk)("div",u,[(0,l.bF)(b,{"label-width":"90px"},{default:(0,l.k6)((()=>[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(t,((e,t)=>(0,l.bF)(c,{key:t,label:e+"："},{default:(0,l.k6)((()=>["statusLabel"===t?((0,l.uX)(),(0,l.Wv)(r,{key:0,type:d.value.statusStyle},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(d.value[t]),1)])),_:2},1032,["type"])):"invoiceUrl"===t?((0,l.uX)(),(0,l.Wv)(p,{key:1,disabled:!d.value[t],link:"",type:"primary",onClick:e=>(0,i.R1)(o.t$)(d.value[t])},{default:(0,l.k6)((()=>a[2]||(a[2]=[(0,l.eW)("下载 ")]))),_:2},1032,["disabled","onClick"])):((0,l.uX)(),(0,l.CE)(l.FK,{key:2},[(0,l.eW)((0,n.v_)(d.value[t]||"-"),1)],64))])),_:2},1032,["label"]))),64))])),_:1})])])),_:1},8,["modelValue"])}}});const p=d;var c=p;const b={class:"income-invoice"},m={class:"header"},v={class:"first-part"},y={class:"btn-group"},g={class:"seconds-part"},k={class:"item"},f={class:"tips"},h={class:"table-container"};var _=(0,l.pM)({__name:"index",setup(e){const{bd_agentId:a}=o.DT.batchGetItem(["bd_agentId"]),{bd_virCompanyId:u}=o.DT.batchGetItem(["bd_virCompanyId"]),d=(0,l.$V)((()=>Promise.all([t.e(2076),t.e(2427)]).then(t.bind(t,22427)))),p=(0,l.$V)((()=>Promise.all([t.e(2076),t.e(7857)]).then(t.bind(t,47220)))),_=(0,l.$V)((()=>Promise.all([t.e(2076),t.e(6693)]).then(t.bind(t,3609)))),C=(0,i.KR)(),w=(0,i.KR)(),F=(0,i.IJ)(""),L=(0,i.IJ)(!1),I=(0,i.IJ)(!1),R=[{label:"申请时间",propertyKey:"applyTime",width:200},{label:"发票类型",propertyKey:"typeLabel",width:200},{label:"发票金额（元）",propertyKey:"invoicePrice",width:180},{label:"状态",propertyKey:"statusLabel",width:200},{label:"备注",propertyKey:"remarks",width:200}],{pageNumberChange:D,pageSizeChange:P,pageData:K,getList:S}=(0,o.N5)({listApi:r.Sq,props:{pageNumber:"pageNo",pageSize:"pageSize"},paramsData:{companyId:u}});async function T(){const e={agentId:a},t=await r.Ic.getData(e);F.value=(0,o.qG)(t.data)}function W(){S(),setTimeout((()=>{T()}),1e3)}return T(),(e,a)=>{const t=(0,l.g2)("el-button"),r=(0,l.g2)("el-icon"),o=(0,l.g2)("el-tooltip"),u=(0,l.g2)("el-tag"),S=(0,l.g2)("el-table-column"),T=(0,l.g2)("TableEmpty"),A=(0,l.g2)("el-table"),z=(0,l.g2)("PagePagination");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",b,[(0,l.Lk)("div",m,[(0,l.Lk)("div",v,[(0,l.Lk)("div",y,[(0,l.bF)(t,{link:"",type:"primary",onClick:a[0]||(a[0]=e=>L.value=!0)},{default:(0,l.k6)((()=>a[5]||(a[5]=[(0,l.eW)("发票抬头 ")]))),_:1}),(0,l.bF)(t,{link:"",type:"primary",onClick:a[1]||(a[1]=e=>I.value=!0)},{default:(0,l.k6)((()=>a[6]||(a[6]=[(0,l.eW)("收件地址 ")]))),_:1})])]),(0,l.Lk)("div",g,[(0,l.Lk)("div",k,[(0,l.Lk)("div",f,[a[7]||(a[7]=(0,l.Lk)("h4",null,"可开票金额",-1)),(0,l.bF)(o,{effect:"dark",content:"发票由数企提供",placement:"top-start"},{default:(0,l.k6)((()=>[(0,l.bF)(r,{size:20,color:"#b1b3b8"},{default:(0,l.k6)((()=>[(0,l.bF)((0,i.R1)(s.lOC))])),_:1})])),_:1})]),(0,l.Lk)("p",null,[(0,l.Lk)("span",null,"¥ "+(0,n.v_)(F.value),1),(0,l.bF)(t,{type:"primary",size:"default",onClick:a[2]||(a[2]=e=>w.value.show())},{default:(0,l.k6)((()=>a[8]||(a[8]=[(0,l.eW)("索要发票 ")]))),_:1})])])])]),(0,l.Lk)("div",h,[(0,l.bF)(A,{data:(0,i.R1)(K).list,height:"calc(100vh - 400px)"},{empty:(0,l.k6)((()=>[(0,l.bF)(T,{"empty-text":"暂无数据"})])),default:(0,l.k6)((()=>[((0,l.uX)(),(0,l.CE)(l.FK,null,(0,l.pI)(R,(a=>(0,l.bF)(S,{key:e.index,"show-overflow-tooltip":"",prop:a.propertyKey,label:a.label,"min-width":a.width},{default:(0,l.k6)((({row:e})=>["statusLabel"===a.propertyKey?((0,l.uX)(),(0,l.Wv)(u,{key:0,type:e.statusStyle},{default:(0,l.k6)((()=>[(0,l.eW)((0,n.v_)(e[a.propertyKey]),1)])),_:2},1032,["type"])):((0,l.uX)(),(0,l.CE)(l.FK,{key:1},[(0,l.eW)((0,n.v_)(e[a.propertyKey]||"-"),1)],64))])),_:2},1032,["prop","label","min-width"]))),64)),(0,l.bF)(S,{label:"操作",align:"center",fixed:"right",width:"200"},{default:(0,l.k6)((({row:e})=>[(0,l.bF)(t,{link:"",type:"primary",onClick:a=>C.value.show(e)},{default:(0,l.k6)((()=>a[9]||(a[9]=[(0,l.eW)("查看 ")]))),_:2},1032,["onClick"])])),_:1})])),_:1},8,["data"]),(0,l.bF)(z,{pageTotal:(0,i.R1)(K).pageTotal,pageSize:(0,i.R1)(K).pageSize,pageNumber:(0,i.R1)(K).pageNumber,onEmitPageSizeChange:(0,i.R1)(P),onEmitPageNumberChange:(0,i.R1)(D)},null,8,["pageTotal","pageSize","pageNumber","onEmitPageSizeChange","onEmitPageNumberChange"])])]),(0,l.bF)((0,i.R1)(p),{modelValue:L.value,"onUpdate:modelValue":a[3]||(a[3]=e=>L.value=e)},null,8,["modelValue"]),(0,l.bF)((0,i.R1)(_),{modelValue:I.value,"onUpdate:modelValue":a[4]||(a[4]=e=>I.value=e)},null,8,["modelValue"]),(0,l.bF)((0,i.R1)(d),{ref_key:"requestInvoiceRef",ref:w,onSuccess:W},null,512),(0,l.bF)(c,{ref_key:"detailsDrawerRef",ref:C},null,512)],64)}}}),C=t(83936);const w=(0,C.A)(_,[["__scopeId","data-v-1b905267"]]);var F=w}}]);
//# sourceMappingURL=9969.1d8f633c.js.map