"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[3747],{827:function(e,a,l){l.r(a),l.d(a,{default:function(){return P}});l(95226),l(59784),l(29296),l(47961),l(83238);var u=l(6254),i=l(38627),t=l(85723),s=l(25598),n=l(4710),o=l(10901),c=l(88365),m=l(59259),r=l(64108),v=l(51409),d=l(99821),p=l(8610);const b={class:"product-detail"},f={class:"service-specs"},L={class:"word"},g={class:"word"},C={class:"word"};var y=(0,u.pM)({__name:"cloud-call-package-big",props:{tagList:{},productData:{},purchasedData:{}},setup(e){const{routeQuery:a}=(0,o.dG)(),{serviceCode:l,companyId:y,profileId:k}=a.value,{bd_userInfo:N}=c.DT.batchGetItem(["bd_userInfo"]),P=e,_=(0,s.KR)(),I=(0,s.Kh)({scenariosLabel:P.tagList.map((e=>e.tagName)),scenariosList:P.tagList,minConsume:"",minConsumeList:[],seatPrice:"",seatPriceList:[],cycle:1,cycleList:[{label:"1个月",value:1},{label:"3个月",value:3},{label:"6个月",value:6},{label:"12个月",value:12},{label:"自定义",value:-1}],seatNum:1,seatCustomNum:1,minSeatNum:1,maxSeatNum:1e7,seatList:[{label:"10个",value:10},{label:"30个",value:30},{label:"50个",value:50}],giftMinutes:"",isOvertake:!1}),E=(0,s.IJ)({price:"0.00",sumPrice:"0.00",unitPrice:"0.00",addedPrice:"0.00",subMarketList:[],hasAgentPrice:!1}),F=(0,u.EW)((()=>P.productData)),V=(0,u.EW)((()=>F.value.serviceInfo)),h=(0,u.EW)((()=>{var e;const a=(null===(e=F.value)||void 0===e?void 0:e.addedServiceList)??[];return a.find((e=>"CALL_PACKAGE_BIG_ADDED"===e.addedServiceCode))})),A=(0,u.EW)((()=>{var e;return null===(e=h.value)||void 0===e||null===(e=e.specsList)||void 0===e?void 0:e.map((e=>({...e,nameList:e.groupNames.split(","),codesList:e.groupCodes.split(","),valueList:e.groupValues.split(",")})))})),M=(0,u.EW)((()=>-1===I.seatNum?I.seatCustomNum:I.seatNum)),W=(0,u.EW)((()=>{const e=parseFloat(I.giftMinutes);return e*M.value})),$=(0,u.EW)((()=>parseFloat(I.giftMinutes)>=5e3?"不限制分钟数 （不限制分钟数，分钟数可共享）":`${I.giftMinutes}分钟/坐席/月 （总计${W.value}分钟/月，分钟数可共享）`)),D=(0,u.EW)((()=>{var e;return null!==(e=F.value)&&void 0!==e&&e.canBuy?`合计：${I.cycle}个月 x 坐席单价${I.seatPrice}元/坐席/月 x ${M.value}坐席 = ${E.value.sumPrice}元`:""})),S=(0,u.EW)((()=>{var e;const{minConsume:a,seatPrice:l,giftMinutes:u}=I;return null===(e=A.value)||void 0===e||null===(e=e.find((e=>e.valueList[0]===a&&e.valueList[1]===l&&e.valueList[2]===u)))||void 0===e?void 0:e.coding})),x=(0,u.EW)((()=>[{baseCode:"MINIMUM_CHARGE",number:I.minConsume},{baseCode:"MONTH_MINUTE",number:I.giftMinutes},{baseCode:"MIN_PRICE",number:I.seatPrice}]));function w(){const e=I.scenariosList.map((e=>({id:e.id,pid:e.pid,name:e.tagName||e.name})));_.value.trigger(!0,e)}function U(e){const{list:a=[],label:l=[]}=e;I.scenariosList=a,I.scenariosLabel=l}function O(){I.minConsumeList=[...new Map(A.value.map((e=>[e.nameList[0],e.valueList[0]])))].map((([e,a])=>({label:e,value:a}))),I.minConsume=I.minConsumeList[0].value,T()}function T(){var e;const a=[],l=null===(e=A.value)||void 0===e?void 0:e.filter((e=>e.valueList[0]===I.minConsume));l.map((e=>{X(a,{label:`${e.nameList[1]}/坐席/月`,value:e.valueList[1]})})),I.seatPriceList=a,I.seatPrice=a[0].value,G()}function G(){var e;const a=[],l=null===(e=A.value)||void 0===e?void 0:e.filter((e=>e.valueList[0]===I.minConsume&&e.valueList[1]===I.seatPrice));l.map((e=>{X(a,{value:e.valueList[2]})})),I.giftMinutes=a[0].value,K()}function K(){var e;const{minConsume:a,seatPrice:l,giftMinutes:u}=I,i=null===(e=A.value)||void 0===e?void 0:e.find((e=>e.valueList[0]===a&&e.valueList[1]===l&&e.valueList[2]===u));if(i){var t;const e=[{label:`${i.minNum}个`,value:i.minNum},{label:"10个",value:10},{label:"30个",value:30},{label:"50个",value:50}];I.seatList=null!==(t=h.value)&&void 0!==t&&t.isDiy?[...e,{label:"自定义",value:-1}]:e,I.seatNum=I.seatList[0].value,I.minSeatNum=i.minNum,I.maxSeatNum=i.maxNum}}function X(e,a){const l=e.find((e=>e.value===a.value));!l&&e.push(a)}function B(){I.cycle=I.cycleList[0].value,I.seatNum=I.seatList[0].value}function R(e,a){var l;const u={minConsume:()=>{I.minConsume=e,T(),B()},seatPrice:()=>{I.seatPrice=e,G(),B()}};null===(l=u[a])||void 0===l||l.call(u),H()}function Q(){var e;const a=I.scenariosList.map((e=>({id:e.id,name:e.name}))),u={helpOrder:1,agentId:N.profileId,companyId:y,profileId:k,buyType:"BUY_SERVER",businessTagsInfo:JSON.stringify(a),shopBuyList:[{agentId:N.profileId,isisTry:!1,dateType:"2",dateValue:I.cycle,marketCode:l,userNumber:M.value,coding:[{code:"CALL_PACKAGE_BIG_ADDED",coding:S.value,num:M.value}],baseCodeList:x.value}],sumPrice:E.value.sumPrice},i={list:[{...V.value,price:E.value.price,specsInfo:`坐席数量：${M.value}个；合作周期：${I.cycle}个月；最低消费：${I.minConsume}元起；坐席单价：${I.seatPrice}元/坐席/月；含分钟数：${I.giftMinutes}分钟/坐席/月`,augmentedServiceList:null===(e=E.value)||void 0===e?void 0:e.subMarketList.map((e=>("1"===e.calculateType&&(e.specsInfo=`${I.cycle}个月`),e)))}],sumPrice:E.value.sumPrice};return{params:u,commodityInfo:i}}async function H(){const e=Q().params;E.value=await(0,n.AV)(e),I.isOvertake=!1}function J(){var e;if(null===(e=I.scenariosList)||void 0===e||!e.length)return m.nk.warning("请选择业务场景!");(0,n.$d)(Q())}function q(){O(),H()}return(0,u.sV)((()=>{q()})),(e,a)=>{var l;const s=(0,u.g2)("el-input"),n=(0,u.g2)("el-form-item"),o=(0,u.g2)("el-option"),c=(0,u.g2)("el-select"),m=(0,u.g2)("el-input-number"),y=(0,u.g2)("el-tooltip"),k=(0,u.g2)("el-form");return(0,u.uX)(),(0,u.CE)(u.FK,null,[(0,u.Lk)("div",b,[(0,u.bF)(r.A,{serviceData:V.value},null,8,["serviceData"]),(0,u.Lk)("div",f,[(0,u.bF)(k,{"label-width":"150px"},{default:(0,u.k6)((()=>[(0,u.bF)(n,{label:"业务场景"},{default:(0,u.k6)((()=>[(0,u.bF)(s,{readonly:"",placeholder:"请输入",modelValue:I.scenariosLabel,"onUpdate:modelValue":a[0]||(a[0]=e=>I.scenariosLabel=e),onClick:w},null,8,["modelValue"])])),_:1}),(0,u.bF)(n,{label:"最低消费"},{default:(0,u.k6)((()=>[(0,u.bF)(v.A,{list:I.minConsumeList,modelValue:I.minConsume,minWidth:"95px","onUpdate:modelValue":a[1]||(a[1]=e=>R(e,"minConsume"))},null,8,["list","modelValue"])])),_:1}),(0,u.bF)(n,{label:"坐席单价"},{default:(0,u.k6)((()=>[(0,u.bF)(v.A,{list:I.seatPriceList,modelValue:I.seatPrice,minWidth:"95px","onUpdate:modelValue":a[2]||(a[2]=e=>R(e,"seatPrice"))},null,8,["list","modelValue"])])),_:1}),(0,u.bF)(n,{label:"合作周期"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:I.cycle,"onUpdate:modelValue":a[3]||(a[3]=e=>I.cycle=e),disabled:""},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(I.cycleList,(e=>((0,u.uX)(),(0,u.Wv)(o,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,u.bF)(n,{label:"坐席数量",class:"amount-form-item"},{default:(0,u.k6)((()=>[(0,u.bF)(c,{modelValue:I.seatNum,"onUpdate:modelValue":a[4]||(a[4]=e=>I.seatNum=e),onChange:H},{default:(0,u.k6)((()=>[((0,u.uX)(!0),(0,u.CE)(u.FK,null,(0,u.pI)(I.seatList,((e,a)=>((0,u.uX)(),(0,u.Wv)(o,{key:a,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),-1===I.seatNum?((0,u.uX)(),(0,u.Wv)(m,{key:0,modelValue:I.seatCustomNum,"onUpdate:modelValue":a[5]||(a[5]=e=>I.seatCustomNum=e),min:I.minSeatNum,max:I.maxSeatNum,step:h.value.miniNum,"step-strictly":"","value-on-clear":I.minSeatNum,onChange:H},null,8,["modelValue","min","max","step","value-on-clear"])):(0,u.Q3)("",!0)])),_:1}),(0,u.bF)(n,{label:"含分钟数"},{default:(0,u.k6)((()=>[(0,u.Lk)("p",L,[(0,u.eW)((0,i.v_)($.value)+" ",1),parseFloat(I.giftMinutes)<5e3?((0,u.uX)(),(0,u.Wv)(y,{key:0,placement:"top-start",trigger:"hover","popper-class":"custom-tooltip",content:"当分钟数超出后，会根据使用的资源不同，定价不相同。"},{default:(0,u.k6)((()=>a[6]||(a[6]=[(0,u.Lk)("img",{class:"question-icon",src:t,alt:""},null,-1)]))),_:1})):(0,u.Q3)("",!0)]),(0,u.Lk)("p",g,(0,i.v_)(D.value),1),(0,u.Lk)("p",C," 注意：金额需要超过最低消费金额"+(0,i.v_)(I.minConsume)+"元，才可购买或加购 ",1)])),_:1})])),_:1}),(0,u.bF)(p.A,{onEmitFunc:J,isOvertake:I.isOvertake,"buy-price":E.value.sumPrice,"can-buy":null===(l=F.value)||void 0===l?void 0:l.canBuy,hasAgentPrice:E.value.hasAgentPrice},null,8,["isOvertake","buy-price","can-buy","hasAgentPrice"])])]),(0,u.bF)(d.A,{ref_key:"businessScenariosRef",ref:_,onEmitFunc:U},null,512)],64)}}}),k=l(83936);const N=(0,k.A)(y,[["__scopeId","data-v-cc77828e"]]);var P=N}}]);
//# sourceMappingURL=3747.e6747d92.js.map