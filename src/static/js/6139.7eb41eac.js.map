{"version":3,"file":"static/js/6139.7eb41eac.js","mappings":"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","sources":["webpack://daili/./src/views/business-management/osprey-cloud-call/sub-customer/list.vue?46fa","webpack://daili/./src/views/business-management/osprey-cloud-call/sub-customer/list.vue","webpack://daili/./src/views/business-management/osprey-cloud-call/sub-customer/list.vue?bc8b"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { unref as _unref, resolveComponent as _resolveComponent, createVNode as _createVNode, createTextVNode as _createTextVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, openBlock as _openBlock, createElementBlock as _createElementBlock, createCommentVNode as _createCommentVNode, Fragment as _Fragment } from \"vue\"\n\nconst _hoisted_1 = { class: \"business-management\" }\nconst _hoisted_2 = { class: \"form-container\" }\nconst _hoisted_3 = { class: \"table-container\" }\nconst _hoisted_4 = { class: \"operation-group\" }\nconst _hoisted_5 = { key: 0 }\n\nimport { defineAsyncComponent, ref, shallowReactive } from \"vue\";\r\n\r\nimport { useVueRouter } from \"@/assets/useHook\";\r\nimport { usePage, LocalStorage } from \"jz-tool-lib\";\r\n\r\nimport {\r\n  businessManagementListApi,\r\n  updateAccountApi,\r\n} from \"@api/business-management-api\";\r\n\r\nimport { serviceName } from \"@assets/common\";\r\nimport { downloadFile } from \"@api/download-api\";\r\nimport { ElMessage, ElMessageBox } from \"element-plus\";\r\n\r\n\nexport default /*@__PURE__*/_defineComponent({\n  ...{\r\n  name: \"businessManagement.ospreyCloudCall.subCustomer.list\",\r\n},\n  __name: 'list',\n  setup(__props) {\n\r\n\r\nconst CustomImportFile = defineAsyncComponent(\r\n  () => import(\"@/components/common/custom-import-file.vue\")\r\n);\r\nconst CustomImportErrorFile = defineAsyncComponent(\r\n  () => import(\"@/components/common/custom-import-error-file.vue\")\r\n);\r\nconst RealNameAuthenticationDialog = defineAsyncComponent(\r\n  () =>\r\n    import(\r\n      \"@components/business-management/ospreyCloudCall/sub-customer/list/real-name-authentication-dialog.vue\"\r\n    )\r\n);\r\nconst { goPage } = useVueRouter();\r\n\r\nconst userInfo = LocalStorage.getItem(\"bd_userInfo\");\r\nconst agentId = LocalStorage.getItem(\"bd_agentId\");\r\nconst importFileRef = ref();\r\nconst importErrorFileRef = ref();\r\nconst realNameRef = ref();\r\nconst paramsData = shallowReactive({\r\n  companyName: \"\",\r\n});\r\nconst { getList, pageNumberChange, pageSizeChange, pageData, resetPageNumber } =\r\n  usePage({\r\n    listApi: businessManagementListApi,\r\n    props: {\r\n      pageSize: \"pageSize\",\r\n      pageNumber: \"page\",\r\n    },\r\n    searchParams: () => {\r\n      return {\r\n        companyName: paramsData.companyName,\r\n        agentUserId: userInfo.profileId,\r\n      };\r\n    },\r\n  });\r\n\r\nconst handleSearch = () => {\r\n  resetPageNumber();\r\n  getList();\r\n};\r\n\r\nconst importErrorContent = () => {\r\n  importErrorFileRef.value?.toggle(true);\r\n};\r\n//三要素实名\r\nconst handRealName = () => {\r\n  realNameRef.value?.toggle(true);\r\n};\r\n\r\nfunction importNumber() {\r\n  importFileRef.value.trigger(true, {\r\n    data: {\r\n      agentId: agentId,\r\n    },\r\n    limit: 1,\r\n    autoUpload: false,\r\n    accept: \".xls,.xlsx\",\r\n    actionUrl: `${serviceName.callRest}/agentInterface/importExcel`,\r\n    templateUrl: () => {\r\n      return downloadFile({\r\n        api: `${serviceName.callRest}/agentInterface/getExcelTemplate`,\r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nconst handleJumpPage = (info: Record<string, any>) => {\r\n  const query = {\r\n    companyId: info.companyId,\r\n    companyName: info.companyName,\r\n    companyCode: info.companyCode,\r\n    businessType: info.businessType,\r\n  };\r\n  if (info.businessType === 1) {\r\n    Reflect.set(query, \"code\", info.code);\r\n  } else {\r\n    Reflect.set(query, \"profileId\", info.profileId);\r\n  }\r\n  goPage({\r\n    path: \"/businessManagement/ospreyCloudCall/subCustomer/interface/detail\",\r\n    query,\r\n  });\r\n};\r\n\r\n//充值\r\nfunction openRecharge(info: Record<string, any>) {\r\n  ElMessageBox.prompt(\"充值金额\", \"充值\", {\r\n    confirmButtonText: \"确定\",\r\n    cancelButtonText: \"取消\",\r\n  })\r\n    .then(async ({ value }) => {\r\n      value = value.trim().replace(/\\s+/g, \"\");\r\n      if (!value || value.trim() === \"\" || value <= 0) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入充值金额！\",\r\n        });\r\n        return;\r\n      }\r\n      if (isNaN(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入正确的金额！\",\r\n        });\r\n        return;\r\n      }\r\n      const regex = /^\\d+(\\.\\d{1,3})?$/;\r\n      if (!regex.test(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"输入金额最多3位小数！\",\r\n        });\r\n        return;\r\n      }\r\n      await updateAccountApi.getData({\r\n        agencyId: agentId,\r\n        amount: value,\r\n        companyId: info.companyId,\r\n        profileId: userInfo.profileId,\r\n        tradeType: 1,\r\n        profileName: userInfo.realName,\r\n      });\r\n      ElMessage({\r\n        type: \"success\",\r\n        message: \"充值成功\",\r\n      });\r\n      await getList();\r\n    })\r\n    .catch(() => {});\r\n}\r\n\r\n//扣款\r\nfunction openDeduction(info: Record<string, any>) {\r\n  ElMessageBox.prompt(\"扣款金额\", \"扣款\", {\r\n    confirmButtonText: \"确定\",\r\n    cancelButtonText: \"取消\",\r\n  })\r\n    .then(async ({ value }) => {\r\n      value = value.trim().replace(/\\s+/g, \"\");\r\n      if (!value || value.trim() === \"\" || value <= 0) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入扣款金额！\",\r\n        });\r\n        return;\r\n      }\r\n      if (isNaN(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入正确的金额！\",\r\n        });\r\n        return;\r\n      }\r\n      const regex = /^\\d+(\\.\\d{1,3})?$/;\r\n      if (!regex.test(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"输入金额最多3位小数！\",\r\n        });\r\n        return;\r\n      }\r\n      if (value > info.companyRemaining) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"输入金额大于总金额！\",\r\n        });\r\n      }\r\n      await updateAccountApi.getData({\r\n        agencyId: agentId,\r\n        amount: value,\r\n        companyId: info.companyId,\r\n        profileId: userInfo.profileId,\r\n        tradeType: 2,\r\n        profileName: userInfo.realName,\r\n      });\r\n      ElMessage({\r\n        type: \"success\",\r\n        message: \"扣款成功\",\r\n      });\r\n      await getList();\r\n    })\r\n    .catch(() => {});\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_input = _resolveComponent(\"el-input\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n  const _component_el_table_column = _resolveComponent(\"el-table-column\")!\n  const _component_el_link = _resolveComponent(\"el-link\")!\n  const _component_TableEmpty = _resolveComponent(\"TableEmpty\")!\n  const _component_el_table = _resolveComponent(\"el-table\")!\n  const _component_PagePagination = _resolveComponent(\"PagePagination\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _createVNode(_component_el_input, {\n          modelValue: _unref(paramsData).companyName,\n          \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(paramsData).companyName) = $event)),\n          placeholder: \"请输客户名称\",\n          class: \"company\"\n        }, null, 8, [\"modelValue\"]),\n        _createVNode(_component_el_button, {\n          type: \"primary\",\n          class: \"distance\",\n          onClick: handleSearch\n        }, {\n          default: _withCtx(() => _cache[1] || (_cache[1] = [\n            _createTextVNode(\"搜索 \")\n          ])),\n          _: 1\n        }),\n        _createVNode(_component_el_button, {\n          class: \"distance\",\n          onClick: importNumber\n        }, {\n          default: _withCtx(() => _cache[2] || (_cache[2] = [\n            _createTextVNode(\"导入主叫号码 \")\n          ])),\n          _: 1\n        }),\n        _createVNode(_component_el_button, {\n          class: \"distance\",\n          onClick: importErrorContent\n        }, {\n          default: _withCtx(() => _cache[3] || (_cache[3] = [\n            _createTextVNode(\"导入失败内容 \")\n          ])),\n          _: 1\n        }),\n        _createVNode(_component_el_button, {\n          class: \"distance\",\n          onClick: handRealName\n        }, {\n          default: _withCtx(() => _cache[4] || (_cache[4] = [\n            _createTextVNode(\"号码实名\")\n          ])),\n          _: 1\n        })\n      ]),\n      _createElementVNode(\"div\", _hoisted_3, [\n        _createVNode(_component_el_table, {\n          data: _unref(pageData).list,\n          height: \"calc(100vh - 260px)\"\n        }, {\n          empty: _withCtx(() => [\n            _createVNode(_component_TableEmpty, { \"empty-text\": \"暂无数据\" })\n          ]),\n          default: _withCtx(() => [\n            _createVNode(_component_el_table_column, {\n              prop: \"companyName\",\n              label: \"客户名称\",\n              align: \"center\",\n              \"min-width\": \"200px\"\n            }),\n            _createVNode(_component_el_table_column, {\n              prop: \"companyCode\",\n              label: \"企业code\",\n              align: \"center\"\n            }),\n            _createVNode(_component_el_table_column, {\n              prop: \"codeName\",\n              label: \"唯一标识码\",\n              align: \"center\"\n            }),\n            _createVNode(_component_el_table_column, {\n              prop: \"phoneNumber\",\n              label: \"中间号数量\",\n              align: \"center\"\n            }),\n            _createVNode(_component_el_table_column, {\n              prop: \"timeConsume\",\n              label: \"总使用量\",\n              align: \"center\"\n            }),\n            _createVNode(_component_el_table_column, {\n              prop: \"companyRemaining\",\n              label: \"话费余额\",\n              align: \"center\"\n            }),\n            _createVNode(_component_el_table_column, {\n              label: \"操作\",\n              align: \"center\",\n              width: \"180px\"\n            }, {\n              default: _withCtx(({ row }) => [\n                _createElementVNode(\"div\", _hoisted_4, [\n                  _createVNode(_component_el_link, {\n                    type: \"primary\",\n                    underline: false,\n                    onClick: ($event: any) => (handleJumpPage(row))\n                  }, {\n                    default: _withCtx(() => _cache[5] || (_cache[5] = [\n                      _createTextVNode(\"查看详情 \")\n                    ])),\n                    _: 2\n                  }, 1032, [\"onClick\"]),\n                  (row.ecSwitch === 1)\n                    ? (_openBlock(), _createElementBlock(\"div\", _hoisted_5, [\n                        _createVNode(_component_el_link, {\n                          type: \"primary\",\n                          underline: false,\n                          onClick: ($event: any) => (openRecharge(row))\n                        }, {\n                          default: _withCtx(() => _cache[6] || (_cache[6] = [\n                            _createTextVNode(\"充值 \")\n                          ])),\n                          _: 2\n                        }, 1032, [\"onClick\"]),\n                        _createVNode(_component_el_link, {\n                          type: \"primary\",\n                          underline: false,\n                          onClick: ($event: any) => (openDeduction(row))\n                        }, {\n                          default: _withCtx(() => _cache[7] || (_cache[7] = [\n                            _createTextVNode(\"扣款 \")\n                          ])),\n                          _: 2\n                        }, 1032, [\"onClick\"])\n                      ]))\n                    : _createCommentVNode(\"\", true)\n                ])\n              ]),\n              _: 1\n            })\n          ]),\n          _: 1\n        }, 8, [\"data\"]),\n        _createVNode(_component_PagePagination, {\n          pageTotal: _unref(pageData).pageTotal,\n          pageSize: _unref(pageData).pageSize,\n          pageNumber: _unref(pageData).pageNumber,\n          onEmitPageSizeChange: _unref(pageSizeChange),\n          onEmitPageNumberChange: _unref(pageNumberChange)\n        }, null, 8, [\"pageTotal\", \"pageSize\", \"pageNumber\", \"onEmitPageSizeChange\", \"onEmitPageNumberChange\"])\n      ])\n    ]),\n    _createVNode(_unref(CustomImportFile), {\n      ref_key: \"importFileRef\",\n      ref: importFileRef,\n      onEmitFunc: _unref(getList)\n    }, null, 8, [\"onEmitFunc\"]),\n    _createVNode(_unref(CustomImportErrorFile), {\n      ref_key: \"importErrorFileRef\",\n      ref: importErrorFileRef\n    }, null, 512),\n    _createVNode(_unref(RealNameAuthenticationDialog), {\n      ref_key: \"realNameRef\",\n      ref: realNameRef\n    }, null, 512)\n  ], 64))\n}\n}\n\n})","<template>\r\n  <!--  业务管理-->\r\n  <div class=\"business-management\">\r\n    <div class=\"form-container\">\r\n      <el-input\r\n        v-model=\"paramsData.companyName\"\r\n        placeholder=\"请输客户名称\"\r\n        class=\"company\"\r\n      />\r\n      <el-button type=\"primary\" class=\"distance\" @click=\"handleSearch\"\r\n        >搜索\r\n      </el-button>\r\n      <el-button class=\"distance\" @click=\"importNumber\"\r\n        >导入主叫号码\r\n      </el-button>\r\n      <el-button class=\"distance\" @click=\"importErrorContent\"\r\n        >导入失败内容\r\n      </el-button>\r\n      <el-button class=\"distance\" @click=\"handRealName\">号码实名</el-button>\r\n    </div>\r\n    <div class=\"table-container\">\r\n      <!--   列表   -->\r\n      <el-table :data=\"pageData.list\" height=\"calc(100vh - 260px)\">\r\n        <el-table-column\r\n          prop=\"companyName\"\r\n          label=\"客户名称\"\r\n          align=\"center\"\r\n          min-width=\"200px\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"companyCode\"\r\n          label=\"企业code\"\r\n          align=\"center\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"codeName\"\r\n          label=\"唯一标识码\"\r\n          align=\"center\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"phoneNumber\"\r\n          label=\"中间号数量\"\r\n          align=\"center\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"timeConsume\"\r\n          label=\"总使用量\"\r\n          align=\"center\"\r\n        ></el-table-column>\r\n        <el-table-column\r\n          prop=\"companyRemaining\"\r\n          label=\"话费余额\"\r\n          align=\"center\"\r\n        >\r\n        </el-table-column>\r\n        <el-table-column label=\"操作\" align=\"center\" width=\"180px\">\r\n          <template #default=\"{ row }\">\r\n            <div class=\"operation-group\">\r\n              <el-link\r\n                type=\"primary\"\r\n                :underline=\"false\"\r\n                @click=\"handleJumpPage(row)\"\r\n                >查看详情\r\n              </el-link>\r\n              <div v-if=\"row.ecSwitch === 1\">\r\n                <el-link\r\n                  type=\"primary\"\r\n                  :underline=\"false\"\r\n                  @click=\"openRecharge(row)\"\r\n                  >充值\r\n                </el-link>\r\n                <el-link\r\n                  type=\"primary\"\r\n                  :underline=\"false\"\r\n                  @click=\"openDeduction(row)\"\r\n                  >扣款\r\n                </el-link>\r\n              </div>\r\n            </div>\r\n          </template>\r\n        </el-table-column>\r\n        <template #empty>\r\n          <TableEmpty empty-text=\"暂无数据\"></TableEmpty>\r\n        </template>\r\n      </el-table>\r\n      <!--   分页   -->\r\n      <PagePagination\r\n        :pageTotal=\"pageData.pageTotal\"\r\n        :pageSize=\"pageData.pageSize\"\r\n        :pageNumber=\"pageData.pageNumber\"\r\n        @emitPageSizeChange=\"pageSizeChange\"\r\n        @emitPageNumberChange=\"pageNumberChange\"\r\n      ></PagePagination>\r\n    </div>\r\n  </div>\r\n\r\n  <CustomImportFile ref=\"importFileRef\" @emitFunc=\"getList\"></CustomImportFile>\r\n\r\n  <CustomImportErrorFile ref=\"importErrorFileRef\" />\r\n  <!--三要素认证-->\r\n  <RealNameAuthenticationDialog\r\n    ref=\"realNameRef\"\r\n  ></RealNameAuthenticationDialog>\r\n</template>\r\n\r\n<script lang=\"ts\" setup>\r\nimport { defineAsyncComponent, ref, shallowReactive } from \"vue\";\r\n\r\nimport { useVueRouter } from \"@/assets/useHook\";\r\nimport { usePage, LocalStorage } from \"jz-tool-lib\";\r\n\r\nimport {\r\n  businessManagementListApi,\r\n  updateAccountApi,\r\n} from \"@api/business-management-api\";\r\n\r\nimport { serviceName } from \"@assets/common\";\r\nimport { downloadFile } from \"@api/download-api\";\r\nimport { ElMessage, ElMessageBox } from \"element-plus\";\r\n\r\ndefineOptions({\r\n  name: \"businessManagement.ospreyCloudCall.subCustomer.list\",\r\n});\r\nconst CustomImportFile = defineAsyncComponent(\r\n  () => import(\"@/components/common/custom-import-file.vue\")\r\n);\r\nconst CustomImportErrorFile = defineAsyncComponent(\r\n  () => import(\"@/components/common/custom-import-error-file.vue\")\r\n);\r\nconst RealNameAuthenticationDialog = defineAsyncComponent(\r\n  () =>\r\n    import(\r\n      \"@components/business-management/ospreyCloudCall/sub-customer/list/real-name-authentication-dialog.vue\"\r\n    )\r\n);\r\nconst { goPage } = useVueRouter();\r\n\r\nconst userInfo = LocalStorage.getItem(\"bd_userInfo\");\r\nconst agentId = LocalStorage.getItem(\"bd_agentId\");\r\nconst importFileRef = ref();\r\nconst importErrorFileRef = ref();\r\nconst realNameRef = ref();\r\nconst paramsData = shallowReactive({\r\n  companyName: \"\",\r\n});\r\nconst { getList, pageNumberChange, pageSizeChange, pageData, resetPageNumber } =\r\n  usePage({\r\n    listApi: businessManagementListApi,\r\n    props: {\r\n      pageSize: \"pageSize\",\r\n      pageNumber: \"page\",\r\n    },\r\n    searchParams: () => {\r\n      return {\r\n        companyName: paramsData.companyName,\r\n        agentUserId: userInfo.profileId,\r\n      };\r\n    },\r\n  });\r\n\r\nconst handleSearch = () => {\r\n  resetPageNumber();\r\n  getList();\r\n};\r\n\r\nconst importErrorContent = () => {\r\n  importErrorFileRef.value?.toggle(true);\r\n};\r\n//三要素实名\r\nconst handRealName = () => {\r\n  realNameRef.value?.toggle(true);\r\n};\r\n\r\nfunction importNumber() {\r\n  importFileRef.value.trigger(true, {\r\n    data: {\r\n      agentId: agentId,\r\n    },\r\n    limit: 1,\r\n    autoUpload: false,\r\n    accept: \".xls,.xlsx\",\r\n    actionUrl: `${serviceName.callRest}/agentInterface/importExcel`,\r\n    templateUrl: () => {\r\n      return downloadFile({\r\n        api: `${serviceName.callRest}/agentInterface/getExcelTemplate`,\r\n      });\r\n    },\r\n  });\r\n}\r\n\r\nconst handleJumpPage = (info: Record<string, any>) => {\r\n  const query = {\r\n    companyId: info.companyId,\r\n    companyName: info.companyName,\r\n    companyCode: info.companyCode,\r\n    businessType: info.businessType,\r\n  };\r\n  if (info.businessType === 1) {\r\n    Reflect.set(query, \"code\", info.code);\r\n  } else {\r\n    Reflect.set(query, \"profileId\", info.profileId);\r\n  }\r\n  goPage({\r\n    path: \"/businessManagement/ospreyCloudCall/subCustomer/interface/detail\",\r\n    query,\r\n  });\r\n};\r\n\r\n//充值\r\nfunction openRecharge(info: Record<string, any>) {\r\n  ElMessageBox.prompt(\"充值金额\", \"充值\", {\r\n    confirmButtonText: \"确定\",\r\n    cancelButtonText: \"取消\",\r\n  })\r\n    .then(async ({ value }) => {\r\n      value = value.trim().replace(/\\s+/g, \"\");\r\n      if (!value || value.trim() === \"\" || value <= 0) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入充值金额！\",\r\n        });\r\n        return;\r\n      }\r\n      if (isNaN(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入正确的金额！\",\r\n        });\r\n        return;\r\n      }\r\n      const regex = /^\\d+(\\.\\d{1,3})?$/;\r\n      if (!regex.test(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"输入金额最多3位小数！\",\r\n        });\r\n        return;\r\n      }\r\n      await updateAccountApi.getData({\r\n        agencyId: agentId,\r\n        amount: value,\r\n        companyId: info.companyId,\r\n        profileId: userInfo.profileId,\r\n        tradeType: 1,\r\n        profileName: userInfo.realName,\r\n      });\r\n      ElMessage({\r\n        type: \"success\",\r\n        message: \"充值成功\",\r\n      });\r\n      await getList();\r\n    })\r\n    .catch(() => {});\r\n}\r\n\r\n//扣款\r\nfunction openDeduction(info: Record<string, any>) {\r\n  ElMessageBox.prompt(\"扣款金额\", \"扣款\", {\r\n    confirmButtonText: \"确定\",\r\n    cancelButtonText: \"取消\",\r\n  })\r\n    .then(async ({ value }) => {\r\n      value = value.trim().replace(/\\s+/g, \"\");\r\n      if (!value || value.trim() === \"\" || value <= 0) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入扣款金额！\",\r\n        });\r\n        return;\r\n      }\r\n      if (isNaN(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"请输入正确的金额！\",\r\n        });\r\n        return;\r\n      }\r\n      const regex = /^\\d+(\\.\\d{1,3})?$/;\r\n      if (!regex.test(value)) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"输入金额最多3位小数！\",\r\n        });\r\n        return;\r\n      }\r\n      if (value > info.companyRemaining) {\r\n        ElMessage({\r\n          type: \"warning\",\r\n          message: \"输入金额大于总金额！\",\r\n        });\r\n      }\r\n      await updateAccountApi.getData({\r\n        agencyId: agentId,\r\n        amount: value,\r\n        companyId: info.companyId,\r\n        profileId: userInfo.profileId,\r\n        tradeType: 2,\r\n        profileName: userInfo.realName,\r\n      });\r\n      ElMessage({\r\n        type: \"success\",\r\n        message: \"扣款成功\",\r\n      });\r\n      await getList();\r\n    })\r\n    .catch(() => {});\r\n}\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n.form-container {\r\n  justify-content: flex-end;\r\n\r\n  .el-input {\r\n    width: 200px;\r\n  }\r\n\r\n  .el-select {\r\n    margin: 0 10px;\r\n  }\r\n}\r\n\r\n.number-quantity {\r\n  display: flex;\r\n  align-items: center;\r\n  justify-content: flex-end;\r\n  margin-top: 10px;\r\n  font-size: 14px;\r\n  color: #242934;\r\n\r\n  span {\r\n    font-size: 16px;\r\n    font-weight: 600;\r\n    color: #f12525;\r\n  }\r\n}\r\n\r\n.company {\r\n  margin-right: 10px;\r\n}\r\n</style>\r\n","import script from \"./list.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./list.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./list.vue?vue&type=style&index=0&id=2ce99893&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-2ce99893\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","key","_defineComponent","name","__name","setup","__props","CustomImportFile","defineAsyncComponent","CustomImportErrorFile","RealNameAuthenticationDialog","goPage","useVueRouter","userInfo","LocalStorage","getItem","agentId","importFileRef","ref","importErrorFileRef","realNameRef","paramsData","shallowReactive","companyName","getList","pageNumberChange","pageSizeChange","pageData","resetPageNumber","usePage","listApi","businessManagementListApi","props","pageSize","pageNumber","searchParams","agentUserId","profileId","handleSearch","importErrorContent","_importErrorFileRef$v","value","toggle","handRealName","_realNameRef$value","importNumber","trigger","data","limit","autoUpload","accept","actionUrl","serviceName","callRest","templateUrl","downloadFile","api","handleJumpPage","info","query","companyId","companyCode","businessType","Reflect","set","code","path","openRecharge","ElMessageBox","prompt","confirmButtonText","cancelButtonText","then","async","trim","replace","ElMessage","type","message","isNaN","regex","test","updateAccountApi","getData","agencyId","amount","tradeType","profileName","realName","catch","openDeduction","companyRemaining","_ctx","_cache","_component_el_input","_resolveComponent","_component_el_button","_component_el_table_column","_component_el_link","_component_TableEmpty","_component_el_table","_component_PagePagination","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_createVNode","modelValue","_unref","$event","placeholder","onClick","default","_withCtx","_createTextVNode","_","list","height","empty","prop","label","align","width","row","underline","ecSwitch","_createCommentVNode","pageTotal","onEmitPageSizeChange","onEmitPageNumberChange","ref_key","onEmitFunc","__exports__"],"sourceRoot":""}