{"version":3,"file":"static/js/2189.f92064d1.js","mappings":"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","sources":["webpack://daili/./src/components/order-management/create-order/product-detail/added-service.vue?7b17","webpack://daili/./src/components/order-management/create-order/product-detail/added-service.vue","webpack://daili/./src/components/order-management/create-order/product-detail/added-service.vue?21a8"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode, resolveComponent as _resolveComponent, withCtx as _withCtx, createBlock as _createBlock, createCommentVNode as _createCommentVNode, unref as _unref } from \"vue\"\nimport _imports_0 from '@/assets/images/icon-question.png'\n\n\nconst _hoisted_1 = { class: \"product-detail\" }\nconst _hoisted_2 = { class: \"service-specs\" }\nconst _hoisted_3 = {\n  key: 1,\n  class: \"word\"\n}\nconst _hoisted_4 = {\n  key: 2,\n  class: \"word\"\n}\n\nimport { computed, shallowReactive, shallowRef } from \"vue\";\r\n\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\n\r\nimport BaseSumPrice from \"./base-sum-price.vue\";\r\nimport BaseServiceInfo from \"./base-service-info.vue\";\r\nimport {\r\n  createdOrder,\r\n  handlePrice,\r\n} from \"@components/order-management/create-order/product-detail/common\";\r\n\r\nconst describeContent = `使用【图文转视频】服务，生成1分钟视频抵扣0.1八豆，视频中自动匹配的版权图片以1.5八豆/每张进行抵扣（若匹配素材广场和客户自有图片，不额外抵扣八豆）<br>\r\n  eg：生成X秒视频所消耗的八豆=X/60* 0.1+ （n张版权图*1.5)<br>\r\n  使用【视频拆条】服务，输入1分钟视频，抵扣0.5八豆<br>\r\n  使用【智能卡片工具、剪同款模板、智能推荐模板、自动剪辑成片、视频混剪】服务，生成1分钟视频，抵扣0.1八豆<br>\r\n  使用【智能卡片工具、图文转视频】服务中的通用数字人功能，下载1分钟视频，额外抵扣0.7八豆.<br>\r\n  【视频裁剪】、【智能配音】、【添加品牌】、【web编辑器】服务不扣八豆。`;\r\n\r\n// 不能购买提示\r\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'added-service',\n  props: {\n    productData: {},\n    purchasedData: {}\n  },\n  setup(__props: any) {\n\r\nconst props = __props;\r\n\r\nconst { routeQuery } = useVueRouter();\r\nconst { serviceCode } = routeQuery.value;\r\nconst { bd_userInfo: userInfo } = LocalStorage.batchGetItem([\"bd_userInfo\"]);\r\nconst initData = shallowReactive<{\r\n  count: string | number;\r\n  customCount: number;\r\n  sumPrice: string | number;\r\n}>({\r\n  count: \"\",\r\n  customCount: 1,\r\n  sumPrice: \"0.00\",\r\n});\r\n// 购买的商品价格信息\r\nconst agentInfo = shallowRef({\r\n  price: \"0.00\",\r\n  sumPrice: \"0.00\",\r\n  unitPrice: 0,\r\n  subMarketList: [],\r\n  hasAgentPrice: false,\r\n});\r\n// 购买信息\r\nconst purchasedInfo: Record<string, any> = computed(() => {\r\n  return props.purchasedData ?? [];\r\n});\r\n// 所有信息\r\nconst productInfo: Record<string, any> = computed(() => {\r\n  return props.productData;\r\n});\r\n// 服务基本信息\r\nconst serviceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value.serviceInfo;\r\n});\r\n// 增值服务信息\r\nconst addedServiceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value?.addedServiceList[0];\r\n});\r\n// 规格列表\r\nconst specsList = computed(() => {\r\n  let specsList: Record<string, any> = [];\r\n  if (addedServiceInfo.value.specsList.length) {\r\n    specsList = addedServiceInfo.value.specsList.map((item) => {\r\n      return {\r\n        groupNames: item.groupNames,\r\n        // TODO: 云查客坐席产品配置了自定义的sku\r\n        groupValues: item.groupValues,\r\n        groupCodes: item.groupCodes,\r\n        minNum: item.minNum,\r\n        maxNum: item.maxNum,\r\n        coding: item.coding,\r\n        unitPrice: item.unitPrice,\r\n        serviceCode: item.serviceCode,\r\n      };\r\n    });\r\n    // TODO: 云查客坐席产品配置了自定义的sku\r\n    if (addedServiceInfo.value.isDiy) {\r\n      specsList.push({\r\n        groupNames: \"自定义\",\r\n        groupValues: \"custom\",\r\n      });\r\n    }\r\n  }\r\n  return specsList;\r\n});\r\n// 最大值，最小值\r\nconst limitCount = computed(() => {\r\n  let min = 0;\r\n  let max = 0;\r\n  addedServiceInfo.value.specsList.forEach((item, index) => {\r\n    if (index === 0) {\r\n      min = item.minNum;\r\n      max = item.maxNum;\r\n    } else {\r\n      if (min > item.minNum) {\r\n        min = item.minNum;\r\n      }\r\n      if (max < item.maxNum) {\r\n        max = item.maxNum;\r\n      }\r\n    }\r\n  });\r\n  return {\r\n    min,\r\n    max,\r\n  };\r\n});\r\n// 数量\r\nconst count = computed(() => {\r\n  return initData.count === \"custom\" ? initData.customCount : initData.count;\r\n});\r\n// 当前选中规格\r\nconst specsInfo = computed(() => {\r\n  const buyNum = purchasedInfo.value[0]?.resourceCount ?? 0;\r\n  const sumNum = Number(count.value) + Number(buyNum);\r\n  return specsList.value.find((item) => {\r\n    return item.minNum <= sumNum && sumNum <= item.maxNum;\r\n  });\r\n});\r\n// 剩余天数\r\nconst surplusDate = computed(() => {\r\n  const startDate = dayjs().startOf(\"day\");\r\n  const endDate = dayjs(purchasedInfo.value[0]?.endTime).endOf(\"day\");\r\n  return endDate.diff(startDate, \"day\") + 1;\r\n});\r\n// 总计描述\r\nconst amountDesc = computed(() => {\r\n  const surplus = purchasedInfo.value.length\r\n    ? `剩余天数${surplusDate.value} / 365天 x `\r\n    : \"\";\r\n  if (\r\n    [\r\n      \"STORE_SERVICE\", // 云盘服务\r\n      \"CUSTOMER_SERVICE\", // 客户增量\r\n      \"ACCOUNT_ACCESS_21S\", // 账户数\r\n      \"VIDEO_MATRIX_ACCOUNT\", // 视频矩阵账号\r\n      \"PRO_CUS_UNLOCHED_ADD\", // 解锁额度增量包\r\n    ].includes(serviceCode)\r\n  ) {\r\n    return `合计：${surplus}商品单价${agentInfo.value.unitPrice}元 x ${count.value}${serviceInfo.value.unit} = ${agentInfo.value.sumPrice}元`;\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n// 说明提示\r\nconst describeText = computed(() => {\r\n  if ([\"BADOU_21S\"].includes(serviceCode)) {\r\n    return `说明：八豆：视频生成分钟数，不同的功能项会消耗不同等值的八豆`;\r\n  } else if ([\"INTERFACES_21S\"].includes(serviceCode)) {\r\n    return `说明：接口数：是指开启会话数、评论查看、评论回复接口调用次数`;\r\n  } else if ([\"ACCOUNT_ACCESS_21S\"].includes(serviceCode)) {\r\n    return `说明：不同的账户可设置不同的团队`;\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n\r\n// 使用说明\r\nconst canBuyTip = computed(() => {\r\n  if ([\"PRO_CUS_UNLOCHED_ADD\", \"PRO_CUS_SEAT_ADD\"].includes(serviceCode)) {\r\n    return \"购买此产品前，需要先买云查客企业版\";\r\n  } else if (\r\n    [\"BADOU_21S\", \"ACCOUNT_ACCESS_21S\", \"INTERFACES_21S\"].includes(serviceCode)\r\n  ) {\r\n    return \"购买此产品前，需要先买21秒云集客套餐\";\r\n  } else if ([\"VIDEO_MATRIX_ACCOUNT\"].includes(serviceCode)) {\r\n    return \"购买此产品前，需要先买视频矩阵\";\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n\r\n// 初始化数据\r\nhandleDefault();\r\n\r\nfunction handleDefault() {\r\n  initData.count = specsList.value[0]?.groupValues;\r\n  initData.customCount = specsList.value[0]?.groupValues;\r\n  getPrice();\r\n}\r\n\r\n// 计算价格\r\nasync function getPrice() {\r\n  const params = handleParams().params;\r\n  agentInfo.value = await handlePrice(params);\r\n}\r\n\r\n// 获取价格参数\r\nfunction handleParams() {\r\n  const params = {\r\n    agentId: userInfo.profileId, // 代理商id\r\n    buyCar: false, // 是否为购物车下单\r\n    helpOrder: 1, // 是否代客下单0：否，1：是\r\n    buyType: routeQuery.value.buyType ?? \"BUY_SERVER\", // 购买：BUY_SERVER,升级：UPGRADE,续费：RENEW\r\n    companyId: routeQuery.value.companyId, // 代理商子公司id\r\n    profileId: routeQuery.value.profileId, // 代理商子公司操作人id\r\n    shopBuyList: [\r\n      {\r\n        agentId: userInfo.profileId,\r\n        isisTry: false, // 是否试用\r\n        dateType: \"3\", // 时间单位 1:日, 2:月, 3:年\r\n        dateValue: 1, // 时长\r\n        marketCode: serviceCode,\r\n        coding: [\r\n          {\r\n            code: specsInfo.value.serviceCode,\r\n            coding: specsInfo.value.coding,\r\n            num: count.value,\r\n          },\r\n        ],\r\n        baseCodeList: [\r\n          {\r\n            baseCode: specsInfo.value.groupCodes,\r\n            number: count.value,\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.price,\r\n  };\r\n  const commodityInfo = {\r\n    list: [\r\n      {\r\n        ...serviceInfo.value,\r\n        price: agentInfo.value.price,\r\n        specsInfo: `购买数量：${count.value}${serviceInfo.value.unit}`,\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.sumPrice,\r\n  };\r\n  return {\r\n    params,\r\n    commodityInfo,\r\n  };\r\n}\r\n\r\nfunction handleBuy() {\r\n  createdOrder(handleParams());\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_form_item = _resolveComponent(\"el-form-item\")!\n  const _component_el_option = _resolveComponent(\"el-option\")!\n  const _component_el_select = _resolveComponent(\"el-select\")!\n  const _component_el_input_number = _resolveComponent(\"el-input-number\")!\n  const _component_el_tooltip = _resolveComponent(\"el-tooltip\")!\n  const _component_el_form = _resolveComponent(\"el-form\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(BaseServiceInfo, { serviceData: serviceInfo.value }, null, 8, [\"serviceData\"]),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(_component_el_form, { \"label-width\": \"150px\" }, {\n        default: _withCtx(() => [\n          (purchasedInfo.value.length)\n            ? (_openBlock(), _createBlock(_component_el_form_item, {\n                key: 0,\n                label: \"已购详情\"\n              }, {\n                default: _withCtx(() => [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(purchasedInfo.value, (item, index) => {\n                    return (_openBlock(), _createElementBlock(\"div\", {\n                      class: \"purchased-info\",\n                      key: index\n                    }, [\n                      _createElementVNode(\"span\", null, \"已购数量：\" + _toDisplayString(item.resourceCount) + _toDisplayString(serviceInfo.value.unit), 1),\n                      _createElementVNode(\"span\", null, \"服务到期时间：\" + _toDisplayString(item.endTime), 1)\n                    ]))\n                  }), 128))\n                ]),\n                _: 1\n              }))\n            : _createCommentVNode(\"\", true),\n          _createVNode(_component_el_form_item, {\n            label: \"购买数量\",\n            class: \"amount-form-item\"\n          }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_select, {\n                modelValue: _unref(initData).count,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(initData).count) = $event)),\n                onChange: getPrice\n              }, {\n                default: _withCtx(() => [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(specsList.value, (item) => {\n                    return (_openBlock(), _createBlock(_component_el_option, {\n                      key: item.groupValues,\n                      label: item.groupNames,\n                      value: item.groupValues\n                    }, null, 8, [\"label\", \"value\"]))\n                  }), 128))\n                ]),\n                _: 1\n              }, 8, [\"modelValue\"]),\n              (_unref(initData).count === 'custom')\n                ? (_openBlock(), _createBlock(_component_el_input_number, {\n                    key: 0,\n                    modelValue: _unref(initData).customCount,\n                    \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_unref(initData).customCount) = $event)),\n                    min: limitCount.value.min,\n                    max: limitCount.value.max,\n                    step: addedServiceInfo.value.miniNum,\n                    onChange: getPrice\n                  }, null, 8, [\"modelValue\", \"min\", \"max\", \"step\"]))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, null, {\n            default: _withCtx(() => [\n              (['BADOU_21S'].includes(_unref(serviceCode)))\n                ? (_openBlock(), _createBlock(_component_el_tooltip, {\n                    key: 0,\n                    placement: \"top-start\",\n                    trigger: \"hover\",\n                    \"popper-class\": \"custom-tooltip\"\n                  }, {\n                    content: _withCtx(() => [\n                      _createElementVNode(\"div\", { innerHTML: describeContent })\n                    ]),\n                    default: _withCtx(() => [\n                      _cache[2] || (_cache[2] = _createElementVNode(\"img\", {\n                        class: \"question-icon\",\n                        src: _imports_0,\n                        alt: \"\"\n                      }, null, -1))\n                    ]),\n                    _: 1\n                  }))\n                : _createCommentVNode(\"\", true),\n              (productInfo.value.canBuy)\n                ? (_openBlock(), _createElementBlock(\"p\", _hoisted_3, _toDisplayString(amountDesc.value), 1))\n                : _createCommentVNode(\"\", true),\n              (describeText.value)\n                ? (_openBlock(), _createElementBlock(\"p\", _hoisted_4, _toDisplayString(describeText.value), 1))\n                : _createCommentVNode(\"\", true)\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(BaseSumPrice, {\n        tip: canBuyTip.value,\n        onEmitFunc: handleBuy,\n        \"buy-price\": agentInfo.value.price,\n        \"can-buy\": productInfo.value?.canBuy,\n        hasAgentPrice: agentInfo.value.hasAgentPrice\n      }, null, 8, [\"tip\", \"buy-price\", \"can-buy\", \"hasAgentPrice\"])\n    ])\n  ]))\n}\n}\n\n})","<template>\r\n  <div class=\"product-detail\">\r\n    <BaseServiceInfo :serviceData=\"serviceInfo\"></BaseServiceInfo>\r\n    <div class=\"service-specs\">\r\n      <el-form label-width=\"150px\">\r\n        <template v-if=\"purchasedInfo.length\">\r\n          <el-form-item label=\"已购详情\">\r\n            <div\r\n              class=\"purchased-info\"\r\n              v-for=\"(item, index) in purchasedInfo\"\r\n              :key=\"index\"\r\n            >\r\n              <span\r\n                >已购数量：{{ item.resourceCount }}{{ serviceInfo.unit }}</span\r\n              >\r\n              <span>服务到期时间：{{ item.endTime }}</span>\r\n            </div>\r\n          </el-form-item>\r\n        </template>\r\n        <el-form-item label=\"购买数量\" class=\"amount-form-item\">\r\n          <el-select v-model=\"initData.count\" @change=\"getPrice\">\r\n            <el-option\r\n              v-for=\"item in specsList\"\r\n              :key=\"item.groupValues\"\r\n              :label=\"item.groupNames\"\r\n              :value=\"item.groupValues\"\r\n            />\r\n          </el-select>\r\n          <el-input-number\r\n            v-if=\"initData.count === 'custom'\"\r\n            v-model=\"initData.customCount\"\r\n            :min=\"limitCount.min\"\r\n            :max=\"limitCount.max\"\r\n            :step=\"addedServiceInfo.miniNum\"\r\n            @change=\"getPrice\"\r\n          />\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <el-tooltip\r\n            v-if=\"['BADOU_21S'].includes(serviceCode)\"\r\n            placement=\"top-start\"\r\n            trigger=\"hover\"\r\n            popper-class=\"custom-tooltip\"\r\n          >\r\n            <template #content>\r\n              <div v-html=\"describeContent\"></div>\r\n            </template>\r\n            <img\r\n              class=\"question-icon\"\r\n              src=\"@/assets/images/icon-question.png\"\r\n              alt=\"\"\r\n            />\r\n          </el-tooltip>\r\n          <p class=\"word\" v-if=\"productInfo.canBuy\">{{ amountDesc }}</p>\r\n          <p class=\"word\" v-if=\"describeText\">{{ describeText }}</p>\r\n        </el-form-item>\r\n      </el-form>\r\n      <BaseSumPrice\r\n        :tip=\"canBuyTip\"\r\n        @emitFunc=\"handleBuy\"\r\n        :buy-price=\"agentInfo.price\"\r\n        :can-buy=\"productInfo?.canBuy\"\r\n        :hasAgentPrice=\"agentInfo.hasAgentPrice\"\r\n      ></BaseSumPrice>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed, shallowReactive, shallowRef } from \"vue\";\r\n\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\n\r\nimport BaseSumPrice from \"./base-sum-price.vue\";\r\nimport BaseServiceInfo from \"./base-service-info.vue\";\r\nimport {\r\n  createdOrder,\r\n  handlePrice,\r\n} from \"@components/order-management/create-order/product-detail/common\";\r\n\r\nconst props = defineProps<{\r\n  productData: Record<string, any>;\r\n  purchasedData: Record<string, any>[];\r\n}>();\r\n\r\nconst { routeQuery } = useVueRouter();\r\nconst { serviceCode } = routeQuery.value;\r\nconst { bd_userInfo: userInfo } = LocalStorage.batchGetItem([\"bd_userInfo\"]);\r\nconst initData = shallowReactive<{\r\n  count: string | number;\r\n  customCount: number;\r\n  sumPrice: string | number;\r\n}>({\r\n  count: \"\",\r\n  customCount: 1,\r\n  sumPrice: \"0.00\",\r\n});\r\n// 购买的商品价格信息\r\nconst agentInfo = shallowRef({\r\n  price: \"0.00\",\r\n  sumPrice: \"0.00\",\r\n  unitPrice: 0,\r\n  subMarketList: [],\r\n  hasAgentPrice: false,\r\n});\r\n// 购买信息\r\nconst purchasedInfo: Record<string, any> = computed(() => {\r\n  return props.purchasedData ?? [];\r\n});\r\n// 所有信息\r\nconst productInfo: Record<string, any> = computed(() => {\r\n  return props.productData;\r\n});\r\n// 服务基本信息\r\nconst serviceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value.serviceInfo;\r\n});\r\n// 增值服务信息\r\nconst addedServiceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value?.addedServiceList[0];\r\n});\r\n// 规格列表\r\nconst specsList = computed(() => {\r\n  let specsList: Record<string, any> = [];\r\n  if (addedServiceInfo.value.specsList.length) {\r\n    specsList = addedServiceInfo.value.specsList.map((item) => {\r\n      return {\r\n        groupNames: item.groupNames,\r\n        // TODO: 云查客坐席产品配置了自定义的sku\r\n        groupValues: item.groupValues,\r\n        groupCodes: item.groupCodes,\r\n        minNum: item.minNum,\r\n        maxNum: item.maxNum,\r\n        coding: item.coding,\r\n        unitPrice: item.unitPrice,\r\n        serviceCode: item.serviceCode,\r\n      };\r\n    });\r\n    // TODO: 云查客坐席产品配置了自定义的sku\r\n    if (addedServiceInfo.value.isDiy) {\r\n      specsList.push({\r\n        groupNames: \"自定义\",\r\n        groupValues: \"custom\",\r\n      });\r\n    }\r\n  }\r\n  return specsList;\r\n});\r\n// 最大值，最小值\r\nconst limitCount = computed(() => {\r\n  let min = 0;\r\n  let max = 0;\r\n  addedServiceInfo.value.specsList.forEach((item, index) => {\r\n    if (index === 0) {\r\n      min = item.minNum;\r\n      max = item.maxNum;\r\n    } else {\r\n      if (min > item.minNum) {\r\n        min = item.minNum;\r\n      }\r\n      if (max < item.maxNum) {\r\n        max = item.maxNum;\r\n      }\r\n    }\r\n  });\r\n  return {\r\n    min,\r\n    max,\r\n  };\r\n});\r\n// 数量\r\nconst count = computed(() => {\r\n  return initData.count === \"custom\" ? initData.customCount : initData.count;\r\n});\r\n// 当前选中规格\r\nconst specsInfo = computed(() => {\r\n  const buyNum = purchasedInfo.value[0]?.resourceCount ?? 0;\r\n  const sumNum = Number(count.value) + Number(buyNum);\r\n  return specsList.value.find((item) => {\r\n    return item.minNum <= sumNum && sumNum <= item.maxNum;\r\n  });\r\n});\r\n// 剩余天数\r\nconst surplusDate = computed(() => {\r\n  const startDate = dayjs().startOf(\"day\");\r\n  const endDate = dayjs(purchasedInfo.value[0]?.endTime).endOf(\"day\");\r\n  return endDate.diff(startDate, \"day\") + 1;\r\n});\r\n// 总计描述\r\nconst amountDesc = computed(() => {\r\n  const surplus = purchasedInfo.value.length\r\n    ? `剩余天数${surplusDate.value} / 365天 x `\r\n    : \"\";\r\n  if (\r\n    [\r\n      \"STORE_SERVICE\", // 云盘服务\r\n      \"CUSTOMER_SERVICE\", // 客户增量\r\n      \"ACCOUNT_ACCESS_21S\", // 账户数\r\n      \"VIDEO_MATRIX_ACCOUNT\", // 视频矩阵账号\r\n      \"PRO_CUS_UNLOCHED_ADD\", // 解锁额度增量包\r\n    ].includes(serviceCode)\r\n  ) {\r\n    return `合计：${surplus}商品单价${agentInfo.value.unitPrice}元 x ${count.value}${serviceInfo.value.unit} = ${agentInfo.value.sumPrice}元`;\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n// 说明提示\r\nconst describeText = computed(() => {\r\n  if ([\"BADOU_21S\"].includes(serviceCode)) {\r\n    return `说明：八豆：视频生成分钟数，不同的功能项会消耗不同等值的八豆`;\r\n  } else if ([\"INTERFACES_21S\"].includes(serviceCode)) {\r\n    return `说明：接口数：是指开启会话数、评论查看、评论回复接口调用次数`;\r\n  } else if ([\"ACCOUNT_ACCESS_21S\"].includes(serviceCode)) {\r\n    return `说明：不同的账户可设置不同的团队`;\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n\r\n// 使用说明\r\nconst describeContent = `使用【图文转视频】服务，生成1分钟视频抵扣0.1八豆，视频中自动匹配的版权图片以1.5八豆/每张进行抵扣（若匹配素材广场和客户自有图片，不额外抵扣八豆）<br>\r\n  eg：生成X秒视频所消耗的八豆=X/60* 0.1+ （n张版权图*1.5)<br>\r\n  使用【视频拆条】服务，输入1分钟视频，抵扣0.5八豆<br>\r\n  使用【智能卡片工具、剪同款模板、智能推荐模板、自动剪辑成片、视频混剪】服务，生成1分钟视频，抵扣0.1八豆<br>\r\n  使用【智能卡片工具、图文转视频】服务中的通用数字人功能，下载1分钟视频，额外抵扣0.7八豆.<br>\r\n  【视频裁剪】、【智能配音】、【添加品牌】、【web编辑器】服务不扣八豆。`;\r\n\r\n// 不能购买提示\r\nconst canBuyTip = computed(() => {\r\n  if ([\"PRO_CUS_UNLOCHED_ADD\", \"PRO_CUS_SEAT_ADD\"].includes(serviceCode)) {\r\n    return \"购买此产品前，需要先买云查客企业版\";\r\n  } else if (\r\n    [\"BADOU_21S\", \"ACCOUNT_ACCESS_21S\", \"INTERFACES_21S\"].includes(serviceCode)\r\n  ) {\r\n    return \"购买此产品前，需要先买21秒云集客套餐\";\r\n  } else if ([\"VIDEO_MATRIX_ACCOUNT\"].includes(serviceCode)) {\r\n    return \"购买此产品前，需要先买视频矩阵\";\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n\r\n// 初始化数据\r\nhandleDefault();\r\n\r\nfunction handleDefault() {\r\n  initData.count = specsList.value[0]?.groupValues;\r\n  initData.customCount = specsList.value[0]?.groupValues;\r\n  getPrice();\r\n}\r\n\r\n// 计算价格\r\nasync function getPrice() {\r\n  const params = handleParams().params;\r\n  agentInfo.value = await handlePrice(params);\r\n}\r\n\r\n// 获取价格参数\r\nfunction handleParams() {\r\n  const params = {\r\n    agentId: userInfo.profileId, // 代理商id\r\n    buyCar: false, // 是否为购物车下单\r\n    helpOrder: 1, // 是否代客下单0：否，1：是\r\n    buyType: routeQuery.value.buyType ?? \"BUY_SERVER\", // 购买：BUY_SERVER,升级：UPGRADE,续费：RENEW\r\n    companyId: routeQuery.value.companyId, // 代理商子公司id\r\n    profileId: routeQuery.value.profileId, // 代理商子公司操作人id\r\n    shopBuyList: [\r\n      {\r\n        agentId: userInfo.profileId,\r\n        isisTry: false, // 是否试用\r\n        dateType: \"3\", // 时间单位 1:日, 2:月, 3:年\r\n        dateValue: 1, // 时长\r\n        marketCode: serviceCode,\r\n        coding: [\r\n          {\r\n            code: specsInfo.value.serviceCode,\r\n            coding: specsInfo.value.coding,\r\n            num: count.value,\r\n          },\r\n        ],\r\n        baseCodeList: [\r\n          {\r\n            baseCode: specsInfo.value.groupCodes,\r\n            number: count.value,\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.price,\r\n  };\r\n  const commodityInfo = {\r\n    list: [\r\n      {\r\n        ...serviceInfo.value,\r\n        price: agentInfo.value.price,\r\n        specsInfo: `购买数量：${count.value}${serviceInfo.value.unit}`,\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.sumPrice,\r\n  };\r\n  return {\r\n    params,\r\n    commodityInfo,\r\n  };\r\n}\r\n\r\nfunction handleBuy() {\r\n  createdOrder(handleParams());\r\n}\r\n</script>\r\n\r\n<style scoped lang=\"scss\">\r\n@use \"./common.scss\" as *;\r\n</style>\r\n","import script from \"./added-service.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./added-service.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./added-service.vue?vue&type=style&index=0&id=f3ce01f2&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-f3ce01f2\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","key","_hoisted_4","describeContent","_defineComponent","__name","props","productData","purchasedData","setup","__props","routeQuery","useVueRouter","serviceCode","value","bd_userInfo","userInfo","LocalStorage","batchGetItem","initData","shallowReactive","count","customCount","sumPrice","agentInfo","shallowRef","price","unitPrice","subMarketList","hasAgentPrice","purchasedInfo","computed","productInfo","serviceInfo","addedServiceInfo","_productInfo$value","addedServiceList","specsList","length","map","item","groupNames","groupValues","groupCodes","minNum","maxNum","coding","isDiy","push","limitCount","min","max","forEach","index","specsInfo","_purchasedInfo$value$","buyNum","resourceCount","sumNum","Number","find","surplusDate","_purchasedInfo$value$2","startDate","dayjs","startOf","endDate","endTime","endOf","diff","amountDesc","surplus","includes","unit","describeText","canBuyTip","handleDefault","_specsList$value$","_specsList$value$2","getPrice","async","params","handleParams","handlePrice","agentId","profileId","buyCar","helpOrder","buyType","companyId","shopBuyList","isisTry","dateType","dateValue","marketCode","code","num","baseCodeList","baseCode","number","commodityInfo","list","handleBuy","createdOrder","_ctx","_cache","_productInfo$value2","_component_el_form_item","_resolveComponent","_component_el_option","_component_el_select","_component_el_input_number","_component_el_tooltip","_component_el_form","_openBlock","_createElementBlock","_createVNode","BaseServiceInfo","serviceData","_createElementVNode","default","_withCtx","_createBlock","label","_Fragment","_renderList","_toDisplayString","_","_createCommentVNode","modelValue","_unref","$event","onChange","step","miniNum","placement","trigger","content","innerHTML","src","_imports_0","alt","canBuy","BaseSumPrice","tip","onEmitFunc","__exports__"],"sourceRoot":""}