"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[4789],{74789:function(e,t,l){l.r(t),l.d(t,{default:function(){return R}});var a=l(6254),i=l(25598),s=l(38627),o=l(88365),n=l(10901),u=l(79689),d=l(59259);const m={class:"body-container"},r={class:"dialog-footer"};var p=(0,a.pM)({__name:"add-follow-dialog",props:{visible:{type:Boolean}},emits:["update:visible","emitFunc"],setup(e,{emit:t}){const l=t,{routeQuery:s}=(0,n.dG)(),o=(0,i.Gc)({message:"",fileList:[],defaultFileList:[]}),p=()=>{l("update:visible",!1),o.message="",o.defaultFileList=[],o.fileList=[]};function c(e){o.fileList=e}const g=()=>{if(o.message||o.defaultFileList.length>0){const e={attachment:o.fileList.toString(),followContent:o.message,followType:1,relevanceId:s.value.companyId};u.ei.getData(e).then((e=>{0===e.statusCode?(d.nk.success("新增跟进成功！"),l("emitFunc"),p()):d.nk.error("新增跟进失败！")}))}else d.nk.warning("请至少输入跟进信息或上传附件！")};return(e,t)=>{const l=(0,a.g2)("el-input"),s=(0,a.g2)("el-form-item"),n=(0,a.g2)("CustomUpload"),u=(0,a.g2)("el-form"),d=(0,a.g2)("el-button"),f=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.Wv)(f,{width:"750px",title:"新增跟进","model-value":e.visible,class:"custom-dialog",onClose:p},{footer:(0,a.k6)((()=>[(0,a.Lk)("div",r,[(0,a.bF)(d,{onClick:p},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("取 消")]))),_:1}),(0,a.bF)(d,{type:"primary",onClick:g},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("保 存")]))),_:1})])])),default:(0,a.k6)((()=>[(0,a.Lk)("div",m,[(0,a.bF)(u,{ref:"ruleFormRef",model:(0,i.R1)(o),"label-position":"top"},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"跟进信息"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{modelValue:(0,i.R1)(o).message,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,i.R1)(o).message=e),maxlength:"100",class:"box-textarea",placeholder:"请输入","show-word-limit":"",rows:4,type:"textarea"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"跟进附件"},{default:(0,a.k6)((()=>[(0,a.bF)(n,{listType:"picture-card",limit:5,maxVolume:10,defaultFileList:(0,i.R1)(o).defaultFileList,"onUpdate:defaultFileList":t[1]||(t[1]=e=>(0,i.R1)(o).defaultFileList=e),onEmitUpload:c,tip:"支持.jpg、.jpeg、.png格式，最多只能上传5张"},null,8,["defaultFileList"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["model-value"])}}}),c=l(83936);const g=(0,c.A)(p,[["__scopeId","data-v-73633e6a"]]);var f=g;const b={class:"timeline-content"},v={class:"follow-record"},k={class:"write-time"},F={class:"information"},h={class:"message"},w={class:"box-item"},y={key:0,class:"attachment-img"},L={key:1};var C=(0,a.pM)({__name:"follow-records",setup(e){const{routeQuery:t}=(0,n.dG)(),l=(0,i.Kh)({addFollowVisible:!1}),{getList:d,pageNumberChange:m,pageSizeChange:r,pageData:p}=(0,o.N5)({listApi:u.j4,props:{pageSize:"pageSize",pageNumber:"page"},searchParams:()=>({followType:1,relevanceId:t.value.companyId})}),c=()=>{l.addFollowVisible=!0};return(e,t)=>{const o=(0,a.g2)("el-button"),n=(0,a.g2)("el-image"),u=(0,a.g2)("el-card"),g=(0,a.g2)("el-timeline-item"),C=(0,a.g2)("el-timeline"),_=(0,a.g2)("TableEmpty"),R=(0,a.g2)("PagePagination");return(0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("div",v,[t[2]||(t[2]=(0,a.Lk)("h4",null,"跟进记录",-1)),(0,a.bF)(o,{type:"primary",onClick:c},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("新增跟进")]))),_:1})]),(0,a.Lk)("div",k,[(0,i.R1)(p).list.length?((0,a.uX)(),(0,a.Wv)(C,{key:0,class:"timeline"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,i.R1)(p).list,((e,l)=>((0,a.uX)(),(0,a.Wv)(g,{key:l,timestamp:e.createdTime,placement:"top"},{default:(0,a.k6)((()=>[(0,a.bF)(u,{class:"write"},{default:(0,a.k6)((()=>[(0,a.Lk)("div",F,[(0,a.Lk)("p",h,"跟进信息："+(0,s.v_)(e.followContent),1),(0,a.Lk)("div",w,[t[3]||(t[3]=(0,a.Lk)("p",{class:"attachment"},"跟进附件：",-1)),e.attachment&&e.attachment.length>0?((0,a.uX)(),(0,a.CE)("div",y,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.attachment,((e,t)=>((0,a.uX)(),(0,a.Wv)(n,{key:t,class:"img-item",src:e,"preview-src-list":[e],fit:"cover"},null,8,["src","preview-src-list"])))),128))])):((0,a.uX)(),(0,a.CE)("p",L,"暂无"))])])])),_:2},1024)])),_:2},1032,["timestamp"])))),128))])),_:1})):((0,a.uX)(),(0,a.Wv)(_,{key:1,"empty-text":"暂无数据"}))]),(0,a.bF)(R,{pageTotal:(0,i.R1)(p).pageTotal,pageSize:(0,i.R1)(p).pageSize,pageNumber:(0,i.R1)(p).pageNumber,onEmitPageSizeChange:(0,i.R1)(r),onEmitPageNumberChange:(0,i.R1)(m)},null,8,["pageTotal","pageSize","pageNumber","onEmitPageSizeChange","onEmitPageNumberChange"]),(0,a.bF)(f,{visible:l.addFollowVisible,"onUpdate:visible":t[0]||(t[0]=e=>l.addFollowVisible=e),onEmitFunc:(0,i.R1)(d)},null,8,["visible","onEmitFunc"])])}}});const _=(0,c.A)(C,[["__scopeId","data-v-3a839b7b"]]);var R=_}}]);
//# sourceMappingURL=4789.e395eea2.js.map