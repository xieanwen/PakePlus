"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[4993],{16083:function(e,a,t){t.r(a),t.d(a,{default:function(){return C}});var o=t(6254),s=t(25598),l=t(38627),d=t(59259),r=t(616),n=t(88365),i=t(27656),c=t(10901),p=t(57030),u=t(74718),m=t(86220),g=t(58011);const k={class:"login"},w={class:"container"},f=["xlink:href"],v={key:0,class:"prompt"},h={class:"copyright"};var b=(0,o.pM)({name:"login",__name:"login",setup(e){const a=(0,s.KR)(),{storeState:t}=(0,c.VO)(),{routeQuery:b,goPage:y}=(0,c.dG)(),I=n.DT.getItem("bd_loginForm"),C=(0,s.Gc)({keepLogin:!1,lockPrompt:"",passwordType:"password"}),R=(0,s.Gc)({telephone:"",password:""}),D={telephone:[{validator:(e,a,t)=>{(0,i.lr)(e,a,t)},trigger:"blur"}],password:[{required:!0,message:"请输入密码",trigger:"blur"}]},T=_.throttle((async()=>{try{const e=await a.value.validate();if(!e)return;const t=await F();if(!t.state)return void(t.data&&(C.lockPrompt=t.data.msg));const o=await L();if(!o.state){if(o.data&&1===o.data.rspCode){const e=await V(!1);e.data&&1===e.data.statusCode&&(C.lockPrompt=e.data.msg)}return}await V(!0),await P(o.data.userInfo),await S(),await x()}catch(e){console.error("登录失败:",e)}}),3e3,{leading:!0,trailing:!1}),F=async()=>(C.lockPrompt="",(0,r.vf)(u.dC.getData(R.telephone))),L=async()=>{const e={auto:0,terminaltype:"WEB",passWord:R.password,userName:R.telephone},{data:a}=await u.s.getData(e),t={...null===a||void 0===a?void 0:a.userInfo,companyId:a.companyId};return n.DT.batchSetItem({bd_userInfo:t,bd_authorization:a.auth.accessToken}),C.keepLogin?n.DT.setItem("bd_loginForm",R):n.DT.removeItem("bd_loginForm"),{state:!0,data:a}},V=async e=>{const a={flag:e,userName:R.telephone};return(0,r.vf)(u.pe.getData(a))},P=async e=>{const{companyCode:a,companyId:t,mobile:o,profileId:s,realName:l}=e,d={companyCode:a,companyId:t,mobile:o,profileId:s,userName:l};return u.R0.getData(d)},S=async()=>{const{data:e}=await g.Qc.getData(),a=g.Qc.handleData(e);n.DT.setItem("bd_agentInfo",a)},x=async()=>{const{data:e}=await p.Hb.getData(),a=b.value.redirect;(0,n.qC)(R.password)?(d.nk.success("登录成功"),n.DT.batchSetItem({bd_agentId:null===e||void 0===e?void 0:e.id,bd_checkAdvice:null===e||void 0===e?void 0:e.checkAdvice,bd_checkStatus:null===e||void 0===e?void 0:e.checkStatus,bd_virCompanyId:null===e||void 0===e?void 0:e.virCompanyId,bd_existCallInterface:null===e||void 0===e?void 0:e.existCallInterface}),2===(null===e||void 0===e?void 0:e.checkStatus)?await y(a||"/home"):await y(a||"/certificationService")):await y("/modifyPassword")},N=()=>{"password"===C.passwordType?C.passwordType="text":C.passwordType="password"};return I&&(C.keepLogin=!0,R.password=I.password,R.telephone=I.telephone),(e,d)=>{const r=(0,o.g2)("el-input"),n=(0,o.g2)("el-form-item"),i=(0,o.g2)("el-checkbox"),c=(0,o.g2)("el-form");return(0,o.uX)(),(0,o.CE)("div",k,[(0,o.bF)(m.A,{pageName:"login"}),(0,o.Lk)("div",w,[d[5]||(d[5]=(0,o.Lk)("h6",null,"用户登录",-1)),(0,o.bF)(c,{ref_key:"formRef",ref:a,model:(0,s.R1)(R),rules:D},{default:(0,o.k6)((()=>[(0,o.bF)(n,{prop:"telephone"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{modelValue:(0,s.R1)(R).telephone,"onUpdate:modelValue":d[0]||(d[0]=e=>(0,s.R1)(R).telephone=e),modelModifiers:{trim:!0},placeholder:"手机号"},null,8,["modelValue"])])),_:1}),(0,o.bF)(n,{prop:"password",class:"password-item"},{default:(0,o.k6)((()=>[(0,o.bF)(r,{modelValue:(0,s.R1)(R).password,"onUpdate:modelValue":d[1]||(d[1]=e=>(0,s.R1)(R).password=e),modelModifiers:{trim:!0},placeholder:"密码",type:(0,s.R1)(C).passwordType},null,8,["modelValue","type"]),((0,o.uX)(),(0,o.CE)("svg",{class:"icon","aria-hidden":"true",onClick:N},[(0,o.Lk)("use",{"xlink:href":"password"===(0,s.R1)(C).passwordType?"#icon-password-hide":"#icon-password-show"},null,8,f)])),(0,s.R1)(C).lockPrompt?((0,o.uX)(),(0,o.CE)("p",v,(0,l.v_)((0,s.R1)(C).lockPrompt),1)):(0,o.Q3)("",!0)])),_:1}),(0,o.bF)(n,{class:"keep-forget-item"},{default:(0,o.k6)((()=>[(0,o.bF)(i,{modelValue:(0,s.R1)(C).keepLogin,"onUpdate:modelValue":d[2]||(d[2]=e=>(0,s.R1)(C).keepLogin=e),label:"保持登录"},null,8,["modelValue"]),(0,o.Lk)("span",{class:"forget-password",onClick:d[3]||(d[3]=e=>(0,s.R1)(y)("/forgetPassword"))},"忘记密码?")])),_:1}),(0,o.bF)(n,{class:"button-group-item"},{default:(0,o.k6)((()=>[(0,o.Lk)("div",{class:"submit-button",onClick:d[4]||(d[4]=(...e)=>(0,s.R1)(T)&&(0,s.R1)(T)(...e))},"登录")])),_:1})])),_:1},8,["model"])]),(0,o.Lk)("div",h,(0,l.v_)((0,s.R1)(t).copyright),1),d[6]||(d[6]=(0,o.Lk)("div",{id:"test"},null,-1))])}}}),y=t(83936);const I=(0,y.A)(b,[["__scopeId","data-v-62886424"]]);var C=I}}]);
//# sourceMappingURL=4993.56dc3c8d.js.map