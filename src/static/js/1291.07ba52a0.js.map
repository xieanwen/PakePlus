{"version":3,"file":"static/js/1291.07ba52a0.js","mappings":"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","sources":["webpack://daili/./src/views/business-management/osprey-cloud-call/sub-customer-package/components/add-package-drawer.vue?18a5","webpack://daili/./src/views/business-management/osprey-cloud-call/sub-customer-package/components/add-package-drawer.vue","webpack://daili/./src/views/business-management/osprey-cloud-call/sub-customer-package/components/add-package-drawer.vue?9aed"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { resolveComponent as _resolveComponent, createVNode as _createVNode, withCtx as _withCtx, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode, openBlock as _openBlock, createBlock as _createBlock } from \"vue\"\n\nimport { reactive } from \"vue\";\r\nimport { ElMessage } from \"element-plus\";\r\nimport {\r\n  addPackageApi,\r\n  editPackageApi,\r\n  packageVerificationApi,\r\n} from \"@api/customer-management-api\";\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'add-package-drawer',\n  props: {\n    visible: { type: Boolean },\n    info: {},\n    isEditing: { type: Boolean }\n  },\n  emits: [\"update:visible\", \"emitFunc\"],\n  setup(__props: any, { emit: __emit }) {\n\r\nconst agentId = LocalStorage.getItem(\"bd_agentId\");\r\nconst props = __props;\r\nconst emits = __emit;\r\nconst formData = reactive({\r\n  packageName: \"\",\r\n  minutesCount: 0,\r\n  minutesWithin: 0,\r\n  minutesOutside: 0,\r\n  seatFees: 0,\r\n  monthlyRent: 0,\r\n  collectionRules: null,\r\n  smallMonthlyRent: 0,\r\n  smallAcollectionRules: null,\r\n  isEditing: false,\r\n  id: 0,\r\n});\r\n//打开弹框\r\nconst handleOpen = () => {\r\n  if (props.isEditing && props.info) {\r\n    formData.packageName = props.info.packageName;\r\n    formData.minutesCount = props.info.packageMinutes;\r\n    formData.minutesWithin = props.info.packageInsideUnitPrice;\r\n    formData.minutesOutside = props.info.packageOutsideUnitPrice;\r\n    formData.seatFees = props.info.seatFee;\r\n    formData.monthlyRent = props.info.midNumberFee;\r\n    formData.smallMonthlyRent = props.info.smallNumberFee;\r\n    formData.collectionRules = props.info.midNumberRule;\r\n    formData.smallAcollectionRules = props.info.smallNumberRule;\r\n    formData.id = props.info.id;\r\n  } else {\r\n    formData.packageName = \"\";\r\n    formData.minutesCount = 0;\r\n    formData.minutesWithin = 0;\r\n    formData.minutesOutside = 0;\r\n    formData.seatFees = 0;\r\n    formData.monthlyRent = 0;\r\n    formData.smallAcollectionRules = null;\r\n    formData.collectionRules = null;\r\n  }\r\n};\r\n// 关闭弹框\r\nconst handleClose = () => {\r\n  emits(\"update:visible\", false);\r\n  formData.packageName = \"\";\r\n  formData.minutesCount = 0;\r\n  formData.minutesWithin = 0;\r\n  formData.minutesOutside = 0;\r\n  formData.seatFees = 0;\r\n  formData.monthlyRent = 0;\r\n  formData.collectionRules = null;\r\n  formData.smallMonthlyRent = 0;\r\n  formData.smallAcollectionRules = null;\r\n  formData.isEditing = false;\r\n};\r\n// 校验数据\r\nconst validateData = async () => {\r\n  const params = {\r\n    id: formData.id,\r\n  };\r\n  try {\r\n    const res = await packageVerificationApi.getData(params);\r\n    if (res.statusCode === 0) {\r\n      return true;\r\n    } else {\r\n      ElMessage.warning(res.msg || \"正在使用中,请勿编辑！\");\r\n      return false;\r\n    }\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n};\r\n\r\n//确定\r\nconst handleSubmit = async () => {\r\n  if (props.isEditing) {\r\n    const isValid = await validateData();\r\n    if (!isValid) return;\r\n  }\r\n  if (!formData.packageName) {\r\n    ElMessage.warning(\"套餐名称不能为空\");\r\n    return false;\r\n  }\r\n  if (formData.packageName.length > 20) {\r\n    ElMessage.warning(\"套餐名称不能超过20个字符\");\r\n    return false;\r\n  }\r\n  const params = {\r\n    agencyId: agentId,\r\n    midNumberFee: formData.monthlyRent,\r\n    midNumberRule: formData.collectionRules,\r\n    packageInsideUnitPrice: formData.minutesWithin,\r\n    packageMinutes: formData.minutesCount,\r\n    packageName: formData.packageName,\r\n    packageOutsideUnitPrice: formData.minutesOutside,\r\n    seatFee: formData.seatFees,\r\n    smallNumberFee: formData.smallMonthlyRent,\r\n    smallNumberRule: formData.smallAcollectionRules,\r\n    id: 0,\r\n  };\r\n  if (props.isEditing) {\r\n    params.id = formData.id;\r\n    editPackageApi.getData(params).then((res) => {\r\n      if (res.statusCode === 0) {\r\n        ElMessage.success(\"编辑成功\");\r\n        emits(\"emitFunc\");\r\n        handleClose();\r\n      } else {\r\n        ElMessage.warning(res.msg || \"编辑失败\");\r\n      }\r\n    });\r\n  } else {\r\n    addPackageApi.getData(params).then((res) => {\r\n      if (res.statusCode === 0) {\r\n        ElMessage.success(\"新增成功\");\r\n        emits(\"emitFunc\");\r\n        handleClose();\r\n      } else {\r\n        ElMessage.warning(res.msg || \"新增失败\");\r\n      }\r\n    });\r\n  }\r\n};\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_input = _resolveComponent(\"el-input\")!\n  const _component_el_form_item = _resolveComponent(\"el-form-item\")!\n  const _component_el_input_number = _resolveComponent(\"el-input-number\")!\n  const _component_el_form = _resolveComponent(\"el-form\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n  const _component_el_drawer = _resolveComponent(\"el-drawer\")!\n\n  return (_openBlock(), _createBlock(_component_el_drawer, {\n    \"model-value\": _ctx.visible,\n    title: _ctx.isEditing ? '编辑套餐' : '新增套餐',\n    size: \"550\",\n    class: \"custom-drawer\",\n    onOpen: handleOpen,\n    \"before-close\": handleClose\n  }, {\n    footer: _withCtx(() => [\n      _createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: handleSubmit\n      }, {\n        default: _withCtx(() => _cache[18] || (_cache[18] = [\n          _createTextVNode(\"确 定\")\n        ])),\n        _: 1\n      }),\n      _createVNode(_component_el_button, { onClick: handleClose }, {\n        default: _withCtx(() => _cache[19] || (_cache[19] = [\n          _createTextVNode(\"取 消\")\n        ])),\n        _: 1\n      })\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_component_el_form, { class: \"package-form\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_el_form_item, { label: \"套餐名称\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input, {\n                modelValue: formData.packageName,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((formData.packageName) = $event)),\n                placeholder: \"请输入\",\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"套餐分钟数\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.minutesCount,\n                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((formData.minutesCount) = $event)),\n                placeholder: \"请输入\",\n                min: 0,\n                step: 1,\n                precision: 0,\n                max: 999999,\n                controls: false,\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[9] || (_cache[9] = _createElementVNode(\"span\", null, \"分钟\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"套餐内分钟数单价\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.minutesWithin,\n                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((formData.minutesWithin) = $event)),\n                min: 0,\n                max: 999999,\n                precision: 3,\n                controls: false,\n                placeholder: \"请输入\",\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[10] || (_cache[10] = _createElementVNode(\"span\", null, \"元/分钟\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"套餐外分钟数单价\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.minutesOutside,\n                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((formData.minutesOutside) = $event)),\n                min: 0,\n                precision: 3,\n                max: 999999,\n                controls: false,\n                placeholder: \"请输入\",\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[11] || (_cache[11] = _createElementVNode(\"span\", null, \"元/分钟\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"坐席费用\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.seatFees,\n                \"onUpdate:modelValue\": _cache[4] || (_cache[4] = ($event: any) => ((formData.seatFees) = $event)),\n                min: 0,\n                precision: 3,\n                max: 999999,\n                controls: false,\n                placeholder: \"请输入\",\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[12] || (_cache[12] = _createElementVNode(\"span\", null, \"元/位/月\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"中间号月租\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.monthlyRent,\n                \"onUpdate:modelValue\": _cache[5] || (_cache[5] = ($event: any) => ((formData.monthlyRent) = $event)),\n                min: 0,\n                precision: 3,\n                max: 999999,\n                controls: false,\n                placeholder: \"请输入\",\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[13] || (_cache[13] = _createElementVNode(\"span\", null, \"元/月\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"中间号收取规则\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.collectionRules,\n                \"onUpdate:modelValue\": _cache[6] || (_cache[6] = ($event: any) => ((formData.collectionRules) = $event)),\n                min: 0,\n                max: 999999,\n                step: 1,\n                precision: 0,\n                controls: false,\n                placeholder: \"请输入\",\n                clearable: \"\",\n                class: \"rule-input\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[14] || (_cache[14] = _createElementVNode(\"span\", null, \"坐席 = 1码号\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"小号月租\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.smallMonthlyRent,\n                \"onUpdate:modelValue\": _cache[7] || (_cache[7] = ($event: any) => ((formData.smallMonthlyRent) = $event)),\n                min: 0,\n                precision: 3,\n                max: 999999,\n                controls: false,\n                placeholder: \"请输入\",\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[15] || (_cache[15] = _createElementVNode(\"span\", null, \"元/月\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"小号收取规则\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.smallAcollectionRules,\n                \"onUpdate:modelValue\": _cache[8] || (_cache[8] = ($event: any) => ((formData.smallAcollectionRules) = $event)),\n                min: 0,\n                max: 999999,\n                step: 1,\n                precision: 0,\n                controls: false,\n                placeholder: \"请输入\",\n                clearable: \"\",\n                class: \"rule-input\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[16] || (_cache[16] = _createElementVNode(\"span\", null, \"坐席 = 1码号\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, null, {\n            default: _withCtx(() => _cache[17] || (_cache[17] = [\n              _createElementVNode(\"p\", null, \" 套餐费用在坐席开通时或套餐周期开始时，从客户账户上进行扣费。如果扣费失败（客户余额不足），会导致子客户套餐续费失败。请关注客户余额。 \", -1),\n              _createElementVNode(\"p\", null, \" 注：您设置的套餐仅用于，您与客户直接进行结算计算，不影响您与代理商平台的计算。 \", -1)\n            ])),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }, 8, [\"model-value\", \"title\"]))\n}\n}\n\n})","<template>\r\n  <el-drawer\r\n    :model-value=\"visible\"\r\n    :title=\"isEditing ? '编辑套餐' : '新增套餐'\"\r\n    size=\"550\"\r\n    class=\"custom-drawer\"\r\n    @open=\"handleOpen\"\r\n    :before-close=\"handleClose\"\r\n  >\r\n    <el-form class=\"package-form\">\r\n      <el-form-item label=\"套餐名称\">\r\n        <el-input\r\n          v-model=\"formData.packageName\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"套餐分钟数\">\r\n        <el-input-number\r\n          v-model=\"formData.minutesCount\"\r\n          placeholder=\"请输入\"\r\n          :min=\"0\"\r\n          :step=\"1\"\r\n          :precision=\"0\"\r\n          :max=\"999999\"\r\n          :controls=\"false\"\r\n          clearable\r\n        />\r\n        <span>分钟</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"套餐内分钟数单价\">\r\n        <el-input-number\r\n          v-model=\"formData.minutesWithin\"\r\n          :min=\"0\"\r\n          :max=\"999999\"\r\n          :precision=\"3\"\r\n          :controls=\"false\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n        />\r\n        <span>元/分钟</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"套餐外分钟数单价\">\r\n        <el-input-number\r\n          v-model=\"formData.minutesOutside\"\r\n          :min=\"0\"\r\n          :precision=\"3\"\r\n          :max=\"999999\"\r\n          :controls=\"false\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n        />\r\n        <span>元/分钟</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"坐席费用\">\r\n        <el-input-number\r\n          v-model=\"formData.seatFees\"\r\n          :min=\"0\"\r\n          :precision=\"3\"\r\n          :max=\"999999\"\r\n          :controls=\"false\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n        />\r\n        <span>元/位/月</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"中间号月租\">\r\n        <el-input-number\r\n          v-model=\"formData.monthlyRent\"\r\n          :min=\"0\"\r\n          :precision=\"3\"\r\n          :max=\"999999\"\r\n          :controls=\"false\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n        />\r\n        <span>元/月</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"中间号收取规则\">\r\n        <el-input-number\r\n          v-model=\"formData.collectionRules\"\r\n          :min=\"0\"\r\n          :max=\"999999\"\r\n          :step=\"1\"\r\n          :precision=\"0\"\r\n          :controls=\"false\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n          class=\"rule-input\"\r\n        />\r\n        <span>坐席 = 1码号</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"小号月租\">\r\n        <el-input-number\r\n          v-model=\"formData.smallMonthlyRent\"\r\n          :min=\"0\"\r\n          :precision=\"3\"\r\n          :max=\"999999\"\r\n          :controls=\"false\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n        />\r\n        <span>元/月</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"小号收取规则\">\r\n        <el-input-number\r\n          v-model=\"formData.smallAcollectionRules\"\r\n          :min=\"0\"\r\n          :max=\"999999\"\r\n          :step=\"1\"\r\n          :precision=\"0\"\r\n          :controls=\"false\"\r\n          placeholder=\"请输入\"\r\n          clearable\r\n          class=\"rule-input\"\r\n        />\r\n        <span>坐席 = 1码号</span>\r\n      </el-form-item>\r\n      <el-form-item>\r\n        <p>\r\n          套餐费用在坐席开通时或套餐周期开始时，从客户账户上进行扣费。如果扣费失败（客户余额不足），会导致子客户套餐续费失败。请关注客户余额。\r\n        </p>\r\n        <p>\r\n          注：您设置的套餐仅用于，您与客户直接进行结算计算，不影响您与代理商平台的计算。\r\n        </p>\r\n      </el-form-item>\r\n    </el-form>\r\n    <template #footer>\r\n      <el-button type=\"primary\" @click=\"handleSubmit\">确 定</el-button>\r\n      <el-button @click=\"handleClose\">取 消</el-button>\r\n    </template>\r\n  </el-drawer>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { reactive } from \"vue\";\r\nimport { ElMessage } from \"element-plus\";\r\nimport {\r\n  addPackageApi,\r\n  editPackageApi,\r\n  packageVerificationApi,\r\n} from \"@api/customer-management-api\";\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\nconst agentId = LocalStorage.getItem(\"bd_agentId\");\r\nconst props = defineProps<{\r\n  visible: boolean;\r\n  info: Record<string, any>;\r\n  isEditing: boolean;\r\n}>();\r\nconst emits = defineEmits<{\r\n  (e: \"update:visible\", value: boolean);\r\n  (e: \"emitFunc\", value?: Record<string, any>);\r\n}>();\r\nconst formData = reactive({\r\n  packageName: \"\",\r\n  minutesCount: 0,\r\n  minutesWithin: 0,\r\n  minutesOutside: 0,\r\n  seatFees: 0,\r\n  monthlyRent: 0,\r\n  collectionRules: null,\r\n  smallMonthlyRent: 0,\r\n  smallAcollectionRules: null,\r\n  isEditing: false,\r\n  id: 0,\r\n});\r\n//打开弹框\r\nconst handleOpen = () => {\r\n  if (props.isEditing && props.info) {\r\n    formData.packageName = props.info.packageName;\r\n    formData.minutesCount = props.info.packageMinutes;\r\n    formData.minutesWithin = props.info.packageInsideUnitPrice;\r\n    formData.minutesOutside = props.info.packageOutsideUnitPrice;\r\n    formData.seatFees = props.info.seatFee;\r\n    formData.monthlyRent = props.info.midNumberFee;\r\n    formData.smallMonthlyRent = props.info.smallNumberFee;\r\n    formData.collectionRules = props.info.midNumberRule;\r\n    formData.smallAcollectionRules = props.info.smallNumberRule;\r\n    formData.id = props.info.id;\r\n  } else {\r\n    formData.packageName = \"\";\r\n    formData.minutesCount = 0;\r\n    formData.minutesWithin = 0;\r\n    formData.minutesOutside = 0;\r\n    formData.seatFees = 0;\r\n    formData.monthlyRent = 0;\r\n    formData.smallAcollectionRules = null;\r\n    formData.collectionRules = null;\r\n  }\r\n};\r\n// 关闭弹框\r\nconst handleClose = () => {\r\n  emits(\"update:visible\", false);\r\n  formData.packageName = \"\";\r\n  formData.minutesCount = 0;\r\n  formData.minutesWithin = 0;\r\n  formData.minutesOutside = 0;\r\n  formData.seatFees = 0;\r\n  formData.monthlyRent = 0;\r\n  formData.collectionRules = null;\r\n  formData.smallMonthlyRent = 0;\r\n  formData.smallAcollectionRules = null;\r\n  formData.isEditing = false;\r\n};\r\n// 校验数据\r\nconst validateData = async () => {\r\n  const params = {\r\n    id: formData.id,\r\n  };\r\n  try {\r\n    const res = await packageVerificationApi.getData(params);\r\n    if (res.statusCode === 0) {\r\n      return true;\r\n    } else {\r\n      ElMessage.warning(res.msg || \"正在使用中,请勿编辑！\");\r\n      return false;\r\n    }\r\n  } catch (error) {\r\n    return false;\r\n  }\r\n};\r\n\r\n//确定\r\nconst handleSubmit = async () => {\r\n  if (props.isEditing) {\r\n    const isValid = await validateData();\r\n    if (!isValid) return;\r\n  }\r\n  if (!formData.packageName) {\r\n    ElMessage.warning(\"套餐名称不能为空\");\r\n    return false;\r\n  }\r\n  if (formData.packageName.length > 20) {\r\n    ElMessage.warning(\"套餐名称不能超过20个字符\");\r\n    return false;\r\n  }\r\n  const params = {\r\n    agencyId: agentId,\r\n    midNumberFee: formData.monthlyRent,\r\n    midNumberRule: formData.collectionRules,\r\n    packageInsideUnitPrice: formData.minutesWithin,\r\n    packageMinutes: formData.minutesCount,\r\n    packageName: formData.packageName,\r\n    packageOutsideUnitPrice: formData.minutesOutside,\r\n    seatFee: formData.seatFees,\r\n    smallNumberFee: formData.smallMonthlyRent,\r\n    smallNumberRule: formData.smallAcollectionRules,\r\n    id: 0,\r\n  };\r\n  if (props.isEditing) {\r\n    params.id = formData.id;\r\n    editPackageApi.getData(params).then((res) => {\r\n      if (res.statusCode === 0) {\r\n        ElMessage.success(\"编辑成功\");\r\n        emits(\"emitFunc\");\r\n        handleClose();\r\n      } else {\r\n        ElMessage.warning(res.msg || \"编辑失败\");\r\n      }\r\n    });\r\n  } else {\r\n    addPackageApi.getData(params).then((res) => {\r\n      if (res.statusCode === 0) {\r\n        ElMessage.success(\"新增成功\");\r\n        emits(\"emitFunc\");\r\n        handleClose();\r\n      } else {\r\n        ElMessage.warning(res.msg || \"新增失败\");\r\n      }\r\n    });\r\n  }\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n:deep(.el-input) {\r\n  width: 240px;\r\n}\r\n.package-form {\r\n  span {\r\n    margin-left: 5px;\r\n  }\r\n  p {\r\n    color: #9ca6b9;\r\n    font-size: 14px;\r\n    line-height: normal;\r\n  }\r\n}\r\n.rule-input {\r\n  width: 80px;\r\n}\r\n</style>\r\n","import script from \"./add-package-drawer.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./add-package-drawer.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./add-package-drawer.vue?vue&type=style&index=0&id=89445b98&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-89445b98\"]])\n\nexport default __exports__"],"names":["_defineComponent","__name","props","visible","type","Boolean","info","isEditing","emits","setup","__props","emit","__emit","agentId","LocalStorage","getItem","formData","reactive","packageName","minutesCount","minutesWithin","minutesOutside","seatFees","monthlyRent","collectionRules","smallMonthlyRent","smallAcollectionRules","id","handleOpen","packageMinutes","packageInsideUnitPrice","packageOutsideUnitPrice","seatFee","midNumberFee","smallNumberFee","midNumberRule","smallNumberRule","handleClose","validateData","async","params","res","packageVerificationApi","getData","statusCode","ElMessage","warning","msg","error","handleSubmit","isValid","length","agencyId","editPackageApi","then","success","addPackageApi","_ctx","_cache","_component_el_input","_resolveComponent","_component_el_form_item","_component_el_input_number","_component_el_form","_component_el_button","_component_el_drawer","_openBlock","_createBlock","title","size","class","onOpen","footer","_withCtx","_createVNode","onClick","default","_createTextVNode","_","label","modelValue","$event","placeholder","clearable","min","step","precision","max","controls","_createElementVNode","__exports__"],"sourceRoot":""}