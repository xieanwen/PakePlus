"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[9663],{49663:function(e,l,a){a.r(l),a.d(l,{default:function(){return X}});a(95226),a(59784),a(29296),a(47961),a(70549),a(83238),a(84e3);var t=a(6254),o=a(38627),p=a(25598),i=a(35140),n=a(59259),u=a(88365),r=a(35287);const d={class:"form-tip"},s={key:0,class:"business-label"},m={class:"label-list"},v={class:"form-tip"},c={class:"form-tip"},y={style:{display:"flex","align-items":"center"}},f={class:"form-tip"},k={class:"form-tip"},b={class:"form-tip"},L={class:"form-tip"},g={class:"form-tip"},_={class:"form-tip"},h={class:"form-tip"};var V=(0,t.pM)({__name:"supplement-info-drawer",emits:["emitFunc"],setup(e,{expose:l,emit:V}){const F=(0,t.$V)((()=>a.e(5546).then(a.bind(a,55546)))),C=(0,t.$V)((()=>Promise.all([a.e(2076),a.e(3319)]).then(a.bind(a,16088)))),X=V,{bd_userInfo:K,bd_virCompanyId:O}=u.DT.batchGetItem(["bd_userInfo","bd_virCompanyId"]),I=(0,p.KR)(),B=(0,p.KR)(),T=(0,p.KR)(),U=(0,p.KR)([]),W=(0,p.KR)([]),w=(0,p.KR)([]),E=(0,p.Kh)({type:"",visible:!1,editComponents:[],editId:""}),x=(0,p.KR)({id:"",companyId:"",companyCode:"",companyName:"",businessType:""}),N=(0,p.Kh)({componentList:[]});function R(e,l){var a;const t={...l,companyId:x.value.companyId,businessType:x.value.businessType,subCompanyCode:x.value.companyCode};null===(a=T.value)||void 0===a||a.toggle(e,!0,t)}const D=async()=>{I.value&&await I.value.validate(((e,l)=>{if(e){const e=N.componentList.find((e=>9===e.propertyType&&"operator_card"===e.propertyKey)),l=e?Array.isArray(e.value)?e.value.length:e.value.split(",").length:0,a=N.componentList.find((e=>9===e.propertyType&&"legal_card"===e.propertyKey)),t=a?Array.isArray(a.value)?a.value.length:a.value.split(",").length:0;if(e&&l<2&&a&&t<2)return(0,i.df)({title:"您的法人身份证、经办人身份证只上传了一张图片，请上传身份证正反面后再提交",type:"warning"});if(e&&l<2)return(0,i.df)({title:"您的经办人身份证只上传了一张图片，请上传身份证正反面后再提交",type:"warning"});if(a&&t<2)return(0,i.df)({title:"您的法人身份证只上传了一张图片，请上传身份证正反面后再提交",type:"warning"});Q()}else console.log("error submit!",l)}))};async function Q(){const e=N.componentList.map((e=>{let l;if(1===e.propertyType)l="business_label"===e.propertyKey?JSON.stringify(e.value):e.value;else if(5===e.propertyType)l=e.value.join(",");else if(12===e.propertyType){let a=e.optionBOList.filter((l=>e.value.includes(l.id))).map((e=>({key:e.id,value:e.value2})));l=JSON.stringify(a)}else l="industry"===e.propertyKey?e.value[e.value.length-1]:14===e.propertyType?U.value.join(","):e.value;return{mainId:e.mainId,propertyKey:e.propertyKey,propertyType:e.propertyType,remark:e.remark,tagName:e.tagName,value:l}})),l={detailList:e,profileId:Number(K.profileId),profileName:K.realName,reportId:x.value.id,recordId:E.editId||""},{statusCode:a,msg:t}=await r.kW.getData(l);0===a&&((0,n.nk)({message:t||"已保存",type:"success"}),X("emitFunc",{type:"list"}),H())}async function S(){const e={reportId:x.value.id},{data:l}=await r.XM.getData(e),{list:a}=r.XM.handleData(l,x.value);N.componentList=a}function A(){return E.editComponents.forEach((e=>{e.propertyKey=e.componentBO.propertyKey,e.optionBOList=e.componentBO.optionBOList,e.templateBOList=e.componentBO.templateBOList,e.verifyBOList=e.componentBO.verifyBOList,e.isRequired=e.componentBO.isRequired,e.placeholder=e.componentBO.placeholder,e.maxLength=e.componentBO.maxLength})),E.editComponents.map((e=>{if([9,13].includes(e.componentBO.propertyType)){e.fileList=e.value,e.value=e.value.map((e=>e.fileId)).join(",");const l=e.verifyBOList.find((e=>"file"===e.type));e.fileLimit=(null===l||void 0===l?void 0:l.length)||1}else if(2===e.componentBO.propertyType&&e.componentBO.propertyKey){if(e.optionInputValue){let l=JSON.parse(e.optionInputValue);e.value=String(l.id)||""}}else if(12===e.componentBO.propertyType){const l=e.value&&JSON.parse(e.value);e.value=[],l.forEach((l=>{e.value.push(l.key)})),e.optionBOList.forEach((e=>{l.forEach((l=>{e.id===l.key&&(e.value2=l.value)}))}))}else 5===e.propertyType?e.value=e.value.split(",").map((e=>+e)):[4,11].includes(e.propertyType)&&(e.value=+e.value);return e}))}function M(){Promise.all([$(),J()]).then((()=>{"add"===E.type?S():"edit"===E.type&&(N.componentList=A())}))}const $=async()=>{const{data:e}=await r.Bu.getData();W.value=r.Bu.handleData(e)},J=async()=>{const e={pageSize:100,pageNo:1,companyCode:x.value.companyCode,companyId:O},{data:l}=await r.Kl.getData(e);w.value=l.records};function j(e){const l=[];return l.push({required:!0,message:1===e.propertyType&&"company_name"===e.propertyKey?"请从列表中选择":e.placeholder?e.placeholder:e.tagName+"不能为空",trigger:"change"}),l}function q(e,l,a,t){if(14===t.propertyType)U.value.length||l(new Error("话术关键词不能为空")),U.value.length<5&&l(new Error("话术关键词不能少于5个"));else{const o=t.value;o.length&&o.includes(t.optionBOList[a].id)&&!e&&l(new Error("请输入"))}l()}function z(e){const{ids:l,key:a}=e;N.componentList.forEach((e=>{e.propertyKey===a&&(e.value=l)}))}function P(e){const l=e.value,a=l.reduce(((e,l)=>{const a=l.labels.map((e=>(e.groupId=l.group.id,e)));return e.concat(a)}),[]),t=a.map((e=>`${e.id}&${e.groupId}`)),o=l.map((e=>e.group.id));B.value.trigger(!0,{labelValue:t,groupLabelValue:o})}function G(e){const l=N.componentList.find((e=>"business_label"===e.propertyKey));l.value=(null===e||void 0===e?void 0:e.value)??[],l.labelText=(null===e||void 0===e?void 0:e.labelText)??[]}function H(){N.componentList=[],E.visible=!1}function Y(e,l,a,t){E.visible=e,E.type=l,x.value=a,E.editComponents=null===t||void 0===t?void 0:t.recordContentList,E.editId=null===t||void 0===t?void 0:t.id,e&&M()}return l({trigger:Y}),(e,l)=>{const a=(0,t.g2)("el-button"),i=(0,t.g2)("el-input"),n=(0,t.g2)("el-form-item"),r=(0,t.g2)("el-option"),V=(0,t.g2)("el-select"),X=(0,t.g2)("el-input-number"),K=(0,t.g2)("el-radio"),O=(0,t.g2)("el-radio-group"),U=(0,t.g2)("el-checkbox"),x=(0,t.g2)("el-checkbox-group"),Q=(0,t.g2)("CustomUpload"),S=(0,t.g2)("el-cascader"),A=(0,t.g2)("el-form"),M=(0,t.g2)("el-empty"),$=(0,t.g2)("el-drawer");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)($,{modelValue:E.visible,"onUpdate:modelValue":l[1]||(l[1]=e=>E.visible=e),class:"custom-drawer",title:"补充资料",size:"700",onClose:H},{footer:(0,t.k6)((()=>[(0,t.bF)(a,{onClick:H},{default:(0,t.k6)((()=>l[5]||(l[5]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(a,{type:"primary",onClick:D},{default:(0,t.k6)((()=>l[6]||(l[6]=[(0,t.eW)("提交")]))),_:1})])),default:(0,t.k6)((()=>[l[7]||(l[7]=(0,t.Lk)("p",{class:"dashed-tip"}," 注意：为了您能更好的使用线路，请根据提示补充或重填以下资料。您补充的资料将覆盖您之前填写的资料。 ",-1)),N.componentList.length?((0,t.uX)(),(0,t.Wv)(A,{key:0,ref_key:"ruleFormRef",ref:I,model:N,"label-width":"100px","label-position":"top"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(N.componentList,((e,F)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id},[1===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:0,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",d,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>["business_label"===e.propertyKey?((0,t.uX)(),(0,t.CE)("div",s,[(0,t.bF)(a,{type:"primary",onClick:l=>P(e,F)},{default:(0,t.k6)((()=>l[2]||(l[2]=[(0,t.eW)("添加")]))),_:2},1032,["onClick"]),(0,t.Lk)("div",m,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.labelText,((e,l)=>((0,t.uX)(),(0,t.CE)("span",{key:l},(0,o.v_)(e),1)))),128))])])):((0,t.uX)(),(0,t.Wv)(i,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,modelModifiers:{trim:!0},placeholder:e.placeholder,disabled:e.inputDisabled},(0,t.eX)({_:2},[e.unit?{name:"append",fn:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.unit),1)])),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","disabled"]))])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),2===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:1,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",v,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>["verbal_trick"===e.propertyKey?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(V,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:e.placeholder},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(w.value,(e=>((0,t.uX)(),(0,t.Wv)(r,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),(0,t.bF)(a,{type:"primary",style:{"margin-left":"10px"},onClick:l[0]||(l[0]=e=>R("add",{}))},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("添加")]))),_:1})],64)):((0,t.uX)(),(0,t.Wv)(i,{key:1,type:"textarea",rows:3,maxlength:e.maxLength,"show-word-limit":"",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,modelModifiers:{trim:!0},placeholder:e.placeholder},null,8,["maxlength","modelValue","onUpdate:modelValue","placeholder"]))])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),7===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:2,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",c,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.Lk)("div",y,[(0,t.bF)(X,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,precision:2,min:.01,max:9999999999,label:"描述文字"},null,8,["modelValue","onUpdate:modelValue"]),(0,t.Lk)("span",null,(0,o.v_)(e.unit),1)])])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),4===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:3,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",f,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.bF)(O,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,((e,l)=>((0,t.uX)(),(0,t.Wv)(K,{value:e.id,key:l},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.value),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),11===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:4,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",k,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.bF)(V,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,filterable:"",placeholder:e.placeholder,style:{width:"100%"}},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,(e=>((0,t.uX)(),(0,t.Wv)(r,{key:e.id,label:e.value,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),5===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:5,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",b,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.bF)(x,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,((e,l)=>((0,t.uX)(),(0,t.Wv)(U,{value:e.id,key:l},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.value),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),12===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:6,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",L,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.bF)(x,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,((l,a)=>((0,t.uX)(),(0,t.CE)("div",{style:{display:"flex","margin-bottom":"20px"},key:a},[(0,t.bF)(U,{style:{width:"100px"},value:l.id},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(l.value),1)])),_:2},1032,["value"]),(0,t.bF)(n,{prop:"componentList."+F+".optionBOList."+a+".value2",rules:[{validator:(l,t,o)=>{q(t,o,a,e)}}]},{default:(0,t.k6)((()=>[(0,t.bF)(i,{disabled:!e.value.includes(l.id),modelValue:l.value2,"onUpdate:modelValue":e=>l.value2=e,placeholder:l.placeholder},null,8,["disabled","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["prop","rules"])])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"])])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),9===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:7,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",g,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.bF)(Q,{"show-word-limit":"10","list-type":"text",accept:"*",defaultFileList:e.fileList,"onUpdate:defaultFileList":l=>e.fileList=l,editData:e,maxVolume:20,limit:e.fileLimit,onEmitUpload:z},null,8,["defaultFileList","onUpdate:defaultFileList","editData","limit"]),e.templateBOList&&e.templateBOList.length?((0,t.uX)(),(0,t.Wv)(a,{key:0,onClick:l=>(0,p.R1)(u.t$)(e.templateBOList[0].fileUrl)},{default:(0,t.k6)((()=>l[4]||(l[4]=[(0,t.eW)("下载模板 ")]))),_:2},1032,["onClick"])):(0,t.Q3)("",!0)])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),13===e.propertyType?((0,t.uX)(),(0,t.Wv)(n,{key:8,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",_,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.bF)(Q,{"show-word-limit":"10","list-type":"picture-card",defaultFileList:e.fileList,"onUpdate:defaultFileList":l=>e.fileList=l,editData:e,maxVolume:20,limit:e.fileLimit,onEmitUpload:z},null,8,["defaultFileList","onUpdate:defaultFileList","editData","limit"])])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0),"industry"===e.propertyKey?((0,t.uX)(),(0,t.Wv)(n,{key:9,prop:"componentList."+F+".value",rules:j(e)},{label:(0,t.k6)((()=>[(0,t.Lk)("span",null,(0,o.v_)(e.tagName),1),(0,t.Lk)("span",h,"补充理由："+(0,o.v_)(e.remark),1)])),default:(0,t.k6)((()=>[(0,t.bF)(S,{style:{width:"100%"},modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,emitPath:!0,filterable:"",clearable:"",placeholder:"请选择",props:{value:"id",label:"name",children:"children",checkStrictly:!1},options:W.value,disabled:e.inputDisabled},null,8,["modelValue","onUpdate:modelValue","options","disabled"])])),_:2},1032,["prop","rules"])):(0,t.Q3)("",!0)])))),128))])),_:1},8,["model"])):((0,t.uX)(),(0,t.Wv)(M,{key:1,"image-size":100,description:"暂无数据"}))])),_:1},8,["modelValue"]),(0,t.bF)((0,p.R1)(C),{ref_key:"addEditSpeechLibraryRef",ref:T,onEmitFunc:J},null,512),(0,t.bF)((0,p.R1)(F),{ref_key:"businessLabelRef",ref:B,onEmitFunc:G},null,512)],64)}}}),F=a(83936);const C=(0,F.A)(V,[["__scopeId","data-v-2a831a70"]]);var X=C}}]);
//# sourceMappingURL=9663.54aa5b81.js.map