"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[537,4559],{66413:function(e,a,i){i.r(a),i.d(a,{default:function(){return y}});i(59784),i(29296),i(47961),i(83238),i(84e3);var l=i(6254),d=i(38627),u=i(25598),n=i(64108),s=i(83862),t=i(8610),r=i(4710),c=i(10901),o=i(88365);const v={class:"service-specs"},p={class:"purchased-list"},m={class:"grids clearfix"},f={class:"toper"},g={class:"tit"},b={class:"format"},L={class:"word"};var h=(0,l.pM)({__name:"channel-package",props:{productData:{},purchasedData:{}},setup(e){const{routeQuery:a}=(0,c.dG)(),{serviceCode:i,companyId:h,profileId:C}=a.value,{bd_userInfo:k}=o.DT.batchGetItem(["bd_userInfo"]),y=e,_=(0,u.Kh)({specList:[],gridList:[],activeSpecCodes:[]}),I=(0,u.IJ)({price:"0.00",sumPrice:"0.00",unitPrice:"0.00",addedPrice:"0.00",subMarketList:[],hasAgentPrice:!1});console.log(y.productData);const N=(0,l.EW)((()=>y.productData)),E=(0,l.EW)((()=>N.value.serviceInfo)),D=(0,l.EW)((()=>{var e;return null===(e=N.value)||void 0===e?void 0:e.addedServiceList})),P=()=>{_.gridList=_.gridList.map((e=>{const a=e.code,i=_.activeSpecCodes.includes(a);if(i){var l,d,u,n,s,t,r;const i=D.value.find((e=>e.addedServiceCode===a)),c=i.specsList||[],o=i.addedServiceName,v=(null===(l=c[0])||void 0===l?void 0:l.coding)||"",p=(null===(d=c[0])||void 0===d?void 0:d.groupCodes)||"",m=e.value||(null===(u=c[0])||void 0===u?void 0:u.minNum)||1,f=(null===(n=c[0])||void 0===n?void 0:n.unitPrice)||0,g=(null===(s=c[0])||void 0===s?void 0:s.minNum)||1,b=(null===(t=c[0])||void 0===t?void 0:t.maxNum)||1,L=i.mininum||1,h=(null===(r=c[0])||void 0===r?void 0:r.hidden)||0,C=F.value.findIndex((e=>e.consumptionTypeCd===p)),k=-1===C?new Date:F.value[C].endTime,y=dayjs().format("YYYY-MM-DD"),_=dayjs(k).format("YYYY-MM-DD");return{label:o,code:a,coding:v,groupCodes:p,value:m,price:f,minNum:g,maxNum:b,incrementNum:L,hidden:h,isUpgrade:-1!==C,dateNum:new BigNumber(dayjs(_).diff(y,"days")).toNumber()}}return{code:a,hidden:1}}))},S=(0,l.EW)((()=>_.gridList.filter((e=>1!==e.hidden)).reduce(((e,a)=>e+`${a.label}：${a.value}${E.value.unit}；`),""))),$=(0,l.EW)((()=>{const e=_.gridList.filter((e=>1!==e.hidden)).map((e=>{const a=e.isUpgrade;return a?`${e.label}：剩余天数${e.dateNum}/一年365天x${e.price}元/个x${e.value}个`:`${e.label}：${e.price}元/个x${e.value}个`})).join(" + ");return`合计：${e} = ${I.value.price}元`})),F=(0,l.EW)((()=>y.purchasedData)),x=()=>{var e;_.specList=(null===(e=D.value)||void 0===e?void 0:e.map((e=>({label:e.addedServiceName,value:e.addedServiceCode}))))||[]},V=()=>{var e,a;_.activeSpecCodes=null!==(e=_.specList[0])&&void 0!==e&&e.value?[null===(a=_.specList[0])||void 0===a?void 0:a.value]:[]},w=()=>{_.gridList=_.specList.map((e=>({code:e.value,hidden:1})))};function Y(){const e=_.gridList.filter((e=>1!==e.hidden)).map((e=>({code:e.code,num:e.value,coding:e.coding}))),a=_.gridList.filter((e=>1!==e.hidden)).map((e=>({baseCode:e.groupCodes,number:e.value}))),l={helpOrder:1,agentId:k.profileId,companyId:h,profileId:C,buyType:"BUY_SERVER",shopBuyList:[{agentId:k.profileId,isisTry:!1,dateType:3,dateValue:1,marketCode:i,coding:e,baseCodeList:a}],sumPrice:I.value.sumPrice},d={list:[{...E.value,price:I.value.price,specsInfo:S.value,augmentedServiceList:[]}],sumPrice:I.value.sumPrice};return{params:l,commodityInfo:d}}async function A(){const e=Y().params;I.value=await(0,r.AV)(e)}function T(){(0,r.$d)(Y())}return(0,l.wB)((()=>_.activeSpecCodes),(()=>{P(),A()})),(0,l.sV)((async()=>{x(),w(),V()})),(e,a)=>{var i;const u=(0,l.g2)("el-form-item"),r=(0,l.g2)("el-input-number"),c=(0,l.g2)("el-form");return(0,l.uX)(),(0,l.CE)("div",null,[(0,l.bF)(n.A,{serviceData:E.value},null,8,["serviceData"]),(0,l.Lk)("div",v,[(0,l.bF)(c,{"label-width":"150px"},{default:(0,l.k6)((()=>[F.value.length?((0,l.uX)(),(0,l.Wv)(u,{key:0,label:"已购详情"},{default:(0,l.k6)((()=>[(0,l.Lk)("ul",p,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(F.value,((e,a)=>((0,l.uX)(),(0,l.CE)("li",{key:a},[(0,l.Lk)("span",null,(0,d.v_)(e.resourceName),1),(0,l.Lk)("span",null,"已购买数量："+(0,d.v_)(e.resourceCount)+(0,d.v_)(E.value.unit),1),(0,l.Lk)("span",null,"服务到期时间："+(0,d.v_)(e.endTime),1)])))),128))])])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(u,{label:"受邀规模"},{default:(0,l.k6)((()=>[(0,l.bF)(s["default"],{direction:"row",list:_.specList,modelValue:_.activeSpecCodes,"onUpdate:modelValue":a[0]||(a[0]=e=>_.activeSpecCodes=e)},null,8,["list","modelValue"])])),_:1}),(0,l.bF)(u,{label:"资源数量"},{default:(0,l.k6)((()=>[(0,l.Lk)("ul",m,[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(_.gridList,((e,a)=>((0,l.uX)(),(0,l.CE)(l.FK,null,[1!==e.hidden?((0,l.uX)(),(0,l.CE)("li",{key:a,class:"grid"},[(0,l.Lk)("div",f,[(0,l.Lk)("p",g,(0,d.v_)(e.label),1),(0,l.Lk)("p",b,(0,d.v_)(e.price)+"元 * "+(0,d.v_)(e.value)+"个",1)]),(0,l.bF)(r,{class:"step-input",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,min:e.minNum,max:e.maxNum,step:e.incrementNum,"step-strictly":"","value-on-clear":e.minNum,onChange:A},null,8,["modelValue","onUpdate:modelValue","min","max","step","value-on-clear"])])):(0,l.Q3)("",!0)],64)))),256))])])),_:1}),(0,l.bF)(u,null,{default:(0,l.k6)((()=>[(0,l.Lk)("p",L,(0,d.v_)($.value),1)])),_:1})])),_:1}),(0,l.bF)(t.A,{onEmitFunc:T,"buy-price":I.value.sumPrice,"can-buy":null===(i=N.value)||void 0===i?void 0:i.canBuy,hasAgentPrice:I.value.hasAgentPrice},null,8,["buy-price","can-buy","hasAgentPrice"])])])}}}),C=i(83936);const k=(0,C.A)(h,[["__scopeId","data-v-578de4c1"]]);var y=k}}]);
//# sourceMappingURL=537.fc9623ed.js.map