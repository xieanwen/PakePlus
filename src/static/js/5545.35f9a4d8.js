"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[5545],{20179:function(e,u,a){a.r(u),a.d(u,{default:function(){return g}});a(95226),a(59784),a(47961),a(83238);var t=a(6254),l=a(38627),s=a(25598),n=a(10901),i=a(88365),m=a(4710),o=a(8610),r=a(64108);const c={class:"product-detail"},d={class:"service-specs"},v={class:"purchased-info"},p={class:"word"},f="CALL_SOFT_SEAT";var N=(0,t.pM)({__name:"cloud-call-soft-seat",props:{productData:{},purchasedData:{}},setup(e){const u=e,{routeQuery:a}=(0,n.dG)(),{bd_userInfo:N}=i.DT.batchGetItem(["bd_userInfo"]),b=(0,t.EW)((()=>u.purchasedData));console.log(b);const g=(0,t.EW)((()=>u.productData)),C=(0,t.EW)((()=>g.value.serviceInfo)),y=(0,t.EW)((()=>{var e;return null===(e=g.value)||void 0===e?void 0:e.addedServiceList.find((e=>e.addedServiceCode===f))})),I=(0,t.EW)((()=>{let e=0;if(b.value.endTime){const u=b.value.endTime,a=new Date(b.value.endTime).getDate(),t=dayjs().format("YYYY-MM-DD"),l=(new Date).getDate(),s=a===l?0:1;e=new BigNumber(dayjs(u).diff(t,"months")).plus(s).toNumber()}return e})),L=(0,t.EW)((()=>"custom"===k.seatNum?k.seatCustomNum:k.seatNum)),S=(0,t.EW)((()=>{var e;return null!==(e=g.value)&&void 0!==e&&e.canBuy?`合计： 坐席单价${h.value.unitPrice}元 x\n${L.value}个坐席 x 剩余${I.value}个月 = ${h.value.sumPrice}元`:""})),k=(0,s.Gc)({seatNum:"",seatCustomNum:0,minSeatNum:1,maxSeatNum:1e7,seatList:[],curSpecsInfo:{}}),h=(0,s.IJ)({price:"0.00",sumPrice:"0.00",addedPrice:"0.00",unitPrice:"0.00",subMarketList:[]});function x(){var e;const u=y.value.specsList??[];k.seatNum=Number(u[0].groupValues),k.seatCustomNum=u[0].minNum,k.minSeatNum=u[0].minNum,k.maxSeatNum=u[0].maxNum,k.seatList=u.map((e=>(k.minSeatNum>e.minNum&&(k.minSeatNum=e.minNum),k.maxSeatNum<e.maxNum&&(k.maxSeatNum=e.maxNum),{label:`${e.groupValues}个`,value:Number(e.groupValues),minNum:e.minNum,maxNum:e.maxNum,coding:e.coding,serviceCode:e.serviceCode,groupCodeList:e.groupCodes.split(","),groupValueList:e.groupValues.split(",")}))),null!==(e=y.value)&&void 0!==e&&e.isDiy&&k.seatList.push({label:"自定义",value:"custom"}),k.curSpecsInfo=k.seatList[0],D()}function V(e){let u=e;"custom"===e&&(u=k.seatCustomNum),k.curSpecsInfo=k.seatList.find((e=>e.minNum<=u&&u<=e.maxNum)),D()}function _(){var e;const u={helpOrder:1,agentId:N.profileId,companyId:a.value.companyId,profileId:a.value.profileId,buyType:"BUY_SERVER",shopBuyList:[{agentId:N.profileId,isisTry:!1,dateType:"2",dateValue:b.value.dateValue,marketCode:a.value.serviceCode,userNumber:L.value,coding:[{code:k.curSpecsInfo.serviceCode,coding:k.curSpecsInfo.coding,num:L.value}],baseCodeList:k.curSpecsInfo.groupCodeList.map(((e,u)=>({baseCode:e,number:k.curSpecsInfo.groupValueList[u]})))}],sumPrice:h.value.sumPrice},t={list:[{...C.value,price:h.value.price,specsInfo:`坐席数量：${L.value}个；合作时间：${I.value}个月；坐席单价：${h.value.unitPrice}元；`,augmentedServiceList:null===(e=h.value)||void 0===e?void 0:e.subMarketList.map((e=>("1"===e.calculateType&&(e.specsInfo=`${I.value}个月`),e)))}],sumPrice:h.value.sumPrice};return{params:u,commodityInfo:t}}async function D(){const e=_().params;h.value=await(0,m.AV)(e)}function P(){(0,m.$d)(_())}return x(),(e,u)=>{var a;const n=(0,t.g2)("el-form-item"),i=(0,t.g2)("el-option"),m=(0,t.g2)("el-select"),f=(0,t.g2)("el-input-number"),N=(0,t.g2)("el-form");return(0,t.uX)(),(0,t.CE)("div",c,[(0,t.bF)(r.A,{serviceData:C.value},null,8,["serviceData"]),(0,t.Lk)("div",d,[(0,t.bF)(N,{"label-width":"150px"},{default:(0,t.k6)((()=>{var e;return[null!==(e=g.value)&&void 0!==e&&e.canBuy?((0,t.uX)(),(0,t.Wv)(n,{key:0,label:"已购详情"},{default:(0,t.k6)((()=>[(0,t.Lk)("div",v,[(0,t.Lk)("span",null," 已购坐席数："+(0,l.v_)(b.value.resourceCount)+(0,l.v_)(C.value.unit),1),(0,t.Lk)("span",null,"服务到期时间："+(0,l.v_)(b.value.endTime),1)])])),_:1})):(0,t.Q3)("",!0),(0,t.bF)(n,{label:"购买坐席数",class:"amount-form-item"},{default:(0,t.k6)((()=>[(0,t.bF)(m,{modelValue:(0,s.R1)(k).seatNum,"onUpdate:modelValue":u[0]||(u[0]=e=>(0,s.R1)(k).seatNum=e),onChange:V},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)((0,s.R1)(k).seatList,(e=>((0,t.uX)(),(0,t.Wv)(i,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),"custom"===(0,s.R1)(k).seatNum?((0,t.uX)(),(0,t.Wv)(f,{key:0,modelValue:(0,s.R1)(k).seatCustomNum,"onUpdate:modelValue":u[1]||(u[1]=e=>(0,s.R1)(k).seatCustomNum=e),min:(0,s.R1)(k).minSeatNum,max:(0,s.R1)(k).maxSeatNum,step:y.value.miniNum,onChange:V},null,8,["modelValue","min","max","step"])):(0,t.Q3)("",!0)])),_:1}),(0,t.bF)(n,null,{default:(0,t.k6)((()=>[(0,t.Lk)("p",p,(0,l.v_)(S.value),1)])),_:1})]})),_:1}),(0,t.bF)(o.A,{onEmitFunc:P,"buy-price":h.value.sumPrice,"can-buy":null===(a=g.value)||void 0===a?void 0:a.canBuy,hasAgentPrice:h.value.hasAgentPrice,tip:"购买此产品前，需要先买鱼鹰呼叫软件"},null,8,["buy-price","can-buy","hasAgentPrice"])])])}}});const b=N;var g=b}}]);
//# sourceMappingURL=5545.35f9a4d8.js.map