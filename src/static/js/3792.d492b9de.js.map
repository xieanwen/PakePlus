{"version":3,"file":"static/js/3792.d492b9de.js","mappings":"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","sources":["webpack://daili/./src/views/payment/vip-buy.vue?652e","webpack://daili/./src/views/payment/vip-buy.vue","webpack://daili/./src/views/payment/vip-buy.vue?cc7d"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createElementVNode as _createElementVNode, unref as _unref, vModelText as _vModelText, withDirectives as _withDirectives, resolveComponent as _resolveComponent, createVNode as _createVNode, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, normalizeClass as _normalizeClass, createTextVNode as _createTextVNode, withCtx as _withCtx, vShow as _vShow, toDisplayString as _toDisplayString } from \"vue\"\n\nconst _hoisted_1 = { class: \"main-container\" }\nconst _hoisted_2 = { class: \"recharge-amount\" }\nconst _hoisted_3 = { class: \"amount-container\" }\nconst _hoisted_4 = { class: \"amount\" }\nconst _hoisted_5 = { class: \"payment-container\" }\nconst _hoisted_6 = { class: \"payment-type\" }\nconst _hoisted_7 = { class: \"online-pay\" }\nconst _hoisted_8 = { class: \"payment-list online-list\" }\nconst _hoisted_9 = [\"onClick\"]\nconst _hoisted_10 = {\n  class: \"icon\",\n  \"aria-hidden\": \"true\"\n}\nconst _hoisted_11 = [\"xlink:href\"]\nconst _hoisted_12 = { class: \"balance-pay\" }\nconst _hoisted_13 = { class: \"payment-list balance-list\" }\nconst _hoisted_14 = [\"onClick\"]\nconst _hoisted_15 = {\n  class: \"icon\",\n  \"aria-hidden\": \"true\"\n}\nconst _hoisted_16 = [\"xlink:href\"]\nconst _hoisted_17 = { class: \"amount\" }\n\nimport {\r\n  computed,\r\n  onMounted,\r\n  shallowReactive,\r\n  defineAsyncComponent,\r\n} from \"vue\";\r\n\r\nimport { SessionStorage } from \"jz-tool-lib\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\n\r\nimport { toPayApi, updatePayTypeApi } from \"@api/payment-api\";\r\nimport { queryAccountApi } from \"@api/financial-statistics-api\";\r\n\r\n\r\nconst __default__ = {\r\n  name: \"payment-buy\",\r\n};\r\n\nexport default /*@__PURE__*/_defineComponent({\n  ...__default__,\n  props: {\n    orderId: {}\n  },\n  setup(__props: any) {\n\r\nconst VipBuyQRCodeDialog = defineAsyncComponent(\r\n  () => import(\"@components/payment/vip-buy-QRCode-dialog.vue\")\r\n);\r\n\r\nconst props = __props;\r\nconst { goPage } = useVueRouter();\r\nconst { \"bd_market-payment\": marketPayment } = SessionStorage.batchGetItem([\r\n  \"bd_market-payment\",\r\n]);\r\nconst paramsData = shallowReactive({\r\n  onlinePayment: \"WX\", // 线上支付-当前选择 默认选择微信支付\r\n  balancePayment: \"DLSZHYE\", // 账户余额支付-当前选择\r\n  activeIndex: 0,\r\n  paymentVisible: false,\r\n  paymentLink: \"\",\r\n  paymentMoney: \"\",\r\n  accountInfo: {},\r\n});\r\nconst paymentList = [\r\n  {\r\n    label: \"在线支付\",\r\n    value: 0,\r\n  },\r\n  {\r\n    label: \"余额支付\",\r\n    value: 1,\r\n  },\r\n];\r\nconst onlineTypeList = [\r\n  {\r\n    onlineType: \"WX\",\r\n    svgName: \"#icon-WeChat\",\r\n  },\r\n  {\r\n    onlineType: \"ZFB\",\r\n    svgName: \"#icon-alipay\",\r\n  },\r\n];\r\nconst balanceTypeList = [\r\n  {\r\n    balanceType: \"DLSZHYE\",\r\n    svgName: \"#icon-qiYeBao\",\r\n    word: \"可用余额：\",\r\n  },\r\n  // {\r\n  //   balanceType: \"DLSYHK\",\r\n  //   svgName: \"#icon-balance\",\r\n  //   word: \"代理商预付款：\",\r\n  // },\r\n];\r\nconst payType = computed(() => {\r\n  return paramsData.activeIndex === 0\r\n    ? paramsData.onlinePayment\r\n    : paramsData.balancePayment;\r\n});\r\n// 查询账户余额\r\nconst getAccountBalance = async () => {\r\n  const { data = {} } = await queryAccountApi.getData();\r\n  paramsData.accountInfo = data;\r\n};\r\ngetAccountBalance();\r\n// 选择线上，余额支付\r\nconst tabClick = (item) => {\r\n  paramsData.activeIndex = item.value;\r\n};\r\n// 选择支付方式\r\nconst paymentClick = async (type: string, value: string) => {\r\n  await updatePayTypeApi.getData({\r\n    payType: value,\r\n    orderId: props.orderId,\r\n  });\r\n  paramsData[type] = value;\r\n};\r\nconst submitPayment = async () => {\r\n  const params = {\r\n    orderNo: props.orderId,\r\n    payType: payType.value,\r\n    total: marketPayment.sumPrice,\r\n    profileId: marketPayment.profileId,\r\n    companyId: marketPayment.companyId,\r\n  };\r\n  const { data } = await toPayApi.getData(params);\r\n  if (params.total === 0) {\r\n    await goPage(\"/orderManagement/customerOrder/list\");\r\n  } else {\r\n    handleAfterPay(data);\r\n  }\r\n};\r\nconst handleAfterPay = (data) => {\r\n  if (payType.value === \"WX\") {\r\n    paramsData.paymentLink = data;\r\n    paramsData.paymentVisible = true;\r\n  } else {\r\n    if (payType.value === \"ZFB\") {\r\n      window.open(\r\n        `${location.origin}/#/pay-form?payForm=${encodeURIComponent(data)}`\r\n      );\r\n    }\r\n    goPage(\"/orderManagement/customerOrder/list\").then(() => {\r\n      SessionStorage.batchRemoveItem([\r\n        \"bd_market-cart\",\r\n        \"bd_market-payment\",\r\n        \"bd_market-commodity\",\r\n      ]);\r\n    });\r\n  }\r\n};\r\nonMounted(() => {\r\n  paramsData.paymentMoney = marketPayment.sumPrice;\r\n  if (marketPayment.modePayment) {\r\n    if (marketPayment.modePayment === \"onlinePayment\") {\r\n      paramsData.activeIndex = 0;\r\n      paramsData.onlinePayment = marketPayment.paymentType;\r\n    } else if (marketPayment.modePayment === \"balancePayment\") {\r\n      paramsData.activeIndex = 1;\r\n      paramsData.balancePayment = marketPayment.paymentType;\r\n    }\r\n  }\r\n});\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_tab_list = _resolveComponent(\"tab-list\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n\n  return (_openBlock(), _createElementBlock(_Fragment, null, [\n    _createElementVNode(\"div\", _hoisted_1, [\n      _createElementVNode(\"div\", _hoisted_2, [\n        _createElementVNode(\"div\", _hoisted_3, [\n          _createElementVNode(\"div\", _hoisted_4, [\n            _cache[2] || (_cache[2] = _createElementVNode(\"span\", { class: \"money-logo\" }, \"¥\", -1)),\n            _cache[3] || (_cache[3] = _createElementVNode(\"span\", { class: \"label\" }, \"当前支付金额为：\", -1)),\n            _withDirectives(_createElementVNode(\"input\", {\n              \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(paramsData).paymentMoney) = $event)),\n              placeholder: \"请输入金额\",\n              disabled: \"\"\n            }, null, 512), [\n              [\n                _vModelText,\n                _unref(paramsData).paymentMoney,\n                void 0,\n                { number: true }\n              ]\n            ])\n          ]),\n          _cache[4] || (_cache[4] = _createElementVNode(\"p\", { class: \"prompt\" }, \"请选择支付方式付款，完成支付\", -1))\n        ]),\n        _createElementVNode(\"div\", _hoisted_5, [\n          _cache[7] || (_cache[7] = _createElementVNode(\"h6\", { class: \"title\" }, \"选择支付方式\", -1)),\n          _createElementVNode(\"div\", _hoisted_6, [\n            _createVNode(_component_tab_list, {\n              onEmitTab: tabClick,\n              list: paymentList,\n              activeIndex: _unref(paramsData).activeIndex\n            }, null, 8, [\"activeIndex\"]),\n            _withDirectives(_createElementVNode(\"div\", _hoisted_7, [\n              _createElementVNode(\"ul\", _hoisted_8, [\n                (_openBlock(), _createElementBlock(_Fragment, null, _renderList(onlineTypeList, (item, index) => {\n                  return _createElementVNode(\"li\", {\n                    key: index,\n                    class: _normalizeClass(\r\n                  _unref(paramsData).onlinePayment === item.onlineType ? 'active' : ''\r\n                ),\n                    onClick: ($event: any) => (paymentClick('onlinePayment', item.onlineType))\n                  }, [\n                    (_openBlock(), _createElementBlock(\"svg\", _hoisted_10, [\n                      _createElementVNode(\"use\", {\n                        \"xlink:href\": item.svgName\n                      }, null, 8, _hoisted_11)\n                    ]))\n                  ], 10, _hoisted_9)\n                }), 64))\n              ]),\n              _createVNode(_component_el_button, {\n                type: \"primary\",\n                onClick: submitPayment\n              }, {\n                default: _withCtx(() => _cache[5] || (_cache[5] = [\n                  _createTextVNode(\"去支付\")\n                ])),\n                _: 1\n              })\n            ], 512), [\n              [_vShow, _unref(paramsData).activeIndex === 0]\n            ]),\n            _withDirectives(_createElementVNode(\"div\", _hoisted_12, [\n              _createElementVNode(\"ul\", _hoisted_13, [\n                (_openBlock(), _createElementBlock(_Fragment, null, _renderList(balanceTypeList, (item, index) => {\n                  return _createElementVNode(\"li\", {\n                    key: index,\n                    class: _normalizeClass(\r\n                  _unref(paramsData).balancePayment === item.balanceType ? 'active' : ''\r\n                ),\n                    onClick: ($event: any) => (paymentClick('balancePayment', item.balanceType))\n                  }, [\n                    (_openBlock(), _createElementBlock(\"svg\", _hoisted_15, [\n                      _createElementVNode(\"use\", {\n                        \"xlink:href\": item.svgName\n                      }, null, 8, _hoisted_16)\n                    ])),\n                    _createElementVNode(\"p\", _hoisted_17, _toDisplayString(item.word) + \" \" + _toDisplayString(_unref(paramsData).accountInfo[\r\n                      index === 0 ? \"accountBalance\" : \"prepaidCall\"\r\n                    ]), 1)\n                  ], 10, _hoisted_14)\n                }), 64))\n              ]),\n              _createVNode(_component_el_button, {\n                type: \"primary\",\n                onClick: submitPayment\n              }, {\n                default: _withCtx(() => _cache[6] || (_cache[6] = [\n                  _createTextVNode(\"去支付\")\n                ])),\n                _: 1\n              })\n            ], 512), [\n              [_vShow, _unref(paramsData).activeIndex === 1]\n            ])\n          ])\n        ])\n      ])\n    ]),\n    _createVNode(_unref(VipBuyQRCodeDialog), {\n      visible: _unref(paramsData).paymentVisible,\n      \"onUpdate:visible\": _cache[1] || (_cache[1] = ($event: any) => ((_unref(paramsData).paymentVisible) = $event)),\n      paymentMoney: _unref(paramsData).paymentMoney,\n      paymentLink: _unref(paramsData).paymentLink,\n      paymentType: payType.value\n    }, null, 8, [\"visible\", \"paymentMoney\", \"paymentLink\", \"paymentType\"])\n  ], 64))\n}\n}\n\n})","<template>\r\n  <div class=\"main-container\">\r\n    <div class=\"recharge-amount\">\r\n      <div class=\"amount-container\">\r\n        <div class=\"amount\">\r\n          <span class=\"money-logo\">&yen;</span>\r\n          <span class=\"label\">当前支付金额为：</span>\r\n          <input\r\n            v-model.number=\"paramsData.paymentMoney\"\r\n            placeholder=\"请输入金额\"\r\n            disabled\r\n          />\r\n        </div>\r\n        <p class=\"prompt\">请选择支付方式付款，完成支付</p>\r\n      </div>\r\n      <div class=\"payment-container\">\r\n        <h6 class=\"title\">选择支付方式</h6>\r\n        <div class=\"payment-type\">\r\n          <tab-list\r\n            @emitTab=\"tabClick\"\r\n            :list=\"paymentList\"\r\n            :activeIndex=\"paramsData.activeIndex\"\r\n          ></tab-list>\r\n          <div class=\"online-pay\" v-show=\"paramsData.activeIndex === 0\">\r\n            <ul class=\"payment-list online-list\">\r\n              <li\r\n                v-for=\"(item, index) in onlineTypeList\"\r\n                :key=\"index\"\r\n                :class=\"\r\n                  paramsData.onlinePayment === item.onlineType ? 'active' : ''\r\n                \"\r\n                @click=\"paymentClick('onlinePayment', item.onlineType)\"\r\n              >\r\n                <svg class=\"icon\" aria-hidden=\"true\">\r\n                  <use :xlink:href=\"item.svgName\"></use>\r\n                </svg>\r\n              </li>\r\n            </ul>\r\n            <el-button type=\"primary\" @click=\"submitPayment\">去支付</el-button>\r\n          </div>\r\n          <div class=\"balance-pay\" v-show=\"paramsData.activeIndex === 1\">\r\n            <ul class=\"payment-list balance-list\">\r\n              <li\r\n                v-for=\"(item, index) in balanceTypeList\"\r\n                :key=\"index\"\r\n                :class=\"\r\n                  paramsData.balancePayment === item.balanceType ? 'active' : ''\r\n                \"\r\n                @click=\"paymentClick('balancePayment', item.balanceType)\"\r\n              >\r\n                <svg class=\"icon\" aria-hidden=\"true\">\r\n                  <use :xlink:href=\"item.svgName\"></use>\r\n                </svg>\r\n                <p class=\"amount\">\r\n                  {{ item.word }}\r\n                  {{\r\n                    paramsData.accountInfo[\r\n                      index === 0 ? \"accountBalance\" : \"prepaidCall\"\r\n                    ]\r\n                  }}\r\n                </p>\r\n              </li>\r\n            </ul>\r\n            <el-button type=\"primary\" @click=\"submitPayment\">去支付</el-button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n  <!--  支付二维码 -->\r\n  <VipBuyQRCodeDialog\r\n    v-model:visible=\"paramsData.paymentVisible\"\r\n    :paymentMoney=\"paramsData.paymentMoney\"\r\n    :paymentLink=\"paramsData.paymentLink\"\r\n    :paymentType=\"payType\"\r\n  ></VipBuyQRCodeDialog>\r\n</template>\r\n<script lang=\"ts\">\r\nexport default {\r\n  name: \"payment-buy\",\r\n};\r\n</script>\r\n<script lang=\"ts\" setup>\r\nimport {\r\n  computed,\r\n  onMounted,\r\n  shallowReactive,\r\n  defineAsyncComponent,\r\n} from \"vue\";\r\n\r\nimport { SessionStorage } from \"jz-tool-lib\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\n\r\nimport { toPayApi, updatePayTypeApi } from \"@api/payment-api\";\r\nimport { queryAccountApi } from \"@api/financial-statistics-api\";\r\n\r\nconst VipBuyQRCodeDialog = defineAsyncComponent(\r\n  () => import(\"@components/payment/vip-buy-QRCode-dialog.vue\")\r\n);\r\n\r\nconst props = defineProps<{\r\n  orderId: string;\r\n}>();\r\nconst { goPage } = useVueRouter();\r\nconst { \"bd_market-payment\": marketPayment } = SessionStorage.batchGetItem([\r\n  \"bd_market-payment\",\r\n]);\r\nconst paramsData = shallowReactive({\r\n  onlinePayment: \"WX\", // 线上支付-当前选择 默认选择微信支付\r\n  balancePayment: \"DLSZHYE\", // 账户余额支付-当前选择\r\n  activeIndex: 0,\r\n  paymentVisible: false,\r\n  paymentLink: \"\",\r\n  paymentMoney: \"\",\r\n  accountInfo: {},\r\n});\r\nconst paymentList = [\r\n  {\r\n    label: \"在线支付\",\r\n    value: 0,\r\n  },\r\n  {\r\n    label: \"余额支付\",\r\n    value: 1,\r\n  },\r\n];\r\nconst onlineTypeList = [\r\n  {\r\n    onlineType: \"WX\",\r\n    svgName: \"#icon-WeChat\",\r\n  },\r\n  {\r\n    onlineType: \"ZFB\",\r\n    svgName: \"#icon-alipay\",\r\n  },\r\n];\r\nconst balanceTypeList = [\r\n  {\r\n    balanceType: \"DLSZHYE\",\r\n    svgName: \"#icon-qiYeBao\",\r\n    word: \"可用余额：\",\r\n  },\r\n  // {\r\n  //   balanceType: \"DLSYHK\",\r\n  //   svgName: \"#icon-balance\",\r\n  //   word: \"代理商预付款：\",\r\n  // },\r\n];\r\nconst payType = computed(() => {\r\n  return paramsData.activeIndex === 0\r\n    ? paramsData.onlinePayment\r\n    : paramsData.balancePayment;\r\n});\r\n// 查询账户余额\r\nconst getAccountBalance = async () => {\r\n  const { data = {} } = await queryAccountApi.getData();\r\n  paramsData.accountInfo = data;\r\n};\r\ngetAccountBalance();\r\n// 选择线上，余额支付\r\nconst tabClick = (item) => {\r\n  paramsData.activeIndex = item.value;\r\n};\r\n// 选择支付方式\r\nconst paymentClick = async (type: string, value: string) => {\r\n  await updatePayTypeApi.getData({\r\n    payType: value,\r\n    orderId: props.orderId,\r\n  });\r\n  paramsData[type] = value;\r\n};\r\nconst submitPayment = async () => {\r\n  const params = {\r\n    orderNo: props.orderId,\r\n    payType: payType.value,\r\n    total: marketPayment.sumPrice,\r\n    profileId: marketPayment.profileId,\r\n    companyId: marketPayment.companyId,\r\n  };\r\n  const { data } = await toPayApi.getData(params);\r\n  if (params.total === 0) {\r\n    await goPage(\"/orderManagement/customerOrder/list\");\r\n  } else {\r\n    handleAfterPay(data);\r\n  }\r\n};\r\nconst handleAfterPay = (data) => {\r\n  if (payType.value === \"WX\") {\r\n    paramsData.paymentLink = data;\r\n    paramsData.paymentVisible = true;\r\n  } else {\r\n    if (payType.value === \"ZFB\") {\r\n      window.open(\r\n        `${location.origin}/#/pay-form?payForm=${encodeURIComponent(data)}`\r\n      );\r\n    }\r\n    goPage(\"/orderManagement/customerOrder/list\").then(() => {\r\n      SessionStorage.batchRemoveItem([\r\n        \"bd_market-cart\",\r\n        \"bd_market-payment\",\r\n        \"bd_market-commodity\",\r\n      ]);\r\n    });\r\n  }\r\n};\r\nonMounted(() => {\r\n  paramsData.paymentMoney = marketPayment.sumPrice;\r\n  if (marketPayment.modePayment) {\r\n    if (marketPayment.modePayment === \"onlinePayment\") {\r\n      paramsData.activeIndex = 0;\r\n      paramsData.onlinePayment = marketPayment.paymentType;\r\n    } else if (marketPayment.modePayment === \"balancePayment\") {\r\n      paramsData.activeIndex = 1;\r\n      paramsData.balancePayment = marketPayment.paymentType;\r\n    }\r\n  }\r\n});\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n.recharge-amount {\r\n  width: 1200px;\r\n  margin: 0 auto;\r\n}\r\n\r\n.amount-container {\r\n  height: 190px;\r\n  display: flex;\r\n  flex-direction: column;\r\n  justify-content: center;\r\n  padding: 0 60px;\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n\r\n  .amount {\r\n    position: relative;\r\n    display: flex;\r\n    align-items: center;\r\n\r\n    .money-logo {\r\n      position: absolute;\r\n      top: 5px;\r\n      left: 215px;\r\n      font-size: 28px;\r\n      font-weight: 600;\r\n      color: #f12525;\r\n      line-height: 1;\r\n    }\r\n\r\n    .label {\r\n      color: #242934;\r\n      font-size: 26px;\r\n      line-height: 36px;\r\n    }\r\n\r\n    input {\r\n      width: 200px;\r\n      height: 36px;\r\n      color: #f12525;\r\n      font-size: 27px;\r\n      font-weight: 600;\r\n      padding: 10px 10px 2px 30px;\r\n      line-height: 1;\r\n      border-bottom: 1px solid #e1e4e8;\r\n\r\n      &::placeholder {\r\n        font-size: 18px;\r\n        color: #9ca6b9;\r\n        line-height: 1;\r\n        font-weight: normal;\r\n      }\r\n    }\r\n  }\r\n\r\n  .prompt {\r\n    font-size: 14px;\r\n    color: #9ca6b9;\r\n    margin-top: 8px;\r\n  }\r\n}\r\n\r\n.payment-container {\r\n  padding: 0 60px 80px;\r\n  margin-top: 20px;\r\n  background: #ffffff;\r\n  border-radius: 8px;\r\n\r\n  .title {\r\n    display: flex;\r\n    align-items: center;\r\n    height: 88px;\r\n    font-size: 20px;\r\n    color: #242934;\r\n    line-height: 20px;\r\n    border-bottom: 1px solid #edf1f6;\r\n  }\r\n\r\n  .payment-type {\r\n    margin-top: 28px;\r\n\r\n    .payment-list {\r\n      display: flex;\r\n      margin: 20px 0 40px;\r\n\r\n      li {\r\n        position: relative;\r\n        display: flex;\r\n        align-items: center;\r\n        justify-content: center;\r\n        width: 228px;\r\n        height: 96px;\r\n        cursor: pointer;\r\n        margin-right: 12px;\r\n        background: #ffffff;\r\n        border-radius: 4px;\r\n        border: 1px solid #e1e4e8;\r\n\r\n        &:hover {\r\n          border-color: #0056ff;\r\n        }\r\n\r\n        &.active {\r\n          border-color: #0056ff;\r\n        }\r\n\r\n        &.active::before {\r\n          position: absolute;\r\n          right: 0;\r\n          bottom: 0;\r\n          content: \"\";\r\n          width: 27px;\r\n          height: 27px;\r\n          background: url(\"../../assets/images/select-icon.png\") no-repeat\r\n            center;\r\n          background-size: 100%;\r\n        }\r\n      }\r\n    }\r\n\r\n    .balance-list li {\r\n      flex-direction: column;\r\n\r\n      .amount {\r\n        font-size: 14px;\r\n        color: #9ca6b9;\r\n        margin-top: 10px;\r\n      }\r\n    }\r\n\r\n    .offline-list {\r\n      li {\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n        justify-content: flex-end;\r\n        width: 304px;\r\n        height: 170px;\r\n        border-color: transparent;\r\n\r\n        &:hover {\r\n          border-color: transparent;\r\n        }\r\n\r\n        p {\r\n          font-size: 13px;\r\n          padding: 0 16px;\r\n          margin-bottom: 5px;\r\n\r\n          &:last-child {\r\n            margin-bottom: 20px;\r\n          }\r\n        }\r\n      }\r\n\r\n      li:nth-child(1) {\r\n        background: url(\"../../assets/images/pay-zs.png\") no-repeat center;\r\n        background-size: 100%;\r\n      }\r\n\r\n      li:nth-child(2) {\r\n        background: url(\"../../assets/images/pay-zfb.png\") no-repeat center;\r\n        background-size: 100%;\r\n      }\r\n    }\r\n\r\n    .online-list,\r\n    .balance-list {\r\n      svg {\r\n        width: 150px;\r\n        height: 35px;\r\n      }\r\n    }\r\n  }\r\n}\r\n\r\n.body-container {\r\n  display: flex;\r\n  flex-direction: column;\r\n  align-items: center;\r\n  justify-content: center;\r\n\r\n  .QR-code {\r\n    display: flex;\r\n    align-items: center;\r\n    justify-content: center;\r\n    width: 168px;\r\n    height: 168px;\r\n    margin-bottom: 40px;\r\n    border: 1px solid #e1e4e8;\r\n  }\r\n\r\n  .word {\r\n    font-size: 14px;\r\n    color: #242934;\r\n    line-height: 1;\r\n  }\r\n\r\n  .amount {\r\n    font-size: 26px;\r\n    font-weight: 600;\r\n    color: #f12525;\r\n    line-height: 1;\r\n    margin: 12px 0 40px;\r\n  }\r\n\r\n  .prompt {\r\n    font-size: 14px;\r\n    color: #9ca6b9;\r\n    line-height: 1;\r\n  }\r\n}\r\n\r\n.offline-pay {\r\n  .custom-upload-img {\r\n    width: 50%;\r\n    margin-bottom: 40px;\r\n  }\r\n}\r\n</style>\r\n<style lang=\"scss\">\r\n.payment-dialog {\r\n  .el-dialog__body {\r\n    padding: 0;\r\n  }\r\n\r\n  .el-dialog__footer {\r\n    padding: 40px 0 50px;\r\n  }\r\n}\r\n</style>\r\n","import script from \"./vip-buy.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./vip-buy.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./vip-buy.vue?vue&type=style&index=0&id=3b64e5c8&lang=scss&scoped=true\"\nimport \"./vip-buy.vue?vue&type=style&index=1&id=3b64e5c8&lang=scss\"\n\nimport exportComponent from \"../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-3b64e5c8\"]])\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","_hoisted_4","_hoisted_5","_hoisted_6","_hoisted_7","_hoisted_8","_hoisted_9","_hoisted_10","_hoisted_11","_hoisted_12","_hoisted_13","_hoisted_14","_hoisted_15","_hoisted_16","_hoisted_17","__default__","name","_defineComponent","props","orderId","setup","__props","VipBuyQRCodeDialog","defineAsyncComponent","goPage","useVueRouter","marketPayment","SessionStorage","batchGetItem","paramsData","shallowReactive","onlinePayment","balancePayment","activeIndex","paymentVisible","paymentLink","paymentMoney","accountInfo","paymentList","label","value","onlineTypeList","onlineType","svgName","balanceTypeList","balanceType","word","payType","computed","getAccountBalance","async","data","queryAccountApi","getData","tabClick","item","paymentClick","type","updatePayTypeApi","submitPayment","params","orderNo","total","sumPrice","profileId","companyId","toPayApi","handleAfterPay","window","open","location","origin","encodeURIComponent","then","batchRemoveItem","onMounted","modePayment","paymentType","_ctx","_cache","_component_tab_list","_resolveComponent","_component_el_button","_openBlock","_createElementBlock","_Fragment","_createElementVNode","_withDirectives","$event","_unref","placeholder","disabled","_vModelText","number","_createVNode","onEmitTab","list","_renderList","index","key","_normalizeClass","onClick","default","_withCtx","_createTextVNode","_","_vShow","_toDisplayString","visible","__exports__"],"sourceRoot":""}