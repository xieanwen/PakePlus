{"version":3,"file":"static/js/4841.db36b64a.js","mappings":"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","sources":["webpack://daili/./src/components/order-management/create-order/product-detail/common.ts","webpack://daili/./src/views/order-management/create-order/product-detail/index.vue?8cd0","webpack://daili/./src/views/order-management/create-order/product-detail/index.vue","webpack://daili/./src/views/order-management/create-order/product-detail/index.vue?2dd7"],"sourcesContent":["import router from \"@/router\";\r\nimport { ElMessage } from \"element-plus\";\r\nimport { markRaw, defineAsyncComponent } from \"vue\";\r\nimport { SessionStorage } from \"jz-tool-lib\";\r\nimport {\r\n  canBuyApi,\r\n  productDetailApi,\r\n  productPriceApi,\r\n} from \"@api/order-management-api\";\r\n\r\n/*********************************产品组件 begin***************************************/\r\n// 鱼鹰呼叫套餐\r\nconst CloudCallPackage = defineAsyncComponent(\r\n  () => import(\"./cloud-call-package.vue\")\r\n);\r\n// 呼叫套餐坐席\r\nconst PackageCallSeat = defineAsyncComponent(\r\n  () => import(\"./cloud-call-package-seat.vue\")\r\n);\r\n// 鱼鹰呼叫软件\r\nconst CloudCallSoft = defineAsyncComponent(\r\n  () => import(\"./cloud-call-soft.vue\")\r\n);\r\n// 呼叫软件坐席\r\nconst CloudCallSeat = defineAsyncComponent(\r\n  () => import(\"./cloud-call-soft-seat.vue\")\r\n);\r\n// 呼叫套餐（大客户套餐）\r\nconst CloudCallPackageBig = defineAsyncComponent(\r\n  () => import(\"./cloud-call-package-big.vue\")\r\n);\r\n// 呼叫套餐坐席\r\nconst PackageCallSeatBig = defineAsyncComponent(\r\n  () => import(\"./cloud-call-package-seat-big.vue\")\r\n);\r\n\r\n/********** 增值服务-开始 ************/\r\nconst OrdinaryService = defineAsyncComponent(\r\n  () => import(\"./ordinary-service.vue\")\r\n);\r\n/********** 增值服务-结束 ************/\r\n\r\n/********** 增值服务-开始 ************/\r\nconst AddedService = defineAsyncComponent(() => import(\"./added-service.vue\"));\r\n// 增值服务-录音增值包\r\nconst AddedPackageRecording = defineAsyncComponent(\r\n  () => import(\"./added-recording-package.vue\")\r\n);\r\n/********** 增值服务-结束 ************/\r\n\r\n/********** 21秒系列产品-开始 *************/\r\n// 21s秒云集客新套餐（正式版、免费版）\r\nconst Im21YunJiKePackage = defineAsyncComponent(\r\n  () => import(\"./im21-yunJiKe-package.vue\")\r\n);\r\n//21s-云查客企业版\r\nconst Im21YunChaKePackage = defineAsyncComponent(\r\n  () => import(\"./im21-yunChaKe-package.vue\")\r\n);\r\n/********** 21秒系列产品-结束 *************/\r\n// 视频矩阵\r\nconst VideoMatrix = defineAsyncComponent(() => import(\"./video-matrix.vue\"));\r\n// 号码订购\r\nconst NumberOrdering = defineAsyncComponent(\r\n  () => import(\"./number-ordering.vue\")\r\n);\r\n// 短信条数\r\nconst MessageTypeService = defineAsyncComponent(\r\n  () => import(\"./message-type-service.vue\")\r\n);\r\n// 渠道商加盟包\r\nconst ChannelPackage = defineAsyncComponent(\r\n  () => import(\"./channel-package.vue\")\r\n);\r\n\r\n/**\r\n // calculateType:\r\n // 购买服务：1；\r\n // 增值服务：2；\r\n // 鱼鹰呼叫套餐：3；\r\n // 购买服务人数：4；\r\n // 套餐坐席：5；\r\n // 呼叫软件、软件坐席：6；\r\n // 录音增值包：7；\r\n // 呼叫中心、中心坐席：8；\r\n // 事儿号码：9；\r\n // 大客户套餐：10；\r\n // 大客户套餐坐席：11；\r\n // 云客查：12；\r\n // 云查客坐席：13；\r\n // 号码订购：14；\r\n // 通用的sku权限类服务：22；\r\n */\r\n// TODO: 购买服务\r\nfunction handleService(serviceCode: string) {\r\n  console.log(serviceCode);\r\n  return markRaw(OrdinaryService);\r\n}\r\n\r\n// TODO: 鱼鹰呼叫软件，鱼鹰呼叫软件坐席\r\nfunction handleCallSoftService(serviceCode: string) {\r\n  if ([\"CLOUD_CALL_SOFT\"].includes(serviceCode)) {\r\n    return markRaw(CloudCallSoft);\r\n  } else if ([\"CALL_SOFT_SEAT\"].includes(serviceCode)) {\r\n    return markRaw(CloudCallSeat);\r\n  }\r\n}\r\n\r\n// TODO: 增值服务\r\nfunction handleAddedService(serviceCode: string) {\r\n  if (\r\n    [\r\n      \"VOICE_SERVICE\", //话务充值\r\n      \"STORE_SERVICE\", //云盘服务\r\n      \"CUSTOMER_SERVICE\", //客户增量\r\n      \"ACCOUNT_ACCESS_21S\", //账户数\r\n      \"INTERFACES_21S\", //接口数\r\n      \"BADOU_21S\", //八豆\r\n      \"VIDEO_MATRIX_ACCOUNT\", // 视频矩阵账号\r\n      \"PRO_CUS_UNLOCHED_ADD\", // 解锁额度增量包\r\n    ].includes(serviceCode)\r\n  ) {\r\n    return markRaw(AddedService);\r\n  } else if ([\"VIDEO_MATRIX\"].includes(serviceCode)) {\r\n    // 视频矩阵\r\n    return markRaw(VideoMatrix);\r\n  } else if ([\"CALL_NUMBER_ORDER\"].includes(serviceCode)) {\r\n    // 号码订购\r\n    return markRaw(NumberOrdering);\r\n  } else if ([\"MESSAGE_TYPE_SERVICE\"].includes(serviceCode)) {\r\n    // 短信条数\r\n    return markRaw(MessageTypeService);\r\n  } else if ([\"JMB\"].includes(serviceCode)) {\r\n    // 渠道加盟包\r\n    return markRaw(ChannelPackage);\r\n  }\r\n}\r\n\r\n// TODO: 通用的sku权限类服务\r\nfunction handleGeneralPackage(serviceCode: string) {\r\n  if (\r\n    [\r\n      \"EXPAND_CUSTOMER_PRO\", // 云查客套餐\r\n    ].includes(serviceCode)\r\n  ) {\r\n    return markRaw(Im21YunChaKePackage);\r\n  } else if (\r\n    [\r\n      \"CLOUD_CUSTOMER_21S\", // 云集客套餐（免费、正式）\r\n    ].includes(serviceCode)\r\n  ) {\r\n    return markRaw(Im21YunJiKePackage);\r\n  }\r\n}\r\n\r\nexport const componentList = [\r\n  {\r\n    calculateType: \"1\",\r\n    name: handleService,\r\n  },\r\n  {\r\n    calculateType: \"2\",\r\n    name: handleAddedService,\r\n  },\r\n  {\r\n    calculateType: \"3\",\r\n    name: () => markRaw(CloudCallPackage),\r\n  },\r\n  {\r\n    calculateType: \"5\",\r\n    name: () => markRaw(PackageCallSeat),\r\n  },\r\n  {\r\n    calculateType: \"6\",\r\n    name: handleCallSoftService,\r\n  },\r\n  {\r\n    calculateType: \"7\",\r\n    name: () => markRaw(AddedPackageRecording),\r\n  },\r\n  {\r\n    calculateType: \"10\",\r\n    name: () => markRaw(CloudCallPackageBig),\r\n  },\r\n  {\r\n    calculateType: \"11\",\r\n    name: () => markRaw(PackageCallSeatBig),\r\n  },\r\n  {\r\n    calculateType: \"12\",\r\n    name: () => markRaw(AddedPackageRecording),\r\n  },\r\n  {\r\n    calculateType: \"13\",\r\n    name: handleAddedService,\r\n  },\r\n  {\r\n    calculateType: \"22\",\r\n    name: handleGeneralPackage,\r\n  },\r\n];\r\n\r\n/*********************************产品组件 end***************************************/\r\n// 获取价格\r\nexport async function handlePrice(params: any) {\r\n  if (Reflect.has(params, \"sumPrice\")) {\r\n    Reflect.deleteProperty(params, \"sumPrice\");\r\n  }\r\n  const { data } = await productPriceApi.getData(params);\r\n  const { productList } = productPriceApi.handleData(data);\r\n  const {\r\n    price,\r\n    sumPrice,\r\n    addedPrice,\r\n    unitPrice,\r\n    subMarketList,\r\n    errorCode,\r\n    errorMsg,\r\n  } = productList[0];\r\n  if (errorCode === 500) {\r\n    ElMessage.warning(errorMsg);\r\n  }\r\n  return {\r\n    price,\r\n    sumPrice,\r\n    addedPrice,\r\n    unitPrice,\r\n    subMarketList,\r\n    hasAgentPrice: errorCode !== 500,\r\n  };\r\n}\r\n\r\n// 跳转下单\r\nexport function createdOrder(data: { [propName: string]: any }) {\r\n  SessionStorage.setItem(\"bd_market-cart\", data.params);\r\n  SessionStorage.setItem(\"bd_market-commodity\", data.commodityInfo);\r\n  router.push(\"/orderManagement/createOrder/confirmOrder\");\r\n}\r\n\r\n// 产品详情\r\nexport async function productDetail(query: any) {\r\n  try {\r\n    const params = {\r\n      serviceCode: query.serviceCode,\r\n    };\r\n    const { data } = await productDetailApi.getData(params);\r\n    return productDetailApi.handleData(data);\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n}\r\n\r\n// 是否可以购买此产品\r\nexport async function canBuy(query: any) {\r\n  try {\r\n    const params = {\r\n      serviceCode: query.serviceCode,\r\n      companyId: query.companyId,\r\n    };\r\n    const { data } = await canBuyApi.getData(params);\r\n    return canBuyApi.handleData(data);\r\n  } catch (e) {\r\n    console.log(e);\r\n  }\r\n}\r\n","import { defineComponent as _defineComponent } from 'vue'\nimport { resolveDynamicComponent as _resolveDynamicComponent, openBlock as _openBlock, createBlock as _createBlock, createCommentVNode as _createCommentVNode, resolveComponent as _resolveComponent, createElementBlock as _createElementBlock } from \"vue\"\n\nconst _hoisted_1 = { class: \"product-container\" }\n\nimport { shallowRef, computed } from \"vue\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport {\r\n  canBuy,\r\n  productDetail,\r\n  componentList,\r\n} from \"@components/order-management/create-order/product-detail/common\";\r\nimport {\r\n  purchasedAddedApi,\r\n  purchasedAddedProductApi,\r\n  purchasedServiceProductApi,\r\n  purchasedCloudCallPackageApi,\r\n} from \"@api/order-management-api\";\r\nimport { companyBusinessTagsApi } from \"@api/business-management-api\";\r\n\r\n\nexport default /*@__PURE__*/_defineComponent({\n  ...{\r\n  name: \"orderManagement.createOrder.productDetail\",\r\n},\n  __name: 'index',\n  setup(__props) {\n\r\n\r\nconst { routeQuery } = useVueRouter();\r\nconst activeComponent = computed(() => {\r\n  return componentList\r\n    .find((item: Record<string, any>) => {\r\n      return item.calculateType === routeQuery.value.calculateType;\r\n    })\r\n    ?.name(routeQuery.value.serviceCode);\r\n});\r\nconst showComponent = shallowRef<boolean>(false);\r\nconst tagList = shallowRef<any[]>([]);\r\nconst productData = shallowRef<any>({});\r\nconst purchasedData = shallowRef<any[]>([]);\r\n\r\n// 获取所有信息\r\ngetData();\r\n\r\nfunction getData() {\r\n  if (\r\n    [\r\n      \"CLOUD_CALL_SOFT\",\r\n      \"CALL_NUMBER_ORDER\",\r\n      \"CLOUD_CALL_PACKAGE\",\r\n      \"CLOUD_CALL_PACKAGE_BIG\",\r\n    ].includes(routeQuery.value.serviceCode)\r\n  ) {\r\n    getCompanyBusinessTags();\r\n  }\r\n  Promise.allSettled([\r\n    productDetail(routeQuery.value),\r\n    canBuy(routeQuery.value),\r\n  ])\r\n    .then((res) => {\r\n      const resultList = res.filter((item) => item.status === \"fulfilled\");\r\n      if (!resultList.length) return;\r\n      productData.value = resultList.reduce(\r\n        (beginObj: Record<string, any>, item: Record<string, any>) => {\r\n          return Object.assign(beginObj, item.value);\r\n        },\r\n        {}\r\n      );\r\n      getPurchasedInfo();\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n}\r\n\r\n// 获取已购产品信息\r\nasync function getPurchasedInfo() {\r\n  let api: any;\r\n  const params = {\r\n    companyId: routeQuery.value.companyId,\r\n  };\r\n  // calculateType 1：普通服务\r\n  //               2：增值服务\r\n  //               3：鱼鹰呼叫套餐\r\n  //               4：服务人数\r\n  //               5：呼叫套餐坐席，\r\n  //               6：鱼鹰呼叫软件，鱼鹰呼叫软件坐席\r\n  //               7：录音增值包服务\r\n  //               9：事儿电话\r\n  //               11：大客户套餐坐席\r\n  const { serviceInfo, addedServiceList } = productData.value;\r\n  if ([\"2\", \"7\"].includes(serviceInfo?.calculateType)) {\r\n    if ([\"CALL_NUMBER_ORDER\"].includes(serviceInfo.combineServiceCode)) {\r\n      // 号码订购\r\n      api = purchasedAddedApi;\r\n      Reflect.set(params, \"resourceCode\", serviceInfo.addedCodes);\r\n    } else {\r\n      api = purchasedAddedProductApi;\r\n      const groupCodes =\r\n        addedServiceList\r\n          ?.map((item: Record<string, any>) => item.groupCodes)\r\n          .join(\",\") || \"\";\r\n      Reflect.set(params, \"resourceCode\", groupCodes);\r\n    }\r\n  } else if ([\"5\", \"11\"].includes(serviceInfo?.calculateType)) {\r\n    // 鱼鹰呼叫套餐坐席、大客户套餐呼叫坐席\r\n    api = purchasedCloudCallPackageApi;\r\n    Reflect.set(\r\n      params,\r\n      \"marketCode\",\r\n      serviceInfo?.calculateType === \"5\"\r\n        ? \"CLOUD_CALL_PACKAGE\"\r\n        : \"CLOUD_CALL_PACKAGE_BIG\"\r\n    );\r\n  } else if (serviceInfo?.calculateType === \"6\") {\r\n    // 鱼鹰呼叫软件、鱼鹰呼叫软件坐席\r\n    api = purchasedServiceProductApi;\r\n    Reflect.set(params, \"serviceCode\", \"CLOUD_CALL_SOFT\");\r\n  }\r\n  if (api) {\r\n    try {\r\n      const { data } = await api.getData(params);\r\n      purchasedData.value = api.handleData(data);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  showComponent.value = true;\r\n}\r\n// TODO：获取公司业务标签(套餐、软件、大客户套餐、号码订购)\r\nasync function getCompanyBusinessTags() {\r\n  const { data } = await companyBusinessTagsApi.getData(\r\n    routeQuery.value.companyId\r\n  );\r\n  tagList.value = companyBusinessTagsApi.handleData(data);\r\n}\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_skeleton = _resolveComponent(\"el-skeleton\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    (showComponent.value)\n      ? (_openBlock(), _createBlock(_resolveDynamicComponent(activeComponent.value), {\n          key: 0,\n          tagList: tagList.value,\n          productData: productData.value,\n          purchasedData: purchasedData.value\n        }, null, 8, [\"tagList\", \"productData\", \"purchasedData\"]))\n      : (_openBlock(), _createBlock(_component_el_skeleton, {\n          key: 1,\n          rows: 12,\n          style: {\"margin-top\":\"40px\"}\n        }))\n  ]))\n}\n}\n\n})","<template>\r\n  <div class=\"product-container\">\r\n    <component\r\n      v-if=\"showComponent\"\r\n      :is=\"activeComponent\"\r\n      :tagList=\"tagList\"\r\n      :productData=\"productData\"\r\n      :purchasedData=\"purchasedData\"\r\n    ></component>\r\n    <el-skeleton v-else :rows=\"12\" style=\"margin-top: 40px\" />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { shallowRef, computed } from \"vue\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport {\r\n  canBuy,\r\n  productDetail,\r\n  componentList,\r\n} from \"@components/order-management/create-order/product-detail/common\";\r\nimport {\r\n  purchasedAddedApi,\r\n  purchasedAddedProductApi,\r\n  purchasedServiceProductApi,\r\n  purchasedCloudCallPackageApi,\r\n} from \"@api/order-management-api\";\r\nimport { companyBusinessTagsApi } from \"@api/business-management-api\";\r\n\r\ndefineOptions({\r\n  name: \"orderManagement.createOrder.productDetail\",\r\n});\r\nconst { routeQuery } = useVueRouter();\r\nconst activeComponent = computed(() => {\r\n  return componentList\r\n    .find((item: Record<string, any>) => {\r\n      return item.calculateType === routeQuery.value.calculateType;\r\n    })\r\n    ?.name(routeQuery.value.serviceCode);\r\n});\r\nconst showComponent = shallowRef<boolean>(false);\r\nconst tagList = shallowRef<any[]>([]);\r\nconst productData = shallowRef<any>({});\r\nconst purchasedData = shallowRef<any[]>([]);\r\n\r\n// 获取所有信息\r\ngetData();\r\n\r\nfunction getData() {\r\n  if (\r\n    [\r\n      \"CLOUD_CALL_SOFT\",\r\n      \"CALL_NUMBER_ORDER\",\r\n      \"CLOUD_CALL_PACKAGE\",\r\n      \"CLOUD_CALL_PACKAGE_BIG\",\r\n    ].includes(routeQuery.value.serviceCode)\r\n  ) {\r\n    getCompanyBusinessTags();\r\n  }\r\n  Promise.allSettled([\r\n    productDetail(routeQuery.value),\r\n    canBuy(routeQuery.value),\r\n  ])\r\n    .then((res) => {\r\n      const resultList = res.filter((item) => item.status === \"fulfilled\");\r\n      if (!resultList.length) return;\r\n      productData.value = resultList.reduce(\r\n        (beginObj: Record<string, any>, item: Record<string, any>) => {\r\n          return Object.assign(beginObj, item.value);\r\n        },\r\n        {}\r\n      );\r\n      getPurchasedInfo();\r\n    })\r\n    .catch((e) => {\r\n      console.log(e);\r\n    });\r\n}\r\n\r\n// 获取已购产品信息\r\nasync function getPurchasedInfo() {\r\n  let api: any;\r\n  const params = {\r\n    companyId: routeQuery.value.companyId,\r\n  };\r\n  // calculateType 1：普通服务\r\n  //               2：增值服务\r\n  //               3：鱼鹰呼叫套餐\r\n  //               4：服务人数\r\n  //               5：呼叫套餐坐席，\r\n  //               6：鱼鹰呼叫软件，鱼鹰呼叫软件坐席\r\n  //               7：录音增值包服务\r\n  //               9：事儿电话\r\n  //               11：大客户套餐坐席\r\n  const { serviceInfo, addedServiceList } = productData.value;\r\n  if ([\"2\", \"7\"].includes(serviceInfo?.calculateType)) {\r\n    if ([\"CALL_NUMBER_ORDER\"].includes(serviceInfo.combineServiceCode)) {\r\n      // 号码订购\r\n      api = purchasedAddedApi;\r\n      Reflect.set(params, \"resourceCode\", serviceInfo.addedCodes);\r\n    } else {\r\n      api = purchasedAddedProductApi;\r\n      const groupCodes =\r\n        addedServiceList\r\n          ?.map((item: Record<string, any>) => item.groupCodes)\r\n          .join(\",\") || \"\";\r\n      Reflect.set(params, \"resourceCode\", groupCodes);\r\n    }\r\n  } else if ([\"5\", \"11\"].includes(serviceInfo?.calculateType)) {\r\n    // 鱼鹰呼叫套餐坐席、大客户套餐呼叫坐席\r\n    api = purchasedCloudCallPackageApi;\r\n    Reflect.set(\r\n      params,\r\n      \"marketCode\",\r\n      serviceInfo?.calculateType === \"5\"\r\n        ? \"CLOUD_CALL_PACKAGE\"\r\n        : \"CLOUD_CALL_PACKAGE_BIG\"\r\n    );\r\n  } else if (serviceInfo?.calculateType === \"6\") {\r\n    // 鱼鹰呼叫软件、鱼鹰呼叫软件坐席\r\n    api = purchasedServiceProductApi;\r\n    Reflect.set(params, \"serviceCode\", \"CLOUD_CALL_SOFT\");\r\n  }\r\n  if (api) {\r\n    try {\r\n      const { data } = await api.getData(params);\r\n      purchasedData.value = api.handleData(data);\r\n    } catch (e) {\r\n      console.log(e);\r\n    }\r\n  }\r\n  showComponent.value = true;\r\n}\r\n// TODO：获取公司业务标签(套餐、软件、大客户套餐、号码订购)\r\nasync function getCompanyBusinessTags() {\r\n  const { data } = await companyBusinessTagsApi.getData(\r\n    routeQuery.value.companyId\r\n  );\r\n  tagList.value = companyBusinessTagsApi.handleData(data);\r\n}\r\n</script>\r\n<style scoped lang=\"scss\">\r\n.product-container {\r\n  width: 1045px;\r\n  margin: 0 auto;\r\n}\r\n\r\n:deep(.service-specs) {\r\n  margin-top: 20px;\r\n  padding: 40px 0;\r\n  border-radius: 12px;\r\n  background-color: #ffffff;\r\n\r\n  .el-form {\r\n    min-height: 300px;\r\n    padding: 0 40px;\r\n\r\n    .el-form-item {\r\n      margin-bottom: 25px;\r\n\r\n      &.amount-form-item .el-form-item__content {\r\n        flex-direction: column;\r\n        align-items: flex-start;\r\n      }\r\n    }\r\n\r\n    .el-form-item__label {\r\n      padding: 0 40px 0 28px;\r\n    }\r\n\r\n    .el-form-item__content > .word {\r\n      flex-basis: 100%;\r\n      color: #9ca6b9;\r\n      line-height: 36px;\r\n    }\r\n\r\n    .el-input,\r\n    .el-select {\r\n      width: 440px;\r\n    }\r\n\r\n    .el-input-number {\r\n      width: 440px;\r\n      margin-top: 20px;\r\n    }\r\n\r\n    .purchased-info,\r\n    .purchased-list {\r\n      width: 640px;\r\n      max-width: 640px;\r\n    }\r\n\r\n    @mixin info {\r\n      @include flex(center);\r\n      flex-wrap: wrap;\r\n      p,\r\n      span {\r\n        flex: 0 0 320px;\r\n        color: #606266;\r\n        @include flex(center);\r\n      }\r\n    }\r\n\r\n    .purchased-info {\r\n      @include info;\r\n    }\r\n  }\r\n}\r\n</style>\r\n","import script from \"./index.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./index.vue?vue&type=script&setup=true&lang=ts\"\n\nimport \"./index.vue?vue&type=style&index=0&id=bede3122&scoped=true&lang=scss\"\n\nimport exportComponent from \"../../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-bede3122\"]])\n\nexport default __exports__"],"names":["CloudCallPackage","defineAsyncComponent","PackageCallSeat","CloudCallSoft","CloudCallSeat","CloudCallPackageBig","PackageCallSeatBig","OrdinaryService","AddedService","AddedPackageRecording","Im21YunJiKePackage","Im21YunChaKePackage","VideoMatrix","NumberOrdering","MessageTypeService","ChannelPackage","handleService","serviceCode","console","log","markRaw","handleCallSoftService","includes","handleAddedService","handleGeneralPackage","componentList","calculateType","name","async","handlePrice","params","Reflect","has","deleteProperty","data","productPriceApi","getData","productList","handleData","price","sumPrice","addedPrice","unitPrice","subMarketList","errorCode","errorMsg","ElMessage","warning","hasAgentPrice","createdOrder","SessionStorage","setItem","commodityInfo","router","push","productDetail","query","productDetailApi","e","canBuy","companyId","canBuyApi","_hoisted_1","class","_defineComponent","__name","setup","__props","routeQuery","useVueRouter","activeComponent","computed","_componentList$find","find","item","value","showComponent","shallowRef","tagList","productData","purchasedData","getCompanyBusinessTags","Promise","allSettled","then","res","resultList","filter","status","length","reduce","beginObj","Object","assign","getPurchasedInfo","catch","api","serviceInfo","addedServiceList","combineServiceCode","purchasedAddedApi","set","addedCodes","purchasedAddedProductApi","groupCodes","map","join","purchasedCloudCallPackageApi","purchasedServiceProductApi","companyBusinessTagsApi","_ctx","_cache","_component_el_skeleton","_resolveComponent","_openBlock","_createElementBlock","_createBlock","_resolveDynamicComponent","key","rows","style","__exports__"],"sourceRoot":""}