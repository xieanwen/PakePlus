"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[4940],{94940:function(e,l,a){a.r(l),a.d(l,{default:function(){return v}});a(95226),a(59784),a(29296),a(47961),a(70549);var o=a(6254),i=a(25598),t=a(38627),n=a(59259),u=a(10901),d=a(88365),s=a(35287);const b={class:"business-label-content"},c={class:"dialog-footer"};var r=(0,o.pM)({__name:"edit-business-label-dialog",emits:["emitFunc"],setup(e,{expose:l,emit:r}){const p=(0,o.$V)((()=>Promise.all([a.e(2076),a.e(4559)]).then(a.bind(a,83862)))),m=r,{routeQuery:v}=(0,u.dG)(),{bd_userInfo:f}=d.DT.batchGetItem(["bd_userInfo"]),y=(0,i.Kh)({visible:!1,label:[],companyLabel:[],labelGroup:[],companyLabelGroup:[]}),g=async()=>{const{data:e}=await s.Ti.getData();y.companyLabelGroup=s.Ti.handleData(e)},k=e=>{e.length?(y.label=y.label.filter((l=>{const a=l.split("&");return e.includes(a[1])})),G(e.toString())):(y.label=[],y.companyLabel=[])},G=async e=>{const l={labelGroupId:e},{data:a}=await s.EA.getData(l);y.companyLabel=s.EA.handleData(a)};async function h(){const e=L(y.label),l={businessLabels:e,companyId:v.value.companyId,profileId:f.profileId,profileName:f.realName,reportId:v.value.id};await s.Gc.getData(l),n.nk.success("修改成功"),m("emitFunc",e),I()}const L=e=>{const l=[];return e.forEach((e=>{const a=e.split("&"),o=l.find((e=>e.group.id===a[1])),i=y.companyLabel.find((e=>e.id===a[0]));if(o)o.labels.push({id:i.id,labelName:i.labelName});else{const e=y.companyLabelGroup.find((e=>e.value===a[1]));l.push({group:{id:null===e||void 0===e?void 0:e.value,labelGroupName:null===e||void 0===e?void 0:e.label},labels:[{id:null===i||void 0===i?void 0:i.id,labelName:null===i||void 0===i?void 0:i.labelName}]})}})),l.length?JSON.stringify(l):""};function I(){y.label=[],y.labelGroup=[],y.companyLabel=[],y.companyLabelGroup=[],y.visible=!1}async function V(e,l){y.visible=e,await g(),y.labelGroup=l.groupLabelValue,await k(y.labelGroup),y.label=l.labelValue}return l({trigger:V}),(e,l)=>{const a=(0,o.g2)("el-checkbox"),n=(0,o.g2)("el-checkbox-group"),u=(0,o.g2)("el-button"),d=(0,o.g2)("el-dialog");return(0,o.uX)(),(0,o.Wv)(d,{modelValue:y.visible,"onUpdate:modelValue":l[3]||(l[3]=e=>y.visible=e),title:"修改业务标签",width:"600px",class:"custom-dialog","before-close":I},{footer:(0,o.k6)((()=>[(0,o.Lk)("div",c,[(0,o.bF)(u,{onClick:l[2]||(l[2]=e=>y.visible=!1)},{default:(0,o.k6)((()=>l[4]||(l[4]=[(0,o.eW)("取消")]))),_:1}),(0,o.bF)(u,{type:"primary",onClick:h},{default:(0,o.k6)((()=>l[5]||(l[5]=[(0,o.eW)("确定")]))),_:1})])])),default:(0,o.k6)((()=>[(0,o.Lk)("div",b,[(0,o.bF)((0,i.R1)(p),{direction:"column",list:y.companyLabelGroup,modelValue:y.labelGroup,"onUpdate:modelValue":[l[0]||(l[0]=e=>y.labelGroup=e),k]},null,8,["list","modelValue"]),(0,o.bF)(n,{modelValue:y.label,"onUpdate:modelValue":l[1]||(l[1]=e=>y.label=e),class:"label-list"},{default:(0,o.k6)((()=>[((0,o.uX)(!0),(0,o.CE)(o.FK,null,(0,o.pI)(y.companyLabel,(e=>((0,o.uX)(),(0,o.Wv)(a,{key:e.id,value:`${e.id}&${e.labelGroupId}`},{default:(0,o.k6)((()=>[(0,o.eW)((0,t.v_)(e.labelName),1)])),_:2},1032,["value"])))),128))])),_:1},8,["modelValue"])])])),_:1},8,["modelValue"])}}}),p=a(83936);const m=(0,p.A)(r,[["__scopeId","data-v-50e75d78"]]);var v=m}}]);
//# sourceMappingURL=4940.e4788e14.js.map