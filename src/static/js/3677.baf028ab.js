"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[3677],{13677:function(e,l,a){a.r(l),a.d(l,{default:function(){return X}});a(95226),a(59784),a(29296),a(47961),a(70549),a(83238),a(84e3);var t=a(6254),o=a(38627),u=a(25598),p=a(59259),i=a(88365),r=a(35287);const n={key:0,class:"business-label"},d={class:"label-list"},s={key:2,class:"form-tip"},m={key:2,class:"form-tip"},c={style:{display:"flex","align-items":"center"}},v={key:0,class:"form-tip"},y={key:0,class:"form-tip"},k={key:0,class:"form-tip"},b={key:0,class:"form-tip"},f={key:0,class:"form-tip"},g={key:1,class:"form-tip"},_={key:0,class:"form-tip"},h={key:0,class:"form-tip"};var L=(0,t.pM)({__name:"add-edit-report-drawer",emits:["emitFunc"],setup(e,{expose:l,emit:L}){const V=(0,t.$V)((()=>a.e(5546).then(a.bind(a,55546)))),C=(0,t.$V)((()=>Promise.all([a.e(2076),a.e(3319)]).then(a.bind(a,16088)))),X=L,{bd_userInfo:F,bd_virCompanyId:E,bd_authorization:I}=i.DT.batchGetItem(["bd_userInfo","bd_virCompanyId","bd_authorization"]),U=(0,u.KR)(),K=(0,u.KR)(),W=(0,u.KR)(),T=(0,u.KR)([]),w=(0,u.KR)([]),Q=(0,u.KR)([]),x=(0,u.Kh)({type:"",visible:!1}),N=(0,u.KR)({id:"",companyId:"",companyCode:"",companyName:"",businessType:""}),D=(0,u.Kh)({componentList:[]});function R(e,l){var a;const t={...l,companyId:N.value.companyId,businessType:N.value.businessType,subCompanyCode:N.value.companyCode};null===(a=W.value)||void 0===a||a.toggle(e,!0,t)}const O=()=>{U.value&&U.value.validate((e=>{e&&B()}))};async function B(){const e=D.componentList.map((e=>{let l;if(1===e.propertyType)l="business_label"===e.propertyKey?JSON.stringify(e.value):e.value;else if(5===e.propertyType)l=e.value.join(",");else if(12===e.propertyType){let a=e.optionBOList.filter((l=>e.value.includes(l.id))).map((e=>({key:e.id,value:e.value2})));l=JSON.stringify(a)}else l="industry"===e.propertyKey?e.value[e.value.length-1]:14===e.propertyType?T.value.join(","):e.value;return{mainId:e.id,propertyKey:e.propertyKey,propertyType:e.propertyType,tagName:e.tagName,value:l}})),l={agentSubCompanyId:N.value.companyId,agentProfileId:F.profileId,token:I,companyId:E,profileId:F.profileId,requestVOList:e,sourceType:0,type:2},a=await(1===N.value.businessType?r.om:r.cW).getData(l);0===a.statusCode&&((0,p.nk)({message:a.msg,type:"success"}),X("emitFunc",{type:"list"}),H())}async function S(){const e={lineIds:0},{data:l}=await r.tn.getData(e),{list:a}=r.tn.handleData(l,N.value);D.componentList=a}async function $(){const e={id:N.value.id,sourceType:0},{data:l}=await r.IE.getData(e),{list:a}=r.IE.handleData(l.componentList,N.value,w.value);D.componentList=a}function z(){Promise.all([P(),q()]).then((()=>{"add"===x.type?S():"edit"===x.type&&$()}))}const P=async()=>{const{data:e}=await r.Bu.getData();w.value=r.Bu.handleData(e)},q=async()=>{const e={pageSize:100,pageNo:1,companyCode:N.value.companyCode,companyId:E},{data:l}=await r.Kl.getData(e);Q.value=l.records};function M(e){const l=[];return e.isRequired&&l.push({required:!0,message:e.placeholder?e.placeholder:e.tagName+"不能为空",trigger:"change"}),l}function j(e,l,a,t){if(14===t.propertyType)T.value.length||l(new Error("话术关键词不能为空")),T.value.length<5&&l(new Error("话术关键词不能少于5个"));else{const o=t.value;o.length&&o.includes(t.optionBOList[a].id)&&!e&&l(new Error("请输入"))}l()}function J(e){const{ids:l,key:a}=e;D.componentList.forEach((e=>{e.propertyKey===a&&(e.value=l)}))}function A(e){const l=e.value,a=l.reduce(((e,l)=>{const a=l.labels.map((e=>(e.groupId=l.group.id,e)));return e.concat(a)}),[]),t=a.map((e=>`${e.id}&${e.groupId}`)),o=l.map((e=>e.group.id));K.value.trigger(!0,{labelValue:t,groupLabelValue:o})}function G(e){const l=D.componentList.find((e=>"business_label"===e.propertyKey));l.value=(null===e||void 0===e?void 0:e.value)??[],l.labelText=(null===e||void 0===e?void 0:e.labelText)??[]}function H(){D.componentList=[],x.visible=!1}function Y(e,l,a){x.type=l,x.visible=e,N.value=a,e&&z()}return l({trigger:Y}),(e,l)=>{const a=(0,t.g2)("el-button"),p=(0,t.g2)("el-input"),r=(0,t.g2)("el-form-item"),L=(0,t.g2)("el-option"),X=(0,t.g2)("el-select"),F=(0,t.g2)("el-input-number"),E=(0,t.g2)("el-radio"),I=(0,t.g2)("el-radio-group"),T=(0,t.g2)("el-checkbox"),N=(0,t.g2)("el-checkbox-group"),B=(0,t.g2)("CustomUpload"),S=(0,t.g2)("el-cascader"),$=(0,t.g2)("el-form"),z=(0,t.g2)("el-drawer");return(0,t.uX)(),(0,t.CE)(t.FK,null,[(0,t.bF)(z,{modelValue:x.visible,"onUpdate:modelValue":l[1]||(l[1]=e=>x.visible=e),class:"custom-drawer",title:"业务报备",size:"700",onClose:H},{footer:(0,t.k6)((()=>[(0,t.bF)(a,{onClick:H},{default:(0,t.k6)((()=>l[5]||(l[5]=[(0,t.eW)("取消")]))),_:1}),(0,t.bF)(a,{type:"primary",onClick:O},{default:(0,t.k6)((()=>l[6]||(l[6]=[(0,t.eW)("提交")]))),_:1})])),default:(0,t.k6)((()=>[D.componentList.length?((0,t.uX)(),(0,t.Wv)($,{key:0,ref_key:"ruleFormRef",ref:U,model:D,"label-width":"100px","label-position":"top"},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(D.componentList,((e,V)=>((0,t.uX)(),(0,t.CE)("div",{key:e.id},[1===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:0,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>["business_label"===e.propertyKey?((0,t.uX)(),(0,t.CE)("div",n,[(0,t.bF)(a,{type:"primary",onClick:l=>A(e,V)},{default:(0,t.k6)((()=>l[2]||(l[2]=[(0,t.eW)("添加 ")]))),_:2},1032,["onClick"]),(0,t.Lk)("div",d,[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.labelText,((e,l)=>((0,t.uX)(),(0,t.CE)("span",{key:l},(0,o.v_)(e),1)))),128))])])):((0,t.uX)(),(0,t.Wv)(p,{key:1,modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,modelModifiers:{trim:!0},placeholder:e.placeholder,disabled:e.inputDisabled},(0,t.eX)({_:2},[e.unit?{name:"append",fn:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.unit),1)])),key:"0"}:void 0]),1032,["modelValue","onUpdate:modelValue","placeholder","disabled"])),e.remark?((0,t.uX)(),(0,t.CE)("p",s,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),2===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:1,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>["verbal_trick"===e.propertyKey?((0,t.uX)(),(0,t.CE)(t.FK,{key:0},[(0,t.bF)(X,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,placeholder:e.placeholder},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(Q.value,(e=>((0,t.uX)(),(0,t.Wv)(L,{key:e.id,label:e.title,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),(0,t.bF)(a,{type:"primary",style:{"margin-left":"10px"},onClick:l[0]||(l[0]=e=>R("add",{}))},{default:(0,t.k6)((()=>l[3]||(l[3]=[(0,t.eW)("添加 ")]))),_:1})],64)):((0,t.uX)(),(0,t.Wv)(p,{key:1,type:"textarea",rows:3,maxlength:e.maxLength,"show-word-limit":"",modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,modelModifiers:{trim:!0},placeholder:e.placeholder},null,8,["maxlength","modelValue","onUpdate:modelValue","placeholder"])),e.remark?((0,t.uX)(),(0,t.CE)("p",m,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),7===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:2,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.Lk)("div",c,[(0,t.bF)(F,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,precision:2,min:.01,max:9999999999,label:"描述文字"},null,8,["modelValue","onUpdate:modelValue"]),(0,t.Lk)("span",null,(0,o.v_)(e.unit),1)]),e.remark?((0,t.uX)(),(0,t.CE)("p",v,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),4===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:3,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.bF)(I,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,((e,l)=>((0,t.uX)(),(0,t.Wv)(E,{value:e.id,key:l},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.value),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),e.remark?((0,t.uX)(),(0,t.CE)("p",y,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),11===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:4,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.bF)(X,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,filterable:"",placeholder:e.placeholder},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,(e=>((0,t.uX)(),(0,t.Wv)(L,{key:e.id,label:e.value,value:e.id},null,8,["label","value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue","placeholder"]),e.remark?((0,t.uX)(),(0,t.CE)("p",k,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),5===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:5,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.bF)(N,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,((e,l)=>((0,t.uX)(),(0,t.Wv)(T,{value:e.id,key:l},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(e.value),1)])),_:2},1032,["value"])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),e.remark?((0,t.uX)(),(0,t.CE)("p",b,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),12===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:6,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.bF)(N,{modelValue:e.value,"onUpdate:modelValue":l=>e.value=l},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(e.optionBOList,((l,a)=>((0,t.uX)(),(0,t.CE)("div",{style:{display:"flex","margin-bottom":"20px"},key:a},[(0,t.bF)(T,{style:{width:"100px"},value:l.id},{default:(0,t.k6)((()=>[(0,t.eW)((0,o.v_)(l.value),1)])),_:2},1032,["value"]),(0,t.bF)(r,{prop:"componentList."+V+".optionBOList."+a+".value2",rules:[{validator:(l,t,o)=>{j(t,o,a,e)}}]},{default:(0,t.k6)((()=>[(0,t.bF)(p,{disabled:!e.value.includes(l.id),modelValue:l.value2,"onUpdate:modelValue":e=>l.value2=e,placeholder:l.placeholder},null,8,["disabled","modelValue","onUpdate:modelValue","placeholder"])])),_:2},1032,["prop","rules"])])))),128))])),_:2},1032,["modelValue","onUpdate:modelValue"]),e.remark?((0,t.uX)(),(0,t.CE)("p",f,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),9===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:7,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.bF)(B,{"show-word-limit":"10","list-type":"text",accept:"*",defaultFileList:e.fileList,"onUpdate:defaultFileList":l=>e.fileList=l,editData:e,maxVolume:20,limit:e.fileLimit,onEmitUpload:J},null,8,["defaultFileList","onUpdate:defaultFileList","editData","limit"]),e.templateBOList&&e.templateBOList.length?((0,t.uX)(),(0,t.Wv)(a,{key:0,onClick:l=>(0,u.R1)(i.t$)(e.templateBOList[0].fileUrl)},{default:(0,t.k6)((()=>l[4]||(l[4]=[(0,t.eW)("下载模板 ")]))),_:2},1032,["onClick"])):(0,t.Q3)("",!0),e.remark?((0,t.uX)(),(0,t.CE)("p",g,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),13===e.propertyType?((0,t.uX)(),(0,t.Wv)(r,{key:8,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.bF)(B,{"show-word-limit":"10","list-type":"picture-card",defaultFileList:e.fileList,"onUpdate:defaultFileList":l=>e.fileList=l,editData:e,maxVolume:20,limit:e.fileLimit,onEmitUpload:J},null,8,["defaultFileList","onUpdate:defaultFileList","editData","limit"]),e.remark?((0,t.uX)(),(0,t.CE)("p",_,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0),"industry"===e.propertyKey?((0,t.uX)(),(0,t.Wv)(r,{key:9,label:e.tagName,prop:"componentList."+V+".value",rules:M(e)},{default:(0,t.k6)((()=>[(0,t.bF)(S,{style:{width:"100%"},modelValue:e.value,"onUpdate:modelValue":l=>e.value=l,emitPath:!0,filterable:"",clearable:"",placeholder:"请选择",props:{value:"id",label:"name",children:"children",checkStrictly:!1},options:w.value,disabled:e.inputDisabled},null,8,["modelValue","onUpdate:modelValue","options","disabled"]),e.remark?((0,t.uX)(),(0,t.CE)("p",h,(0,o.v_)(e.remark),1)):(0,t.Q3)("",!0)])),_:2},1032,["label","prop","rules"])):(0,t.Q3)("",!0)])))),128))])),_:1},8,["model"])):(0,t.Q3)("",!0)])),_:1},8,["modelValue"]),(0,t.bF)((0,u.R1)(C),{ref_key:"addEditSpeechLibraryRef",ref:W,onEmitFunc:q},null,512),(0,t.bF)((0,u.R1)(V),{ref_key:"businessLabelRef",ref:K,onEmitFunc:G},null,512)],64)}}}),V=a(83936);const C=(0,V.A)(L,[["__scopeId","data-v-7f26c80a"]]);var X=C}}]);
//# sourceMappingURL=3677.baf028ab.js.map