"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[7642],{21884:function(e,u,a){a.r(u),a.d(u,{default:function(){return y}});a(95226),a(59784),a(47961),a(70549),a(83238);var l=a(6254),s=a(38627),i=a(25598),t=a(10901),n=a(88365),c=a(4710),o=a(8610),m=a(64108),r=a(51409),d=a(99821),v=a(59259);const p={class:"product-detail"},f={class:"service-specs"},N={class:"word"},b="CALL_CENTER_ADDED";var L=(0,l.pM)({__name:"cloud-call-soft",props:{tagList:{},productData:{},purchasedData:{}},setup(e){const u=(0,i.KR)(),{routeQuery:a}=(0,t.dG)(),{bd_userInfo:L}=n.DT.batchGetItem(["bd_userInfo"]),g=e,y=(0,l.EW)((()=>g.productData)),C=(0,l.EW)((()=>y.value.serviceInfo)),I=(0,l.EW)((()=>{var e;return null===(e=y.value)||void 0===e?void 0:e.addedServiceList.find((e=>e.addedServiceCode===b))})),S=(0,l.EW)((()=>x("cycle",0))),h=(0,l.EW)((()=>"custom"===E.seatNum?E.seatCustomNum:E.seatNum)),k=(0,l.EW)((()=>{var e;const u=Number(P.value.addedPrice)?`+ 附赠产品${P.value.addedPrice}元`:"";return null!==(e=y.value)&&void 0!==e&&e.canBuy?`合计： 坐席单价${P.value.unitPrice}元 x\n            ${h.value}个坐席 x ${E.cycle}个月${u} = ${P.value.sumPrice}元`:""})),x=(e,u)=>{var a;const l=[],s=null===(a=I.value)||void 0===a?void 0:a.specsList;return(0,n.TC)(s)?(s.forEach((e=>{const a=e.groupNames.split(","),s=e.groupValues.split(","),i=e.groupCodes.split(","),t={minNum:e.minNum,maxNum:e.maxNum,coding:e.coding,serviceCode:e.serviceCode,groupNameList:a,groupValueList:s,groupCodeList:i},n=l.find((e=>e.value===s[u]));n?n.specs.push(t):l.push({value:s[u],label:a[u],specs:[t]})})),l.sort(((e,u)=>e.value-u.value))):l},E=(0,i.Kh)({scenariosLabel:g.tagList.map((e=>e.tagName)),scenariosList:g.tagList,cycle:"0",seatNum:"",seatCustomNum:0,minSeatNum:1,maxSeatNum:1e7,cycleList:[],seatList:[],curSpecsInfo:{}}),P=(0,i.IJ)({price:"0.00",sumPrice:"0.00",addedPrice:"0.00",unitPrice:"0.00",subMarketList:[]});function V(e,u){E[u]=e;const a=E[`${u}List`].findIndex((u=>u.value===e));F(-1===a?0:a)}function F(e=0){if(!S.value.length)return;E.cycleList=S.value;const u=E.cycleList[e];E.cycle=(null===u||void 0===u?void 0:u.value)??"",_(u)}function _(e){var u;const a=e.specs[0];E.seatNum=null===a||void 0===a?void 0:a.minNum,E.seatCustomNum=null===a||void 0===a?void 0:a.minNum,E.minSeatNum=null===a||void 0===a?void 0:a.minNum,E.maxSeatNum=null===a||void 0===a?void 0:a.maxNum,E.seatList=e.specs.map((e=>(E.minSeatNum>e.minNum&&(E.minSeatNum=e.minNum),E.maxSeatNum<e.maxNum&&(E.maxSeatNum=e.maxNum),{label:`${e.minNum}个`,value:e.minNum,minNum:e.minNum,maxNum:e.maxNum}))),null!==(u=I.value)&&void 0!==u&&u.isDiy&&E.seatList.push({label:"自定义",value:"custom"}),E.curSpecsInfo=a,T()}function $(e){let u=e;"custom"===e&&(u=E.seatCustomNum);const a=E.cycleList.find((e=>e.value===E.cycle));E.curSpecsInfo=a.specs.find((e=>e.minNum<=u&&u<=e.maxNum)),T()}function A(){const e=E.scenariosList.map((e=>({id:e.id,pid:e.pid,name:e.tagName||e.name})));u.value.trigger(!0,e)}function D(e){const{list:u=[],label:a=[]}=e;E.scenariosList=u,E.scenariosLabel=a}function W(){var e;const u=E.scenariosList.map((e=>({id:e.id,name:e.name}))),l={helpOrder:1,agentId:L.profileId,companyId:a.value.companyId,profileId:a.value.profileId,buyType:"BUY_SERVER",businessTagsInfo:JSON.stringify(u),shopBuyList:[{agentId:L.profileId,isisTry:!1,dateType:"2",dateValue:E.cycle,marketCode:a.value.serviceCode,userNumber:h.value,coding:[{code:E.curSpecsInfo.serviceCode,coding:E.curSpecsInfo.coding,num:h.value}],baseCodeList:E.curSpecsInfo.groupCodeList.map(((e,u)=>({baseCode:e,number:E.curSpecsInfo.groupValueList[u]})))}],sumPrice:P.value.sumPrice},s={list:[{...C.value,price:P.value.price,specsInfo:`坐席数量：${h.value}个；合作时间：${E.cycle}个月；坐席单价：${P.value.unitPrice}元；`,augmentedServiceList:null===(e=P.value)||void 0===e?void 0:e.subMarketList.map((e=>("1"===e.calculateType&&(e.specsInfo=`${E.cycle}个月`),e)))}],sumPrice:P.value.sumPrice};return{params:l,commodityInfo:s}}async function T(){const e=W().params;P.value=await(0,c.AV)(e)}function w(){E.scenariosList&&E.scenariosList.length?(0,c.$d)(W()):v.nk.warning("请选择业务场景!")}return F(),(e,a)=>{var i;const t=(0,l.g2)("el-input"),n=(0,l.g2)("el-form-item"),c=(0,l.g2)("el-option"),v=(0,l.g2)("el-select"),b=(0,l.g2)("el-input-number"),L=(0,l.g2)("el-form");return(0,l.uX)(),(0,l.CE)(l.FK,null,[(0,l.Lk)("div",p,[(0,l.bF)(m.A,{serviceData:C.value},null,8,["serviceData"]),(0,l.Lk)("div",f,[(0,l.bF)(L,{"label-width":"150px"},{default:(0,l.k6)((()=>[(0,l.bF)(n,{label:"业务场景"},{default:(0,l.k6)((()=>[(0,l.bF)(t,{readonly:"",modelValue:E.scenariosLabel,"onUpdate:modelValue":a[0]||(a[0]=e=>E.scenariosLabel=e),onClick:A},null,8,["modelValue"])])),_:1}),(0,l.bF)(n,{label:"软件周期"},{default:(0,l.k6)((()=>[(0,l.bF)(r.A,{list:E.cycleList,"model-value":E.cycle,"onUpdate:modelValue":a[1]||(a[1]=e=>V(e,"cycle")),minWidth:"95px"},null,8,["list","model-value"])])),_:1}),(0,l.bF)(n,{label:"购买坐席数",class:"amount-form-item"},{default:(0,l.k6)((()=>[(0,l.bF)(v,{modelValue:E.seatNum,"onUpdate:modelValue":a[2]||(a[2]=e=>E.seatNum=e),onChange:$},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(E.seatList,(e=>((0,l.uX)(),(0,l.Wv)(c,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"]),"custom"===E.seatNum?((0,l.uX)(),(0,l.Wv)(b,{key:0,modelValue:E.seatCustomNum,"onUpdate:modelValue":a[3]||(a[3]=e=>E.seatCustomNum=e),min:E.minSeatNum,max:E.maxSeatNum,step:I.value.miniNum,onChange:$},null,8,["modelValue","min","max","step"])):(0,l.Q3)("",!0)])),_:1}),(0,l.bF)(n,null,{default:(0,l.k6)((()=>[(0,l.Lk)("p",N,(0,s.v_)(k.value),1)])),_:1})])),_:1}),(0,l.bF)(o.A,{onEmitFunc:w,"buy-price":P.value.sumPrice,"can-buy":null===(i=y.value)||void 0===i?void 0:i.canBuy,hasAgentPrice:P.value.hasAgentPrice},null,8,["buy-price","can-buy","hasAgentPrice"])])]),(0,l.bF)(d.A,{ref_key:"scenariosRef",ref:u,onEmitFunc:D},null,512)],64)}}});const g=L;var y=g}}]);
//# sourceMappingURL=7642.c26b1ad7.js.map