{"version":3,"file":"static/js/1881.7e5b0614.js","mappings":"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","sources":["webpack://daili/./src/components/order-management/create-order/product-detail/video-matrix.vue?8a7d","webpack://daili/./src/components/order-management/create-order/product-detail/video-matrix.vue","webpack://daili/./src/components/order-management/create-order/product-detail/video-matrix.vue?5d9c"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { createVNode as _createVNode, unref as _unref, renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, withCtx as _withCtx, toDisplayString as _toDisplayString, createElementVNode as _createElementVNode } from \"vue\"\n\nconst _hoisted_1 = { class: \"product-detail\" }\nconst _hoisted_2 = { class: \"service-specs\" }\nconst _hoisted_3 = { class: \"word\" }\n\nimport { computed, shallowReactive, shallowRef } from \"vue\";\r\n\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport { createdOrder, handlePrice } from \"./common\";\r\n\r\nimport BaseSumPrice from \"./base-sum-price.vue\";\r\nimport BaseServiceInfo from \"./base-service-info.vue\";\r\nimport { arrayHasValue } from \"jz-tool-lib\";\r\n\r\nconst addedServiceCode = \"VIDEO_MATRIX_ACCOUNT_QUANTITY\";\r\ntype InitData = {\r\n  accountNum: string | number;\r\n  cycleNum: string | number;\r\n  accountList: Record<string, any>[];\r\n  cycleList: Record<string, any>[];\r\n  curSpecsInfo: Record<string, any>;\r\n};\r\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'video-matrix',\n  props: {\n    productData: {},\n    purchasedData: {}\n  },\n  setup(__props: any) {\n\r\nconst props = __props;\r\nconst { routeQuery } = useVueRouter();\r\nconst { bd_userInfo: userInfo } = LocalStorage.batchGetItem([\"bd_userInfo\"]);\r\n\r\nconst initData = shallowReactive<InitData>({\r\n  accountNum: \"\",\r\n  cycleNum: 1,\r\n  accountList: [], // 授权账号数列表\r\n  cycleList: [\r\n    { label: \"1年期\", value: 1 },\r\n    { label: \"2年期\", value: 2 },\r\n  ], // 合作期限列表\r\n  curSpecsInfo: {}, // 选择当前规格\r\n});\r\n\r\n// 购买的商品价格信息\r\nconst agentInfo = shallowRef({\r\n  price: \"0.00\",\r\n  sumPrice: \"0.00\",\r\n  addedPrice: \"0.00\",\r\n  unitPrice: \"0.00\",\r\n  subMarketList: [],\r\n  hasAgentPrice: false,\r\n});\r\n\r\n// 所有信息\r\nconst productInfo: Record<string, any> = computed(() => {\r\n  return props.productData;\r\n});\r\n// 服务基本信息\r\nconst serviceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value.serviceInfo;\r\n});\r\n// 增值服务信息\r\nconst addedServiceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value?.addedServiceList.find(\r\n    (item) => item.addedServiceCode === addedServiceCode\r\n  );\r\n});\r\n\r\n// 提示\r\nconst tipDesc = computed(() => {\r\n  if (productInfo.value.canBuy) {\r\n    return `合计：账号单价${agentInfo.value.unitPrice}元 x 账号数${initData.accountNum}个 x ${initData.cycleNum}年期 = ${agentInfo.value.sumPrice}元`;\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n\r\n// 授权账号数据列表\r\nconst accountList = computed(() => {\r\n  return handleAccountList();\r\n});\r\n\r\n// 获取授权账号数据处理\r\nconst handleAccountList = () => {\r\n  const list: any[] = [];\r\n  const specsList = addedServiceInfo.value?.specsList;\r\n  if (!arrayHasValue(specsList)) return list;\r\n  specsList.forEach((item) => {\r\n    const specsValue = {\r\n      coding: item.coding,\r\n      serviceCode: item.serviceCode,\r\n      groupNames: item.groupNames,\r\n      groupValues: item.groupValues,\r\n      groupCodes: item.groupCodes,\r\n    };\r\n    const info = list.find((sonItem: Record<string, any>) => {\r\n      return sonItem.value === item.groupValues;\r\n    });\r\n    if (!info) {\r\n      list.push({\r\n        value: item.groupValues,\r\n        label: item.groupNames,\r\n        specs: specsValue,\r\n      });\r\n    } else {\r\n      info.specs.push(specsValue);\r\n    }\r\n  });\r\n  return list.sort((a, b) => {\r\n    return a.value - b.value;\r\n  });\r\n};\r\n\r\n// 设置默认套餐授权账号\r\nfunction initList(curIndex) {\r\n  if (!accountList.value.length) return;\r\n  initData.accountList = accountList.value;\r\n  const accountInfo = initData.accountList[curIndex];\r\n  initData.accountNum = accountInfo?.value ?? \"\";\r\n  initData.curSpecsInfo = accountInfo.specs;\r\n  getPrice();\r\n}\r\n\r\n// 授权账号数量切换\r\nconst changeAccountCount = (number: string) => {\r\n  const index = initData.accountList.findIndex((i) => i.value === number);\r\n  initData.curSpecsInfo = initData.accountList[index].specs;\r\n  getPrice();\r\n};\r\n\r\n// 合作期限切换\r\nconst changeCycleCount = () => {\r\n  getPrice();\r\n};\r\n\r\n// 获取价格参数\r\nfunction handleParams() {\r\n  const params = {\r\n    helpOrder: 1, // 是否代客下单0：否，1：是\r\n    agentId: userInfo.profileId, // 代理商id\r\n    companyId: routeQuery.value.companyId, // 代理商子公司id\r\n    profileId: routeQuery.value.profileId, // 代理商子公司操作人id\r\n    buyType: \"BUY_SERVER\", // 购买：BUY_SERVER,升级：UPGRADE,续费：RENEW\r\n    shopBuyList: [\r\n      {\r\n        agentId: userInfo.profileId,\r\n        isisTry: false, // 是否试用\r\n        dateType: \"3\", // 时间单位 1:日, 2:月, 3:年\r\n        dateValue: initData.cycleNum, // 合作期限\r\n        marketCode: routeQuery.value.serviceCode,\r\n        userNumber: initData.accountNum, // 授权账号数量\r\n        coding: [\r\n          {\r\n            code: initData.curSpecsInfo.serviceCode,\r\n            coding: initData.curSpecsInfo.coding,\r\n            num: initData.accountNum,\r\n          },\r\n        ],\r\n        baseCodeList: [\r\n          {\r\n            baseCode: initData.curSpecsInfo.groupCodes,\r\n            number: initData.curSpecsInfo.groupValues,\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.sumPrice,\r\n  };\r\n  const commodityInfo = {\r\n    list: [\r\n      {\r\n        ...serviceInfo.value,\r\n        price: agentInfo.value.price,\r\n        specsInfo: `服务周期：${initData.cycleNum}年；视频矩阵数量：${initData.accountNum}个；`,\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.sumPrice,\r\n  };\r\n  return {\r\n    params,\r\n    commodityInfo,\r\n  };\r\n}\r\n\r\n// 计算价格\r\nconst getPrice = async () => {\r\n  const params = handleParams().params;\r\n  agentInfo.value = await handlePrice(params);\r\n};\r\n\r\n// 购买\r\nconst handleBuy = () => {\r\n  createdOrder(handleParams());\r\n};\r\n\r\n// 初始化信息\r\ninitList(0);\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_option = _resolveComponent(\"el-option\")!\n  const _component_el_select = _resolveComponent(\"el-select\")!\n  const _component_el_form_item = _resolveComponent(\"el-form-item\")!\n  const _component_el_form = _resolveComponent(\"el-form\")!\n\n  return (_openBlock(), _createElementBlock(\"div\", _hoisted_1, [\n    _createVNode(BaseServiceInfo, { serviceData: serviceInfo.value }, null, 8, [\"serviceData\"]),\n    _createElementVNode(\"div\", _hoisted_2, [\n      _createVNode(_component_el_form, { \"label-width\": \"150px\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_el_form_item, { label: \"授权账号数\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_select, {\n                modelValue: _unref(initData).accountNum,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((_unref(initData).accountNum) = $event)),\n                onChange: changeAccountCount\n              }, {\n                default: _withCtx(() => [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(initData).accountList, (item) => {\n                    return (_openBlock(), _createBlock(_component_el_option, {\n                      key: item.value,\n                      label: item.label,\n                      value: item.value\n                    }, null, 8, [\"label\", \"value\"]))\n                  }), 128))\n                ]),\n                _: 1\n              }, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"合作期限\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_select, {\n                modelValue: _unref(initData).cycleNum,\n                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((_unref(initData).cycleNum) = $event)),\n                onChange: changeCycleCount\n              }, {\n                default: _withCtx(() => [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(_unref(initData).cycleList, (item) => {\n                    return (_openBlock(), _createBlock(_component_el_option, {\n                      key: item.value,\n                      label: item.label,\n                      value: item.value\n                    }, null, 8, [\"label\", \"value\"]))\n                  }), 128))\n                ]),\n                _: 1\n              }, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, null, {\n            default: _withCtx(() => [\n              _createElementVNode(\"p\", _hoisted_3, _toDisplayString(tipDesc.value), 1)\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      }),\n      _createVNode(BaseSumPrice, {\n        onEmitFunc: handleBuy,\n        \"buy-price\": agentInfo.value.sumPrice,\n        \"can-buy\": productInfo.value?.canBuy,\n        hasAgentPrice: agentInfo.value.hasAgentPrice\n      }, null, 8, [\"buy-price\", \"can-buy\", \"hasAgentPrice\"])\n    ])\n  ]))\n}\n}\n\n})","<template>\r\n  <div class=\"product-detail\">\r\n    <BaseServiceInfo :serviceData=\"serviceInfo\"></BaseServiceInfo>\r\n    <div class=\"service-specs\">\r\n      <el-form label-width=\"150px\">\r\n        <el-form-item label=\"授权账号数\">\r\n          <el-select v-model=\"initData.accountNum\" @change=\"changeAccountCount\">\r\n            <el-option\r\n              v-for=\"item in initData.accountList\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.value\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item label=\"合作期限\">\r\n          <el-select v-model=\"initData.cycleNum\" @change=\"changeCycleCount\">\r\n            <el-option\r\n              v-for=\"item in initData.cycleList\"\r\n              :key=\"item.value\"\r\n              :label=\"item.label\"\r\n              :value=\"item.value\"\r\n            />\r\n          </el-select>\r\n        </el-form-item>\r\n        <el-form-item>\r\n          <p class=\"word\">{{ tipDesc }}</p>\r\n        </el-form-item>\r\n      </el-form>\r\n      <BaseSumPrice\r\n        @emitFunc=\"handleBuy\"\r\n        :buy-price=\"agentInfo.sumPrice\"\r\n        :can-buy=\"productInfo?.canBuy\"\r\n        :hasAgentPrice=\"agentInfo.hasAgentPrice\"\r\n      ></BaseSumPrice>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport { computed, shallowReactive, shallowRef } from \"vue\";\r\n\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport { createdOrder, handlePrice } from \"./common\";\r\n\r\nimport BaseSumPrice from \"./base-sum-price.vue\";\r\nimport BaseServiceInfo from \"./base-service-info.vue\";\r\nimport { arrayHasValue } from \"jz-tool-lib\";\r\n\r\nconst props = defineProps<{\r\n  productData: Record<string, any>;\r\n  purchasedData: Record<string, any>[];\r\n}>();\r\nconst { routeQuery } = useVueRouter();\r\nconst addedServiceCode = \"VIDEO_MATRIX_ACCOUNT_QUANTITY\";\r\nconst { bd_userInfo: userInfo } = LocalStorage.batchGetItem([\"bd_userInfo\"]);\r\n\r\ntype InitData = {\r\n  accountNum: string | number;\r\n  cycleNum: string | number;\r\n  accountList: Record<string, any>[];\r\n  cycleList: Record<string, any>[];\r\n  curSpecsInfo: Record<string, any>;\r\n};\r\nconst initData = shallowReactive<InitData>({\r\n  accountNum: \"\",\r\n  cycleNum: 1,\r\n  accountList: [], // 授权账号数列表\r\n  cycleList: [\r\n    { label: \"1年期\", value: 1 },\r\n    { label: \"2年期\", value: 2 },\r\n  ], // 合作期限列表\r\n  curSpecsInfo: {}, // 选择当前规格\r\n});\r\n\r\n// 购买的商品价格信息\r\nconst agentInfo = shallowRef({\r\n  price: \"0.00\",\r\n  sumPrice: \"0.00\",\r\n  addedPrice: \"0.00\",\r\n  unitPrice: \"0.00\",\r\n  subMarketList: [],\r\n  hasAgentPrice: false,\r\n});\r\n\r\n// 所有信息\r\nconst productInfo: Record<string, any> = computed(() => {\r\n  return props.productData;\r\n});\r\n// 服务基本信息\r\nconst serviceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value.serviceInfo;\r\n});\r\n// 增值服务信息\r\nconst addedServiceInfo: Record<string, any> = computed(() => {\r\n  return productInfo.value?.addedServiceList.find(\r\n    (item) => item.addedServiceCode === addedServiceCode\r\n  );\r\n});\r\n\r\n// 提示\r\nconst tipDesc = computed(() => {\r\n  if (productInfo.value.canBuy) {\r\n    return `合计：账号单价${agentInfo.value.unitPrice}元 x 账号数${initData.accountNum}个 x ${initData.cycleNum}年期 = ${agentInfo.value.sumPrice}元`;\r\n  } else {\r\n    return \"\";\r\n  }\r\n});\r\n\r\n// 授权账号数据列表\r\nconst accountList = computed(() => {\r\n  return handleAccountList();\r\n});\r\n\r\n// 获取授权账号数据处理\r\nconst handleAccountList = () => {\r\n  const list: any[] = [];\r\n  const specsList = addedServiceInfo.value?.specsList;\r\n  if (!arrayHasValue(specsList)) return list;\r\n  specsList.forEach((item) => {\r\n    const specsValue = {\r\n      coding: item.coding,\r\n      serviceCode: item.serviceCode,\r\n      groupNames: item.groupNames,\r\n      groupValues: item.groupValues,\r\n      groupCodes: item.groupCodes,\r\n    };\r\n    const info = list.find((sonItem: Record<string, any>) => {\r\n      return sonItem.value === item.groupValues;\r\n    });\r\n    if (!info) {\r\n      list.push({\r\n        value: item.groupValues,\r\n        label: item.groupNames,\r\n        specs: specsValue,\r\n      });\r\n    } else {\r\n      info.specs.push(specsValue);\r\n    }\r\n  });\r\n  return list.sort((a, b) => {\r\n    return a.value - b.value;\r\n  });\r\n};\r\n\r\n// 设置默认套餐授权账号\r\nfunction initList(curIndex) {\r\n  if (!accountList.value.length) return;\r\n  initData.accountList = accountList.value;\r\n  const accountInfo = initData.accountList[curIndex];\r\n  initData.accountNum = accountInfo?.value ?? \"\";\r\n  initData.curSpecsInfo = accountInfo.specs;\r\n  getPrice();\r\n}\r\n\r\n// 授权账号数量切换\r\nconst changeAccountCount = (number: string) => {\r\n  const index = initData.accountList.findIndex((i) => i.value === number);\r\n  initData.curSpecsInfo = initData.accountList[index].specs;\r\n  getPrice();\r\n};\r\n\r\n// 合作期限切换\r\nconst changeCycleCount = () => {\r\n  getPrice();\r\n};\r\n\r\n// 获取价格参数\r\nfunction handleParams() {\r\n  const params = {\r\n    helpOrder: 1, // 是否代客下单0：否，1：是\r\n    agentId: userInfo.profileId, // 代理商id\r\n    companyId: routeQuery.value.companyId, // 代理商子公司id\r\n    profileId: routeQuery.value.profileId, // 代理商子公司操作人id\r\n    buyType: \"BUY_SERVER\", // 购买：BUY_SERVER,升级：UPGRADE,续费：RENEW\r\n    shopBuyList: [\r\n      {\r\n        agentId: userInfo.profileId,\r\n        isisTry: false, // 是否试用\r\n        dateType: \"3\", // 时间单位 1:日, 2:月, 3:年\r\n        dateValue: initData.cycleNum, // 合作期限\r\n        marketCode: routeQuery.value.serviceCode,\r\n        userNumber: initData.accountNum, // 授权账号数量\r\n        coding: [\r\n          {\r\n            code: initData.curSpecsInfo.serviceCode,\r\n            coding: initData.curSpecsInfo.coding,\r\n            num: initData.accountNum,\r\n          },\r\n        ],\r\n        baseCodeList: [\r\n          {\r\n            baseCode: initData.curSpecsInfo.groupCodes,\r\n            number: initData.curSpecsInfo.groupValues,\r\n          },\r\n        ],\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.sumPrice,\r\n  };\r\n  const commodityInfo = {\r\n    list: [\r\n      {\r\n        ...serviceInfo.value,\r\n        price: agentInfo.value.price,\r\n        specsInfo: `服务周期：${initData.cycleNum}年；视频矩阵数量：${initData.accountNum}个；`,\r\n      },\r\n    ],\r\n    sumPrice: agentInfo.value.sumPrice,\r\n  };\r\n  return {\r\n    params,\r\n    commodityInfo,\r\n  };\r\n}\r\n\r\n// 计算价格\r\nconst getPrice = async () => {\r\n  const params = handleParams().params;\r\n  agentInfo.value = await handlePrice(params);\r\n};\r\n\r\n// 购买\r\nconst handleBuy = () => {\r\n  createdOrder(handleParams());\r\n};\r\n\r\n// 初始化信息\r\ninitList(0);\r\n</script>\r\n","import script from \"./video-matrix.vue?vue&type=script&setup=true&lang=ts\"\nexport * from \"./video-matrix.vue?vue&type=script&setup=true&lang=ts\"\n\nconst __exports__ = script;\n\nexport default __exports__"],"names":["_hoisted_1","class","_hoisted_2","_hoisted_3","addedServiceCode","_defineComponent","__name","props","productData","purchasedData","setup","__props","routeQuery","useVueRouter","bd_userInfo","userInfo","LocalStorage","batchGetItem","initData","shallowReactive","accountNum","cycleNum","accountList","cycleList","label","value","curSpecsInfo","agentInfo","shallowRef","price","sumPrice","addedPrice","unitPrice","subMarketList","hasAgentPrice","productInfo","computed","serviceInfo","addedServiceInfo","_productInfo$value","addedServiceList","find","item","tipDesc","canBuy","handleAccountList","_addedServiceInfo$val","list","specsList","arrayHasValue","forEach","specsValue","coding","serviceCode","groupNames","groupValues","groupCodes","info","sonItem","specs","push","sort","a","b","initList","curIndex","length","accountInfo","getPrice","changeAccountCount","number","index","findIndex","i","changeCycleCount","handleParams","params","helpOrder","agentId","profileId","companyId","buyType","shopBuyList","isisTry","dateType","dateValue","marketCode","userNumber","code","num","baseCodeList","baseCode","commodityInfo","specsInfo","async","handlePrice","handleBuy","createdOrder","_ctx","_cache","_productInfo$value2","_component_el_option","_resolveComponent","_component_el_select","_component_el_form_item","_component_el_form","_openBlock","_createElementBlock","_createVNode","BaseServiceInfo","serviceData","_createElementVNode","default","_withCtx","modelValue","_unref","$event","onChange","_Fragment","_renderList","_createBlock","key","_","_toDisplayString","BaseSumPrice","onEmitFunc","__exports__"],"sourceRoot":""}