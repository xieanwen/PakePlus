"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[9439],{89439:function(e,a,l){l.r(a),l.d(a,{default:function(){return p}});l(59784),l(47961);var t=l(6254),n=l(25598),o=l(88365),u=l(10901),i=l(63148),c=l(59259),d=(0,t.pM)({__name:"configure-package-dialog",props:{visible:{type:Boolean}},emits:["update:visible","emitFunc"],setup(e,{emit:a}){const l=o.DT.getItem("bd_agentId"),{routeQuery:d}=(0,u.dG)(),r=o.DT.getItem("bd_userInfo"),s=a,p=(0,n.Kh)({cycle:2,cycleList:[{label:"业务月",value:1},{label:"自然月",value:2}],startTime:"",menu:"",cooperationPeriod:1,packages:[],packageId:"",timeList:[],packageMinutes:0,minutes:""}),m=e=>{/^\d*$/.test(e)||(p.cooperationPeriod=e.replace(/[^\d]/g,""))},g=()=>{s("update:visible",!1),p.startTime="",p.menu="",p.cooperationPeriod=1,p.cycle=2},b=e=>{p.packageId=e;const a=p.packages.find((a=>a.id===e));a&&(p.minutes=a.packageMinutes)},k=()=>{y(),v()},f=()=>{if(!p.menu)return c.nk.warning("套餐名称不能为空！"),!1;p.startTime||c.nk.warning("请选择套餐开始时间！");const e={agencyId:l,cycleType:p.cycle,packageId:p.packageId,packageMinutes:p.minutes,profileId:r.profileId,profileName:r.realName,resourceStartTime:p.startTime,subCompanyCode:d.value.companyCode,subCompanyId:d.value.companyId,totalCooperationCycle:p.cooperationPeriod};i.cr.getData(e).then((e=>{0===e.statusCode?(s("emitFunc"),c.nk.success("配置套餐成功"),g()):c.nk.warning(e.msg||"配置套餐失败")}))},y=async()=>{const e={agencyId:l};await i.Np.getData(e).then((e=>{p.packages=e.data}))},v=async()=>{const e={agencyId:l,companyId:d.value.companyId};await i.Z4.getData(e).then((e=>{p.timeList=e.data}))},I=e=>{const a=p.timeList,l=new Date;if(l.setHours(0,0,0,0),e<l)return!0;if(!Array.isArray(p.timeList))return!1;for(let t=0;t<a.length;t++){const l=new Date(a[t].startTime),n=new Date(a[t].endTime);if(e>=l&&e<=n)return!0}return!1};return(e,a)=>{const l=(0,t.g2)("el-option"),n=(0,t.g2)("el-select"),o=(0,t.g2)("el-form-item"),u=(0,t.g2)("el-date-picker"),i=(0,t.g2)("el-input-number"),c=(0,t.g2)("el-form"),d=(0,t.g2)("el-button"),r=(0,t.g2)("el-dialog");return(0,t.uX)(),(0,t.Wv)(r,{"model-value":e.visible,title:"配置套餐",width:"500px",class:"custom-dialog","before-close":g,onOpen:k},{footer:(0,t.k6)((()=>[(0,t.bF)(d,{type:"primary",onClick:f},{default:(0,t.k6)((()=>a[5]||(a[5]=[(0,t.eW)("确 定")]))),_:1}),(0,t.bF)(d,{onClick:g},{default:(0,t.k6)((()=>a[6]||(a[6]=[(0,t.eW)("取 消")]))),_:1})])),default:(0,t.k6)((()=>[(0,t.bF)(c,{class:"package-form"},{default:(0,t.k6)((()=>[(0,t.bF)(o,{label:"套餐周期"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{modelValue:p.cycle,"onUpdate:modelValue":a[0]||(a[0]=e=>p.cycle=e)},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.cycleList,(e=>((0,t.uX)(),(0,t.Wv)(l,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"套餐开始日期"},{default:(0,t.k6)((()=>[(0,t.bF)(u,{modelValue:p.startTime,"onUpdate:modelValue":a[1]||(a[1]=e=>p.startTime=e),type:"date",placeholder:"请选择开始时间","value-format":"YYYY-MM-DD","disabled-date":I,clearable:""},null,8,["modelValue"])])),_:1}),(0,t.bF)(o,{label:"合作周期"},{default:(0,t.k6)((()=>[(0,t.bF)(i,{modelValue:p.cooperationPeriod,"onUpdate:modelValue":a[2]||(a[2]=e=>p.cooperationPeriod=e),placeholder:"请输入",onInput:m,min:1,clearable:""},null,8,["modelValue"]),a[4]||(a[4]=(0,t.Lk)("span",null,"月",-1))])),_:1}),(0,t.bF)(o,{label:"套餐选择"},{default:(0,t.k6)((()=>[(0,t.bF)(n,{modelValue:p.menu,"onUpdate:modelValue":a[3]||(a[3]=e=>p.menu=e),onChange:b},{default:(0,t.k6)((()=>[((0,t.uX)(!0),(0,t.CE)(t.FK,null,(0,t.pI)(p.packages,((e,a)=>((0,t.uX)(),(0,t.Wv)(l,{key:a,label:e.packageName,value:e.id},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})])),_:1})])),_:1},8,["model-value"])}}}),r=l(83936);const s=(0,r.A)(d,[["__scopeId","data-v-eb3ec0cc"]]);var p=s}}]);
//# sourceMappingURL=9439.58bd3fb1.js.map