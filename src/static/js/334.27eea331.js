"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[334],{74490:function(e,u,a){a.r(u),a.d(u,{default:function(){return f}});a(95226),a(59784),a(47961),a(70549),a(83238);var l=a(6254),n=a(38627),t=a(25598),o=a(4710),r=a(8610),c=a(64108),s=a(88365),i=a(10901);const d={class:"product-detail"},v={class:"service-specs"};var p=(0,l.pM)({__name:"added-recording-package",props:{productData:{},purchasedData:{}},setup(e){const{bd_userInfo:u}=s.DT.batchGetItem(["bd_userInfo"]),a=e;let p="";const m=(0,t.KR)([]),f=(0,t.Gc)({count:1,customCount:1,sumPrice:"0.00"}),b=(0,t.IJ)({price:"0.00",sumPrice:"0.00",unitPrice:0,subMarketList:[],hasAgentPrice:!1}),{routeQuery:h}=(0,i.dG)(),g=(0,l.EW)((()=>a.purchasedData)),y=(0,l.EW)((()=>a.productData)),C=(0,l.EW)((()=>y.value.serviceInfo)),k=(0,l.EW)((()=>{var e;return null===(e=y.value)||void 0===e?void 0:e.addedServiceList[0]})),I=(0,l.EW)((()=>{var e;return!g.value.length||f.count>(null===(e=g.value[0])||void 0===e?void 0:e.resourceCount)}));(0,l.wB)((()=>g.value),(e=>{e.length&&(0,l.dY)((()=>{if(m.value.length){const u=m.value.find((u=>e[0].count<u.value));f.count=u?null===u||void 0===u?void 0:u.value:e[0].count,V()}}))}),{deep:!0,immediate:!0});const E=()=>{var e;const u=[];null===(e=k.value.specsList)||void 0===e||e.forEach((e=>{if(1!==e.hidden){const a=e.groupNames.split(","),l=e.groupValues.split(",").map((e=>Number(e)));a.forEach(((e,a)=>{!u.some((e=>e.value===l[a]))&&u.push({label:e,value:l[a]})}))}})),f.count=u.length?u[0].value:1,f.customCount=k.value.miniNum||1,m.value=u,V()},_=(0,l.EW)((()=>{let e="";const u=f.count;return k.value.specsList.forEach((a=>{u==a.groupValues&&(e=a.coding)})),[{code:p,coding:e,num:u}]}));function L(){return[{baseCode:k.value.specsList[0].groupCodes,number:f.count}]}function P(){const e={agentId:u.profileId,buyCar:!1,helpOrder:1,buyType:"BUY_SERVER",companyId:h.value.companyId,profileId:h.value.profileId,shopBuyList:[{agentId:u.profileId,isisTry:!1,dateType:"3",dateValue:1,marketCode:h.value.serviceCode,userNumber:f.count,coding:_.value,baseCodeList:L()}],sumPrice:b.value.sumPrice},a={list:[{...C.value,price:b.value.price,specsInfo:`购买数量：${f.count}个月`}],sumPrice:b.value.sumPrice};return{params:e,commodityInfo:a}}async function V(){const{params:e}=P();b.value=await(0,o.AV)(e)}function D(){(0,o.$d)(P())}return(0,l.sV)((()=>{p=k.value.addedServiceCode,E()})),(e,u)=>{var a;const o=(0,l.g2)("el-form-item"),s=(0,l.g2)("el-option"),i=(0,l.g2)("el-select"),p=(0,l.g2)("el-form");return(0,l.uX)(),(0,l.CE)("div",d,[(0,l.bF)(c.A,{serviceData:C.value},null,8,["serviceData"]),(0,l.Lk)("div",v,[(0,l.bF)(p,{"label-width":"150px"},{default:(0,l.k6)((()=>{var a;return[null!==(a=y.value)&&void 0!==a&&a.canBuy&&e.purchasedData.length?((0,l.uX)(),(0,l.Wv)(o,{key:0,label:"已购详情"},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(g.value,((e,u)=>{var a;return(0,l.uX)(),(0,l.CE)("div",{class:"purchased-info",key:u},[(0,l.Lk)("span",null,"已购买："+(0,n.v_)(null===(a=g.value[0])||void 0===a?void 0:a.resourceCount)+"个月",1),(0,l.Lk)("span",null,"服务到期时间："+(0,n.v_)(e.endTime),1)])})),128))])),_:1})):(0,l.Q3)("",!0),(0,l.bF)(o,{label:"购买数量",class:"amount-form-item"},{default:(0,l.k6)((()=>[(0,l.bF)(i,{modelValue:(0,t.R1)(f).count,"onUpdate:modelValue":u[0]||(u[0]=e=>(0,t.R1)(f).count=e),onChange:V},{default:(0,l.k6)((()=>[((0,l.uX)(!0),(0,l.CE)(l.FK,null,(0,l.pI)(m.value,(e=>((0,l.uX)(),(0,l.Wv)(s,{key:e.value,label:e.label,value:e.value},null,8,["label","value"])))),128))])),_:1},8,["modelValue"])])),_:1})]})),_:1}),(0,l.bF)(r.A,{onEmitFunc:D,"buy-price":b.value.price,"can-buy":(null===(a=y.value)||void 0===a?void 0:a.canBuy)&&I.value,hasAgentPrice:""},null,8,["buy-price","can-buy"])])])}}});const m=p;var f=m}}]);
//# sourceMappingURL=334.27eea331.js.map