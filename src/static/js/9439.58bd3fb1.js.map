{"version":3,"file":"static/js/9439.58bd3fb1.js","mappings":"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","sources":["webpack://daili/./src/components/business-management/ospreyCloudCall/sub-customer/details/third-party-docking/components/configure-package-dialog.vue?fffa","webpack://daili/./src/components/business-management/ospreyCloudCall/sub-customer/details/third-party-docking/components/configure-package-dialog.vue","webpack://daili/./src/components/business-management/ospreyCloudCall/sub-customer/details/third-party-docking/components/configure-package-dialog.vue?7297"],"sourcesContent":["import { defineComponent as _defineComponent } from 'vue'\nimport { renderList as _renderList, Fragment as _Fragment, openBlock as _openBlock, createElementBlock as _createElementBlock, resolveComponent as _resolveComponent, createBlock as _createBlock, withCtx as _withCtx, createVNode as _createVNode, createElementVNode as _createElementVNode, createTextVNode as _createTextVNode } from \"vue\"\n\nimport { reactive } from \"vue\";\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport {\r\n  addResourceApi,\r\n  availablePackagesApi,\r\n  getOccupiedTimeSlotsApi,\r\n} from \"@api/ec-line-api\";\r\nimport { ElMessage } from \"element-plus\";\r\n\nexport default /*@__PURE__*/_defineComponent({\n  __name: 'configure-package-dialog',\n  props: {\n    visible: { type: Boolean }\n  },\n  emits: [\"update:visible\", \"emitFunc\"],\n  setup(__props: any, { emit: __emit }) {\n\r\nconst agentId = LocalStorage.getItem(\"bd_agentId\");\r\nconst { routeQuery } = useVueRouter();\r\nconst props = __props;\r\nconst userInfo = LocalStorage.getItem(\"bd_userInfo\");\r\nconst emits = __emit;\r\nconst formData = reactive({\r\n  cycle: 2, //默认自然月\r\n  cycleList: [\r\n    { label: \"业务月\", value: 1 },\r\n    { label: \"自然月\", value: 2 },\r\n  ],\r\n  startTime: \"\",\r\n  menu: \"\",\r\n  cooperationPeriod: 1,\r\n  packages: [],\r\n  packageId: \"\",\r\n  timeList: [],\r\n  packageMinutes: 0,\r\n  minutes: \"\",\r\n});\r\n//校验\r\nconst validateInput = (value) => {\r\n  if (!/^\\d*$/.test(value)) {\r\n    formData.cooperationPeriod = value.replace(/[^\\d]/g, \"\");\r\n  }\r\n};\r\n// 关闭弹框\r\nconst handleClose = () => {\r\n  emits(\"update:visible\", false);\r\n  formData.startTime = \"\";\r\n  formData.menu = \"\";\r\n  formData.cooperationPeriod = 1;\r\n  formData.cycle = 2;\r\n};\r\n//选中套餐id\r\nconst handlePackageChange = (value: string) => {\r\n  formData.packageId = value;\r\n  const selectedPackage = formData.packages.find((item) => item.id === value);\r\n  if (selectedPackage) {\r\n    formData.minutes = selectedPackage.packageMinutes;\r\n  }\r\n};\r\n\r\n//打开弹框\r\nconst handleOpen = () => {\r\n  handleAvailablePackages();\r\n  handleDateChange();\r\n};\r\n//提交\r\nconst handleSubmit = () => {\r\n  if (!formData.menu) {\r\n    ElMessage.warning(\"套餐名称不能为空！\");\r\n    return false;\r\n  }\r\n  if (!formData.startTime) {\r\n    ElMessage.warning(\"请选择套餐开始时间！\");\r\n  }\r\n  const params = {\r\n    agencyId: agentId,\r\n    cycleType: formData.cycle,\r\n    packageId: formData.packageId,\r\n    packageMinutes: formData.minutes,\r\n    profileId: userInfo.profileId,\r\n    profileName: userInfo.realName,\r\n    resourceStartTime: formData.startTime,\r\n    subCompanyCode: routeQuery.value.companyCode,\r\n    subCompanyId: routeQuery.value.companyId,\r\n    totalCooperationCycle: formData.cooperationPeriod,\r\n  };\r\n  addResourceApi.getData(params).then((res) => {\r\n    if (res.statusCode === 0) {\r\n      emits(\"emitFunc\");\r\n      ElMessage.success(\"配置套餐成功\");\r\n      handleClose();\r\n    } else {\r\n      ElMessage.warning(res.msg || \"配置套餐失败\");\r\n    }\r\n  });\r\n};\r\n//获取套餐\r\nconst handleAvailablePackages = async () => {\r\n  const params = {\r\n    agencyId: agentId,\r\n  };\r\n  await availablePackagesApi.getData(params).then((res) => {\r\n    formData.packages = res.data;\r\n  });\r\n};\r\n//套餐日期选择\r\nconst handleDateChange = async () => {\r\n  const params = {\r\n    agencyId: agentId,\r\n    companyId: routeQuery.value.companyId,\r\n  };\r\n  await getOccupiedTimeSlotsApi.getData(params).then((res) => {\r\n    formData.timeList = res.data;\r\n  });\r\n};\r\n//套餐禁用时间\r\nconst disabledDate = (time: Date) => {\r\n  const timeList = formData.timeList;\r\n  const today = new Date();\r\n  today.setHours(0, 0, 0, 0);\r\n  if (time < today) {\r\n    return true;\r\n  }\r\n  if (!Array.isArray(formData.timeList)) {\r\n    return false;\r\n  }\r\n  for (let i = 0; i < timeList.length; i++) {\r\n    const start = new Date(timeList[i].startTime);\r\n    const end = new Date(timeList[i].endTime);\r\n    if (time >= start && time <= end) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n\nreturn (_ctx: any,_cache: any) => {\n  const _component_el_option = _resolveComponent(\"el-option\")!\n  const _component_el_select = _resolveComponent(\"el-select\")!\n  const _component_el_form_item = _resolveComponent(\"el-form-item\")!\n  const _component_el_date_picker = _resolveComponent(\"el-date-picker\")!\n  const _component_el_input_number = _resolveComponent(\"el-input-number\")!\n  const _component_el_form = _resolveComponent(\"el-form\")!\n  const _component_el_button = _resolveComponent(\"el-button\")!\n  const _component_el_dialog = _resolveComponent(\"el-dialog\")!\n\n  return (_openBlock(), _createBlock(_component_el_dialog, {\n    \"model-value\": _ctx.visible,\n    title: \"配置套餐\",\n    width: \"500px\",\n    class: \"custom-dialog\",\n    \"before-close\": handleClose,\n    onOpen: handleOpen\n  }, {\n    footer: _withCtx(() => [\n      _createVNode(_component_el_button, {\n        type: \"primary\",\n        onClick: handleSubmit\n      }, {\n        default: _withCtx(() => _cache[5] || (_cache[5] = [\n          _createTextVNode(\"确 定\")\n        ])),\n        _: 1\n      }),\n      _createVNode(_component_el_button, { onClick: handleClose }, {\n        default: _withCtx(() => _cache[6] || (_cache[6] = [\n          _createTextVNode(\"取 消\")\n        ])),\n        _: 1\n      })\n    ]),\n    default: _withCtx(() => [\n      _createVNode(_component_el_form, { class: \"package-form\" }, {\n        default: _withCtx(() => [\n          _createVNode(_component_el_form_item, { label: \"套餐周期\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_select, {\n                modelValue: formData.cycle,\n                \"onUpdate:modelValue\": _cache[0] || (_cache[0] = ($event: any) => ((formData.cycle) = $event))\n              }, {\n                default: _withCtx(() => [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(formData.cycleList, (item) => {\n                    return (_openBlock(), _createBlock(_component_el_option, {\n                      key: item.value,\n                      label: item.label,\n                      value: item.value\n                    }, null, 8, [\"label\", \"value\"]))\n                  }), 128))\n                ]),\n                _: 1\n              }, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"套餐开始日期\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_date_picker, {\n                modelValue: formData.startTime,\n                \"onUpdate:modelValue\": _cache[1] || (_cache[1] = ($event: any) => ((formData.startTime) = $event)),\n                type: \"date\",\n                placeholder: \"请选择开始时间\",\n                \"value-format\": \"YYYY-MM-DD\",\n                \"disabled-date\": disabledDate,\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"合作周期\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_input_number, {\n                modelValue: formData.cooperationPeriod,\n                \"onUpdate:modelValue\": _cache[2] || (_cache[2] = ($event: any) => ((formData.cooperationPeriod) = $event)),\n                placeholder: \"请输入\",\n                onInput: validateInput,\n                min: 1,\n                clearable: \"\"\n              }, null, 8, [\"modelValue\"]),\n              _cache[4] || (_cache[4] = _createElementVNode(\"span\", null, \"月\", -1))\n            ]),\n            _: 1\n          }),\n          _createVNode(_component_el_form_item, { label: \"套餐选择\" }, {\n            default: _withCtx(() => [\n              _createVNode(_component_el_select, {\n                modelValue: formData.menu,\n                \"onUpdate:modelValue\": _cache[3] || (_cache[3] = ($event: any) => ((formData.menu) = $event)),\n                onChange: handlePackageChange\n              }, {\n                default: _withCtx(() => [\n                  (_openBlock(true), _createElementBlock(_Fragment, null, _renderList(formData.packages, (item, index) => {\n                    return (_openBlock(), _createBlock(_component_el_option, {\n                      key: index,\n                      label: item.packageName,\n                      value: item.id\n                    }, null, 8, [\"label\", \"value\"]))\n                  }), 128))\n                ]),\n                _: 1\n              }, 8, [\"modelValue\"])\n            ]),\n            _: 1\n          })\n        ]),\n        _: 1\n      })\n    ]),\n    _: 1\n  }, 8, [\"model-value\"]))\n}\n}\n\n})","<template>\r\n  <el-dialog\r\n    :model-value=\"visible\"\r\n    title=\"配置套餐\"\r\n    width=\"500px\"\r\n    class=\"custom-dialog\"\r\n    :before-close=\"handleClose\"\r\n    @open=\"handleOpen\"\r\n  >\r\n    <el-form class=\"package-form\">\r\n      <el-form-item label=\"套餐周期\">\r\n        <el-select v-model=\"formData.cycle\">\r\n          <el-option\r\n            v-for=\"item in formData.cycleList\"\r\n            :key=\"item.value\"\r\n            :label=\"item.label\"\r\n            :value=\"item.value\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n      <el-form-item label=\"套餐开始日期\">\r\n        <el-date-picker\r\n          v-model=\"formData.startTime\"\r\n          type=\"date\"\r\n          placeholder=\"请选择开始时间\"\r\n          value-format=\"YYYY-MM-DD\"\r\n          :disabled-date=\"disabledDate\"\r\n          clearable\r\n        />\r\n      </el-form-item>\r\n      <el-form-item label=\"合作周期\">\r\n        <el-input-number\r\n          v-model=\"formData.cooperationPeriod\"\r\n          placeholder=\"请输入\"\r\n          @input=\"validateInput\"\r\n          :min=\"1\"\r\n          clearable\r\n        />\r\n        <span>月</span>\r\n      </el-form-item>\r\n      <el-form-item label=\"套餐选择\">\r\n        <el-select v-model=\"formData.menu\" @change=\"handlePackageChange\">\r\n          <el-option\r\n            v-for=\"(item, index) in formData.packages\"\r\n            :key=\"index\"\r\n            :label=\"item.packageName\"\r\n            :value=\"item.id\"\r\n          ></el-option>\r\n        </el-select>\r\n      </el-form-item>\r\n    </el-form>\r\n    <template #footer>\r\n      <el-button type=\"primary\" @click=\"handleSubmit\">确 定</el-button>\r\n      <el-button @click=\"handleClose\">取 消</el-button>\r\n    </template>\r\n  </el-dialog>\r\n</template>\r\n<script lang=\"ts\" setup>\r\nimport { reactive } from \"vue\";\r\nimport { LocalStorage } from \"jz-tool-lib\";\r\nimport { useVueRouter } from \"@assets/useHook\";\r\nimport {\r\n  addResourceApi,\r\n  availablePackagesApi,\r\n  getOccupiedTimeSlotsApi,\r\n} from \"@api/ec-line-api\";\r\nimport { ElMessage } from \"element-plus\";\r\nconst agentId = LocalStorage.getItem(\"bd_agentId\");\r\nconst { routeQuery } = useVueRouter();\r\nconst props = defineProps<{\r\n  visible: boolean;\r\n}>();\r\nconst userInfo = LocalStorage.getItem(\"bd_userInfo\");\r\nconst emits = defineEmits<{\r\n  (e: \"update:visible\", value: boolean);\r\n  (e: \"emitFunc\", value?: Record<string, any>);\r\n}>();\r\nconst formData = reactive({\r\n  cycle: 2, //默认自然月\r\n  cycleList: [\r\n    { label: \"业务月\", value: 1 },\r\n    { label: \"自然月\", value: 2 },\r\n  ],\r\n  startTime: \"\",\r\n  menu: \"\",\r\n  cooperationPeriod: 1,\r\n  packages: [],\r\n  packageId: \"\",\r\n  timeList: [],\r\n  packageMinutes: 0,\r\n  minutes: \"\",\r\n});\r\n//校验\r\nconst validateInput = (value) => {\r\n  if (!/^\\d*$/.test(value)) {\r\n    formData.cooperationPeriod = value.replace(/[^\\d]/g, \"\");\r\n  }\r\n};\r\n// 关闭弹框\r\nconst handleClose = () => {\r\n  emits(\"update:visible\", false);\r\n  formData.startTime = \"\";\r\n  formData.menu = \"\";\r\n  formData.cooperationPeriod = 1;\r\n  formData.cycle = 2;\r\n};\r\n//选中套餐id\r\nconst handlePackageChange = (value: string) => {\r\n  formData.packageId = value;\r\n  const selectedPackage = formData.packages.find((item) => item.id === value);\r\n  if (selectedPackage) {\r\n    formData.minutes = selectedPackage.packageMinutes;\r\n  }\r\n};\r\n\r\n//打开弹框\r\nconst handleOpen = () => {\r\n  handleAvailablePackages();\r\n  handleDateChange();\r\n};\r\n//提交\r\nconst handleSubmit = () => {\r\n  if (!formData.menu) {\r\n    ElMessage.warning(\"套餐名称不能为空！\");\r\n    return false;\r\n  }\r\n  if (!formData.startTime) {\r\n    ElMessage.warning(\"请选择套餐开始时间！\");\r\n  }\r\n  const params = {\r\n    agencyId: agentId,\r\n    cycleType: formData.cycle,\r\n    packageId: formData.packageId,\r\n    packageMinutes: formData.minutes,\r\n    profileId: userInfo.profileId,\r\n    profileName: userInfo.realName,\r\n    resourceStartTime: formData.startTime,\r\n    subCompanyCode: routeQuery.value.companyCode,\r\n    subCompanyId: routeQuery.value.companyId,\r\n    totalCooperationCycle: formData.cooperationPeriod,\r\n  };\r\n  addResourceApi.getData(params).then((res) => {\r\n    if (res.statusCode === 0) {\r\n      emits(\"emitFunc\");\r\n      ElMessage.success(\"配置套餐成功\");\r\n      handleClose();\r\n    } else {\r\n      ElMessage.warning(res.msg || \"配置套餐失败\");\r\n    }\r\n  });\r\n};\r\n//获取套餐\r\nconst handleAvailablePackages = async () => {\r\n  const params = {\r\n    agencyId: agentId,\r\n  };\r\n  await availablePackagesApi.getData(params).then((res) => {\r\n    formData.packages = res.data;\r\n  });\r\n};\r\n//套餐日期选择\r\nconst handleDateChange = async () => {\r\n  const params = {\r\n    agencyId: agentId,\r\n    companyId: routeQuery.value.companyId,\r\n  };\r\n  await getOccupiedTimeSlotsApi.getData(params).then((res) => {\r\n    formData.timeList = res.data;\r\n  });\r\n};\r\n//套餐禁用时间\r\nconst disabledDate = (time: Date) => {\r\n  const timeList = formData.timeList;\r\n  const today = new Date();\r\n  today.setHours(0, 0, 0, 0);\r\n  if (time < today) {\r\n    return true;\r\n  }\r\n  if (!Array.isArray(formData.timeList)) {\r\n    return false;\r\n  }\r\n  for (let i = 0; i < timeList.length; i++) {\r\n    const start = new Date(timeList[i].startTime);\r\n    const end = new Date(timeList[i].endTime);\r\n    if (time >= start && time <= end) {\r\n      return true;\r\n    }\r\n  }\r\n  return false;\r\n};\r\n</script>\r\n<style lang=\"scss\" scoped>\r\n:deep {\r\n  .el-select,\r\n  .el-date-picker,\r\n  .el-input {\r\n    width: 250px;\r\n  }\r\n}\r\nspan {\r\n  margin-left: 10px;\r\n}\r\n</style>\r\n","import script from \"./configure-package-dialog.vue?vue&type=script&lang=ts&setup=true\"\nexport * from \"./configure-package-dialog.vue?vue&type=script&lang=ts&setup=true\"\n\nimport \"./configure-package-dialog.vue?vue&type=style&index=0&id=eb3ec0cc&lang=scss&scoped=true\"\n\nimport exportComponent from \"../../../../../../../../node_modules/.pnpm/vue-loader@17.4.2_@vue+compiler-sfc@3.5.13_vue@3.5.13_typescript@5.7.2__webpack@5.97.1/node_modules/vue-loader/dist/exportHelper.js\"\nconst __exports__ = /*#__PURE__*/exportComponent(script, [['__scopeId',\"data-v-eb3ec0cc\"]])\n\nexport default __exports__"],"names":["_defineComponent","__name","props","visible","type","Boolean","emits","setup","__props","emit","__emit","agentId","LocalStorage","getItem","routeQuery","useVueRouter","userInfo","formData","reactive","cycle","cycleList","label","value","startTime","menu","cooperationPeriod","packages","packageId","timeList","packageMinutes","minutes","validateInput","test","replace","handleClose","handlePackageChange","selectedPackage","find","item","id","handleOpen","handleAvailablePackages","handleDateChange","handleSubmit","ElMessage","warning","params","agencyId","cycleType","profileId","profileName","realName","resourceStartTime","subCompanyCode","companyCode","subCompanyId","companyId","totalCooperationCycle","addResourceApi","getData","then","res","statusCode","success","msg","async","availablePackagesApi","data","getOccupiedTimeSlotsApi","disabledDate","time","today","Date","setHours","Array","isArray","i","length","start","end","endTime","_ctx","_cache","_component_el_option","_resolveComponent","_component_el_select","_component_el_form_item","_component_el_date_picker","_component_el_input_number","_component_el_form","_component_el_button","_component_el_dialog","_openBlock","_createBlock","title","width","class","onOpen","footer","_withCtx","_createVNode","onClick","default","_createTextVNode","_","modelValue","$event","_createElementBlock","_Fragment","_renderList","key","placeholder","clearable","onInput","min","_createElementVNode","onChange","index","packageName","__exports__"],"sourceRoot":""}