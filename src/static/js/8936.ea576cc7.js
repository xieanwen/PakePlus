"use strict";(self["webpackChunkdaili"]=self["webpackChunkdaili"]||[]).push([[8936],{88936:function(e,t,l){l.r(t),l.d(t,{default:function(){return C}});var a=l(6254),i=l(25598),s=l(38627),o=l(88365),n=l(79689),d=l(59259);const u={class:"body-container"},m={class:"dialog-footer"};var g=(0,a.pM)({__name:"add-follow-dialog",props:{visible:{type:Boolean}},emits:["update:visible","emitFunc"],setup(e,{emit:t}){const l=t,{bd_agentId:s}=o.DT.batchGetItem(["bd_agentId"]),g=(0,i.Gc)({message:"",defaultFileList:[],fileList:[]}),p=()=>{l("update:visible",!1),g.message="",g.defaultFileList=[],g.fileList=[]};function r(e){g.fileList=e}const c=()=>{if(g.message||g.defaultFileList.length>0){const e={attachment:g.fileList.toString(),followContent:g.message,followType:2,relevanceId:s};n.ei.getData(e).then((e=>{0===e.statusCode?(d.nk.success("新增跟进成功！"),l("emitFunc"),p()):d.nk.error("新增跟进失败！")}))}else d.nk.warning("请至少输入跟进信息或上传附件！")};return(e,t)=>{const l=(0,a.g2)("el-input"),s=(0,a.g2)("el-form-item"),o=(0,a.g2)("CustomUpload"),n=(0,a.g2)("el-form"),d=(0,a.g2)("el-button"),b=(0,a.g2)("el-dialog");return(0,a.uX)(),(0,a.Wv)(b,{width:"750px",title:"新增跟进","model-value":e.visible,class:"custom-dialog",onClose:p},{footer:(0,a.k6)((()=>[(0,a.Lk)("div",m,[(0,a.bF)(d,{onClick:p},{default:(0,a.k6)((()=>t[2]||(t[2]=[(0,a.eW)("取 消")]))),_:1}),(0,a.bF)(d,{type:"primary",onClick:c},{default:(0,a.k6)((()=>t[3]||(t[3]=[(0,a.eW)("保 存")]))),_:1})])])),default:(0,a.k6)((()=>[(0,a.Lk)("div",u,[(0,a.bF)(n,{ref:"ruleFormRef",model:(0,i.R1)(g),"label-position":"top"},{default:(0,a.k6)((()=>[(0,a.bF)(s,{label:"跟进信息"},{default:(0,a.k6)((()=>[(0,a.bF)(l,{modelValue:(0,i.R1)(g).message,"onUpdate:modelValue":t[0]||(t[0]=e=>(0,i.R1)(g).message=e),maxlength:"100",class:"box-textarea",placeholder:"请输入","show-word-limit":"",rows:4,type:"textarea"},null,8,["modelValue"])])),_:1}),(0,a.bF)(s,{label:"跟进附件"},{default:(0,a.k6)((()=>[(0,a.bF)(o,{listType:"picture-card",limit:5,maxVolume:10,defaultFileList:(0,i.R1)(g).defaultFileList,"onUpdate:defaultFileList":t[1]||(t[1]=e=>(0,i.R1)(g).defaultFileList=e),onEmitUpload:r,tip:"支持.jpg、.jpeg、.png格式，最多只能上传5张"},null,8,["defaultFileList"])])),_:1})])),_:1},8,["model"])])])),_:1},8,["model-value"])}}}),p=l(83936);const r=(0,p.A)(g,[["__scopeId","data-v-0181191a"]]);var c=r;const b={class:"timeline-content"},f={class:"follow-record"},k={class:"write-time"},v={class:"information"},F={class:"box-item"},h={key:0,class:"attachment-img"},_={key:1};var L=(0,a.pM)({__name:"follow-records",setup(e){const{bd_agentId:t}=o.DT.batchGetItem(["bd_agentId"]),l=(0,i.Kh)({addFollowVisible:!1}),{getList:d,pageNumberChange:u,pageSizeChange:m,pageData:g}=(0,o.N5)({listApi:n.j4,props:{pageSize:"pageSize",pageNumber:"page"},searchParams:()=>({followType:2,relevanceId:t})}),p=()=>{l.addFollowVisible=!0};return(e,t)=>{const o=(0,a.g2)("el-button"),n=(0,a.g2)("el-image"),r=(0,a.g2)("el-card"),L=(0,a.g2)("el-timeline-item"),w=(0,a.g2)("el-timeline"),C=(0,a.g2)("TableEmpty"),y=(0,a.g2)("PagePagination");return(0,a.uX)(),(0,a.CE)("div",b,[(0,a.Lk)("div",f,[t[2]||(t[2]=(0,a.Lk)("h4",null,"跟进记录",-1)),(0,a.bF)(o,{type:"primary",onClick:p},{default:(0,a.k6)((()=>t[1]||(t[1]=[(0,a.eW)("新增跟进")]))),_:1})]),(0,a.Lk)("div",k,[(0,i.R1)(g).list.length?((0,a.uX)(),(0,a.Wv)(w,{key:0,class:"timeline"},{default:(0,a.k6)((()=>[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)((0,i.R1)(g).list,((e,l)=>((0,a.uX)(),(0,a.Wv)(L,{key:l,timestamp:e.createdTime,placement:"top"},{default:(0,a.k6)((()=>[(0,a.bF)(r,null,{default:(0,a.k6)((()=>[(0,a.Lk)("div",v,[(0,a.Lk)("p",null,"跟进信息："+(0,s.v_)(e.followContent),1),(0,a.Lk)("div",F,[t[3]||(t[3]=(0,a.Lk)("p",{class:"attachment"},"跟进附件：",-1)),e.attachment&&e.attachment.length>0?((0,a.uX)(),(0,a.CE)("div",h,[((0,a.uX)(!0),(0,a.CE)(a.FK,null,(0,a.pI)(e.attachment,((e,t)=>((0,a.uX)(),(0,a.Wv)(n,{key:t,class:"img-item","preview-src-list":[e],src:e,fit:"cover"},null,8,["preview-src-list","src"])))),128))])):((0,a.uX)(),(0,a.CE)("p",_,"暂无"))])])])),_:2},1024)])),_:2},1032,["timestamp"])))),128))])),_:1})):((0,a.uX)(),(0,a.Wv)(C,{key:1,"empty-text":"暂无数据"}))]),(0,a.bF)(y,{pageTotal:(0,i.R1)(g).pageTotal,pageSize:(0,i.R1)(g).pageSize,pageNumber:(0,i.R1)(g).pageNumber,onEmitPageSizeChange:(0,i.R1)(m),onEmitPageNumberChange:(0,i.R1)(u)},null,8,["pageTotal","pageSize","pageNumber","onEmitPageSizeChange","onEmitPageNumberChange"]),(0,a.bF)(c,{visible:l.addFollowVisible,"onUpdate:visible":t[0]||(t[0]=e=>l.addFollowVisible=e),onEmitFunc:(0,i.R1)(d)},null,8,["visible","onEmitFunc"])])}}});const w=(0,p.A)(L,[["__scopeId","data-v-576306f6"]]);var C=w}}]);
//# sourceMappingURL=8936.ea576cc7.js.map